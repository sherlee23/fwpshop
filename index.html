<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FengWei Pai 锋味派美食团购系统</title>
    <style>
        /* 基础重置 */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', '微软雅黑', Arial, sans-serif; background: #f8fafc; color: #1a202c; }
        
        /* 主题色彩 - 红色主题 */
        :root {
            --primary-color: #dc2626;
            --primary-dark: #b91c1c;
            --primary-light: #ef4444;
            --secondary-color: #64748b;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --info-color: #3b82f6;
        }
        
        /* 按钮样式 */
        .btn { padding: 0.5rem 1rem; border-radius: 0.375rem; border: none; cursor: pointer; font-weight: 600; transition: all 0.2s; }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-secondary { background: #e5e7eb; color: #374151; }
        .btn-secondary:hover { background: #d1d5db; }
        
        /* 容器 */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        
        /* 头部 */
        .header { background: var(--primary-color); color: white; padding: 1rem 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: bold; }
        .nav-buttons { display: flex; gap: 0.5rem; }
        
        /* 分类导航 */
        .category-nav { background: white; padding: 1rem 0; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; z-index: 40; }
        .category-list { display: flex; gap: 0.5rem; overflow-x: auto; padding: 0 1rem; }
        .category-item { 
            padding: 0.5rem 1rem; 
            border-radius: 1.5rem; 
            background: #f3f4f6; 
            color: #374151; 
            font-weight: 600; 
            white-space: nowrap; 
            cursor: pointer; 
            transition: all 0.2s;
        }
        .category-item.active { background: var(--primary-color); color: white; }
        .category-item:hover { background: var(--primary-light); color: white; }
        
        /* 产品网格 */
        .products-section { padding: 2rem 0; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
        .product-card { 
            background: white; 
            border-radius: 0.5rem; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
            overflow: hidden; 
            transition: transform 0.2s;
        }
        .product-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .product-image { width: 100%; height: 200px; object-fit: cover; }
        .product-info { padding: 1rem; }
        .product-name { font-weight: bold; margin-bottom: 0.5rem; }
        .product-price { color: var(--primary-color); font-weight: bold; font-size: 1.1rem; }
        .product-actions { padding: 0 1rem 1rem; }
        
        /* 购物车侧边栏 */
        .cart-sidebar { 
            position: fixed; 
            top: 0; 
            right: 0; 
            height: 100vh; 
            width: 400px; 
            background: white; 
            box-shadow: -2px 0 8px rgba(0,0,0,0.1); 
            transform: translateX(100%); 
            transition: transform 0.3s; 
            z-index: 50;
        }
        .cart-sidebar.open { transform: translateX(0); }
        .cart-header { padding: 1rem; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; }
        .cart-content { padding: 1rem; flex: 1; overflow-y: auto; }
        .cart-footer { padding: 1rem; border-top: 1px solid #e5e7eb; }
        
        /* 模态框 */
        .modal-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.5); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 50;
        }
        .modal-content { 
            background: white; 
            border-radius: 0.5rem; 
            max-width: 500px; 
            width: 90%; 
            max-height: 90vh; 
            overflow-y: auto;
        }
        .modal-header { padding: 1rem; border-bottom: 1px solid #e5e7eb; font-weight: bold; }
        .modal-body { padding: 1rem; }
        .modal-footer { padding: 1rem; border-top: 1px solid #e5e7eb; display: flex; gap: 0.5rem; justify-content: flex-end; }
        
        /* 表单 */
        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; margin-bottom: 0.25rem; font-weight: 600; }
        .form-input { 
            width: 100%; 
            padding: 0.5rem; 
            border: 1px solid #d1d5db; 
            border-radius: 0.375rem; 
            font-size: 1rem;
        }
        .form-input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1); }
        
        /* 后台管理 */
        .admin-layout { display: flex; min-height: 100vh; }
        .admin-sidebar { width: 250px; background: #1f2937; color: white; }
        .admin-content { flex: 1; background: #f9fafb; }
        .admin-nav { padding: 1rem; }
        .admin-nav-item { 
            display: block; 
            padding: 0.75rem 1rem; 
            color: #d1d5db; 
            text-decoration: none; 
            border-radius: 0.375rem; 
            margin-bottom: 0.25rem;
        }
        .admin-nav-item:hover { background: #374151; color: white; }
        .admin-nav-item.active { background: var(--primary-color); color: white; }
        
        /* 响应式 */
        @media (max-width: 768px) {
            .cart-sidebar { width: 100%; }
            .admin-layout { flex-direction: column; }
            .admin-sidebar { width: 100%; }
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
        }
        
        /* 工具类 */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-red { color: var(--primary-color); }
        .bg-red { background: var(--primary-color); }
        .font-bold { font-weight: bold; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .p-4 { padding: 1rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
    </style>
</head>
<body>
    <div id="app">
        <!-- 头部 -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">🍜 锋味派美食</div>
                    <div class="nav-buttons">
                        <button class="btn btn-secondary" onclick="toggleCart()">🛒 购物车 (<span id="cart-count">0</span>)</button>
                        <button class="btn btn-secondary" onclick="showAdmin()">🔧 后台</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- 分类导航 -->
        <nav class="category-nav">
            <div class="container">
                <div class="category-list" id="category-list">
                    <div class="category-item active" data-category="全部商品">🍽️ 全部商品</div>
                    <div class="category-item" data-category="烤肠系列">🌭 烤肠系列</div>
                    <div class="category-item" data-category="烧卖系列">🥟 烧卖系列</div>
                    <div class="category-item" data-category="水饺系列">🥟 水饺系列</div>
                    <div class="category-item" data-category="鱼丸系列">🐟 鱼丸系列</div>
                    <div class="category-item" data-category="面食系列">🍜 面食系列</div>
                    <div class="category-item" data-category="饭类系列">🍚 饭类系列</div>
                    <div class="category-item" data-category="汤品系列">🍲 汤品系列</div>
                    <div class="category-item" data-category="饮料系列">🥤 饮料系列</div>
                </div>
            </div>
        </nav>

        <!-- 产品区域 -->
        <section class="products-section">
            <div class="container">
                <div class="products-grid" id="products-grid">
                    <!-- 产品将通过 JavaScript 动态加载 -->
                </div>
            </div>
        </section>

        <!-- 购物车侧边栏 -->
        <div class="cart-sidebar" id="cart-sidebar">
            <div class="cart-header">
                <h3>购物车</h3>
                <button class="btn btn-secondary" onclick="toggleCart()">✕</button>
            </div>
            <div class="cart-content" id="cart-content">
                <p class="text-center">购物车为空</p>
            </div>
            <div class="cart-footer">
                <div class="mb-4">
                    <strong>总计: RM <span id="cart-total">0.00</span></strong>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="checkout()">结账</button>
            </div>
        </div>

        <!-- 结账模态框 -->
        <div class="modal-overlay hidden" id="checkout-modal">
            <div class="modal-content">
                <div class="modal-header">结账</div>
                <div class="modal-body">
                    <form id="checkout-form">
                        <div class="form-group">
                            <label class="form-label">配送方式</label>
                            <label><input type="radio" name="delivery" value="pickup" checked> 自取</label>
                            <label><input type="radio" name="delivery" value="delivery"> 配送</label>
                        </div>
                        
                        <div id="pickup-address" class="form-group">
                            <label class="form-label">取货地址</label>
                            <p>667, Jalan 24, Taman Perindustrian Ehsan Jaya, Kepong, 52100, Kuala Lumpur.</p>
                        </div>
                        
                        <div id="delivery-form" class="form-group hidden">
                            <label class="form-label">配送地址</label>
                            <input type="text" class="form-input" name="address" placeholder="请输入完整地址">
                            <label class="form-label">备注</label>
                            <textarea class="form-input" name="remarks" placeholder="给Lalamove的备注"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">付款方式</label>
                            <label><input type="radio" name="payment" value="maybank" checked> Maybank QR</label>
                            <label><input type="radio" name="payment" value="tng"> TNG eWallet</label>
                        </div>
                        
                        <div id="payment-info">
                            <div id="maybank-info">
                                <p><strong>Maybank转账信息:</strong></p>
                                <p>户名: Choong Sher Lee</p>
                                <p>账号: 114209540438</p>
                                <p>银行: Maybank</p>
                            </div>
                            <div id="tng-info" class="hidden">
                                <p><strong>TNG eWallet</strong></p>
                                <p>请扫描二维码付款</p>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">联系方式</label>
                            <input type="text" class="form-input" name="phone" placeholder="手机号码" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">姓名</label>
                            <input type="text" class="form-input" name="name" placeholder="姓名" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeCheckout()">取消</button>
                    <button class="btn btn-primary" onclick="submitOrder()">提交订单</button>
                </div>
            </div>
        </div>

        <!-- 后台管理模态框 -->
        <div class="modal-overlay hidden" id="admin-modal">
            <div class="modal-content" style="max-width: 90%; width: 1000px;">
                <div class="modal-header">
                    <span>后台管理</span>
                    <button class="btn btn-secondary" onclick="closeAdmin()" style="float: right;">✕</button>
                </div>
                <div class="modal-body" style="padding: 0;">
                    <div class="admin-layout">
                        <div class="admin-sidebar">
                            <div class="admin-nav">
                                <a href="#" class="admin-nav-item active" onclick="showAdminTab('dashboard')">📊 仪表盘</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('products')">📦 产品管理</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('inventory')">📋 库存管理</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('orders')">📋 订单管理</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('members')">👥 会员管理</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('analytics')">📈 数据分析</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('scanner')">📱 扫码功能</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('camera')">📷 拍照功能</a>
                            </div>
                        </div>
                        <div class="admin-content">
                            <div id="admin-content">
                                <!-- 动态内容 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let cart = [];
        let products = [];
        let currentCategory = '全部商品';

        // 示例产品数据
        const sampleProducts = [
            { id: 1, name: '经典台式烤肠', price: 12.50, category: '烤肠系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5Y+w5byP54Kk6IKgPC90ZXh0Pjwvc3ZnPg==', stock: 20 },
            { id: 2, name: '黑猪三丁纸皮烧卖', price: 8.80, category: '烧卖系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+54Gn5Y2WPC90ZXh0Pjwvc3ZnPg==', stock: 15 },
            { id: 3, name: '手工韭菜水饺', price: 6.50, category: '水饺系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5LiA6aWDPC90ZXh0Pjwvc3ZnPg==', stock: 30 },
            { id: 4, name: 'Q弹鱼丸', price: 4.20, category: '鱼丸系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+6bG85LiLPC90ZXh0Pjwvc3ZnPg==', stock: 25 },
            { id: 5, name: '兰州拉面', price: 15.80, category: '面食系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5ouJ6Z2iPC90ZXh0Pjwvc3ZnPg==', stock: 40 },
            { id: 6, name: '招牌鸡饭', price: 18.80, category: '饭类系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+6bih6aWZPC90ZXh0Pjwvc3ZnPg==', stock: 10 },
            { id: 7, name: '冬瓜排骨汤', price: 12.00, category: '汤品系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5rGk5ZYNPC90ZXh0Pjwvc3ZnPg==', stock: 25 },
            { id: 8, name: '特调奶茶', price: 5.80, category: '饮料系列', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5aWK6IyaPC90ZXh0Pjwvc3ZnPg==', stock: 50 }
        ];

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            products = sampleProducts;
            renderProducts();
            setupCategoryNavigation();
            setupDeliveryToggle();
            setupPaymentToggle();
        });

        // 渲染产品
        function renderProducts() {
            const grid = document.getElementById('products-grid');
            const filteredProducts = currentCategory === '全部商品' 
                ? products 
                : products.filter(p => p.category === currentCategory);

            grid.innerHTML = filteredProducts.map(product => `
                <div class="product-card">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">RM ${product.price.toFixed(2)}</div>
                        <div style="font-size: 0.9rem; color: #6b7280;">库存: ${product.stock}</div>
                    </div>
                    <div class="product-actions">
                        <button class="btn btn-primary" style="width: 100%;" onclick="addToCart(${product.id})">加入购物车</button>
                    </div>
                </div>
            `).join('');
        }

        // 分类导航
        function setupCategoryNavigation() {
            const categoryItems = document.querySelectorAll('.category-item');
            categoryItems.forEach(item => {
                item.addEventListener('click', function() {
                    categoryItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    renderProducts();
                });
            });
        }

        // 添加到购物车
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock <= 0) {
                alert('商品库存不足');
                return;
            }

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    alert('已达到库存上限');
                    return;
                }
            } else {
                cart.push({ ...product, quantity: 1 });
            }

            updateCartDisplay();
            updateCartCount();
        }

        // 更新购物车显示
        function updateCartDisplay() {
            const cartContent = document.getElementById('cart-content');
            if (cart.length === 0) {
                cartContent.innerHTML = '<p class="text-center">购物车为空</p>';
                document.getElementById('cart-total').textContent = '0.00';
                return;
            }

            cartContent.innerHTML = cart.map(item => `
                <div class="flex items-center justify-between mb-4" style="border-bottom: 1px solid #e5e7eb; padding-bottom: 1rem;">
                    <div>
                        <div class="font-bold">${item.name}</div>
                        <div class="text-red">RM ${item.price.toFixed(2)}</div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button class="btn btn-secondary" onclick="updateQuantity(${item.id}, -1)">-</button>
                        <span>${item.quantity}</span>
                        <button class="btn btn-secondary" onclick="updateQuantity(${item.id}, 1)">+</button>
                        <button class="btn btn-secondary" onclick="removeFromCart(${item.id})">🗑️</button>
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('cart-total').textContent = total.toFixed(2);
        }

        // 更新购物车数量
        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }

        // 更新商品数量
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            const product = products.find(p => p.id === productId);
            
            if (item) {
                const newQuantity = item.quantity + change;
                if (newQuantity <= 0) {
                    removeFromCart(productId);
                } else if (newQuantity <= product.stock) {
                    item.quantity = newQuantity;
                    updateCartDisplay();
                    updateCartCount();
                } else {
                    alert('超出库存限制');
                }
            }
        }

        // 从购物车移除
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
            updateCartCount();
        }

        // 切换购物车
        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            sidebar.classList.toggle('open');
        }

        // 结账
        function checkout() {
            if (cart.length === 0) {
                alert('购物车为空');
                return;
            }
            document.getElementById('checkout-modal').classList.remove('hidden');
        }

        // 关闭结账
        function closeCheckout() {
            document.getElementById('checkout-modal').classList.add('hidden');
        }

        // 配送方式切换
        function setupDeliveryToggle() {
            const deliveryRadios = document.querySelectorAll('input[name="delivery"]');
            deliveryRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const pickupDiv = document.getElementById('pickup-address');
                    const deliveryDiv = document.getElementById('delivery-form');
                    
                    if (this.value === 'pickup') {
                        pickupDiv.classList.remove('hidden');
                        deliveryDiv.classList.add('hidden');
                    } else {
                        pickupDiv.classList.add('hidden');
                        deliveryDiv.classList.remove('hidden');
                    }
                });
            });
        }

        // 付款方式切换
        function setupPaymentToggle() {
            const paymentRadios = document.querySelectorAll('input[name="payment"]');
            paymentRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const maybankInfo = document.getElementById('maybank-info');
                    const tngInfo = document.getElementById('tng-info');
                    
                    if (this.value === 'maybank') {
                        maybankInfo.classList.remove('hidden');
                        tngInfo.classList.add('hidden');
                    } else {
                        maybankInfo.classList.add('hidden');
                        tngInfo.classList.remove('hidden');
                    }
                });
            });
        }

        // 提交订单
        function submitOrder() {
            const form = document.getElementById('checkout-form');
            const formData = new FormData(form);
            
            const orderData = {
                items: cart,
                delivery: formData.get('delivery'),
                payment: formData.get('payment'),
                phone: formData.get('phone'),
                name: formData.get('name'),
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)
            };

            if (orderData.delivery === 'delivery') {
                orderData.address = formData.get('address');
                orderData.remarks = formData.get('remarks');
            }

            // 验证必填字段
            if (!orderData.phone || !orderData.name) {
                alert('请填写联系方式和姓名');
                return;
            }

            if (orderData.delivery === 'delivery' && !orderData.address) {
                alert('请填写配送地址');
                return;
            }

            // 生成订单号
            const orderNumber = 'FWP' + Date.now().toString().slice(-8);
            
            // 生成WhatsApp消息
            const message = `新订单 ${orderNumber}\n\n` +
                `客户: ${orderData.name}\n` +
                `电话: ${orderData.phone}\n` +
                `配送: ${orderData.delivery === 'pickup' ? '自取' : '配送'}\n` +
                (orderData.address ? `地址: ${orderData.address}\n` : '') +
                (orderData.remarks ? `备注: ${orderData.remarks}\n` : '') +
                `付款: ${orderData.payment === 'maybank' ? 'Maybank' : 'TNG eWallet'}\n\n` +
                `订单内容:\n` +
                cart.map(item => `${item.name} x${item.quantity} = RM${(item.price * item.quantity).toFixed(2)}`).join('\n') +
                `\n\n总计: RM${orderData.total.toFixed(2)}`;

            const whatsappUrl = `https://wa.me/60162327792?text=${encodeURIComponent(message)}`;
            
            // 减少库存
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                if (product) {
                    product.stock -= item.quantity;
                }
            });

            alert(`订单提交成功！订单号: ${orderNumber}\n\n即将跳转到WhatsApp确认订单...`);
            
            // 清空购物车
            cart = [];
            updateCartDisplay();
            updateCartCount();
            closeCheckout();
            renderProducts();
            
            // 跳转到WhatsApp
            window.open(whatsappUrl, '_blank');
        }

        // 显示后台管理
        function showAdmin() {
            const password = prompt('请输入管理员密码:');
            if (password === 'fengweipaiadmin') {
                document.getElementById('admin-modal').classList.remove('hidden');
                showAdminTab('dashboard');
            } else if (password !== null) {
                alert('密码错误');
            }
        }

        // 关闭后台管理
        function closeAdmin() {
            document.getElementById('admin-modal').classList.add('hidden');
        }

        // 显示后台标签页
        function showAdminTab(tab) {
            // 更新导航状态
            document.querySelectorAll('.admin-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');

            const content = document.getElementById('admin-content');
            
            switch(tab) {
                case 'dashboard':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">仪表盘总览</h2>
                            
                            <!-- 关键指标卡片 -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                                <div style="background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 0.5rem;">📦 总产品数</h3>
                                    <p style="font-size: 2.5rem; font-weight: bold;">${products.length}</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">个商品品类</p>
                                </div>
                                <div style="background: linear-gradient(135deg, #16a34a, #15803d); color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 0.5rem;">💰 库存总值</h3>
                                    <p style="font-size: 2.5rem; font-weight: bold;">RM${products.reduce((sum, p) => sum + (p.price * p.stock), 0).toFixed(0)}</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">总库存价值</p>
                                </div>
                                <div style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 0.5rem;">⚠️ 低库存警报</h3>
                                    <p style="font-size: 2.5rem; font-weight: bold;">${products.filter(p => p.stock < 10).length}</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">需要补货</p>
                                </div>
                                <div style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 0.5rem;">📈 预售统计</h3>
                                    <p style="font-size: 2.5rem; font-weight: bold;">85%</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">成团进度 (170/200盒)</p>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
                                <!-- 库存状态详情 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">📋 库存管理状态</h3>
                                    <div style="overflow-x: auto;">
                                        <table style="width: 100%; border-collapse: collapse;">
                                            <thead>
                                                <tr style="background: #f9fafb;">
                                                    <th style="padding: 0.75rem; text-align: left; border-bottom: 1px solid #e5e7eb;">商品名称</th>
                                                    <th style="padding: 0.75rem; text-align: left; border-bottom: 1px solid #e5e7eb;">分类</th>
                                                    <th style="padding: 0.75rem; text-align: left; border-bottom: 1px solid #e5e7eb;">库存</th>
                                                    <th style="padding: 0.75rem; text-align: left; border-bottom: 1px solid #e5e7eb;">状态</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${products.map(p => `
                                                    <tr>
                                                        <td style="padding: 0.75rem; border-bottom: 1px solid #e5e7eb;">${p.name}</td>
                                                        <td style="padding: 0.75rem; border-bottom: 1px solid #e5e7eb;">${p.category}</td>
                                                        <td style="padding: 0.75rem; border-bottom: 1px solid #e5e7eb;">${p.stock}</td>
                                                        <td style="padding: 0.75rem; border-bottom: 1px solid #e5e7eb;">
                                                            <span style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; color: white; background: ${p.stock < 10 ? '#ef4444' : p.stock < 20 ? '#f59e0b' : '#10b981'};">
                                                                ${p.stock < 10 ? '低库存' : p.stock < 20 ? '中等' : '充足'}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- 分类统计 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">📊 分类分布</h3>
                                    ${Array.from(new Set(products.map(p => p.category))).map(category => {
                                        const count = products.filter(p => p.category === category).length;
                                        const totalStock = products.filter(p => p.category === category).reduce((sum, p) => sum + p.stock, 0);
                                        const percentage = Math.round((count / products.length) * 100);
                                        return `
                                            <div style="margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.375rem;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                                    <span style="font-weight: 600;">${category}</span>
                                                    <span style="color: #6b7280;">${count} 品</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #6b7280;">
                                                    <span>总库存: ${totalStock}</span>
                                                    <span>${percentage}%</span>
                                                </div>
                                                <div style="width: 100%; background: #e5e7eb; border-radius: 0.25rem; height: 0.5rem; margin-top: 0.5rem;">
                                                    <div style="background: var(--primary-color); height: 100%; border-radius: 0.25rem; width: ${percentage}%;"></div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>

                            <!-- 预售成团进度 -->
                            <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-top: 2rem;">
                                <h3 style="margin-bottom: 1rem;">🎯 预售成团统计 (200盒成团制)</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                    <div style="text-align: center;">
                                        <div style="position: relative; width: 120px; height: 120px; margin: 0 auto;">
                                            <svg width="120" height="120" viewBox="0 0 120 120">
                                                <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="10"/>
                                                <circle cx="60" cy="60" r="50" fill="none" stroke="#dc2626" stroke-width="10" 
                                                    stroke-dasharray="${2 * Math.PI * 50 * 0.85} ${2 * Math.PI * 50}" 
                                                    stroke-dashoffset="${2 * Math.PI * 50 * 0.25}" transform="rotate(-90 60 60)"/>
                                            </svg>
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1.5rem; font-weight: bold;">85%</div>
                                        </div>
                                        <p style="margin-top: 0.5rem; font-weight: 600;">预售进度</p>
                                        <p style="color: #6b7280; font-size: 0.9rem;">170 / 200盒</p>
                                    </div>
                                    <div style="padding: 1rem;">
                                        <div style="margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600;">已预售:</span>
                                            <span style="color: var(--primary-color); font-weight: bold;">170盒</span>
                                        </div>
                                        <div style="margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600;">剩余名额:</span>
                                            <span style="color: #f59e0b; font-weight: bold;">30盒</span>
                                        </div>
                                        <div style="margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600;">预计成团时间:</span>
                                            <span style="color: #16a34a; font-weight: bold;">2天内</span>
                                        </div>
                                        <div style="margin-top: 1rem; padding: 0.75rem; background: #fef3c7; border-radius: 0.375rem; border-left: 4px solid #f59e0b;">
                                            <p style="color: #92400e; font-size: 0.9rem;">📢 距离成团还差30盒，预计2天内完成！</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'products':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">产品管理</h2>
                            <button class="btn btn-primary mb-4" onclick="addProduct()">添加新产品</button>
                            <div style="background: white; border-radius: 0.5rem; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead style="background: #f9fafb;">
                                        <tr>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">产品名称</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">分类</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">价格</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">库存</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${products.map(p => `
                                            <tr>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">${p.name}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">${p.category}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">RM${p.price.toFixed(2)}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">${p.stock}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">
                                                    <button class="btn btn-secondary" onclick="editProduct(${p.id})">编辑</button>
                                                    <button class="btn btn-secondary" onclick="deleteProduct(${p.id})" style="margin-left: 0.5rem;">删除</button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'orders':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">📋 订单管理系统</h2>
                            
                            <!-- 订单统计卡片 -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #16a34a;">
                                    <h3 style="color: #16a34a; margin-bottom: 0.5rem;">✅ 已完成</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">8</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">本日完成订单</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #f59e0b;">
                                    <h3 style="color: #f59e0b; margin-bottom: 0.5rem;">⏳ 处理中</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">3</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">待确认付款</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #dc2626;">
                                    <h3 style="color: #dc2626; margin-bottom: 0.5rem;">🚚 配送中</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">2</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">Lalamove配送</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #3b82f6;">
                                    <h3 style="color: #3b82f6; margin-bottom: 0.5rem;">💰 今日营收</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">RM 456</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">11个订单</p>
                                </div>
                            </div>

                            <!-- 快速操作 -->
                            <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 2rem;">
                                <h3 style="margin-bottom: 1rem;">🔧 快速操作</h3>
                                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                    <button class="btn btn-primary" onclick="alert('新建订单功能')">+ 新建订单</button>
                                    <button class="btn btn-secondary" onclick="alert('导出报表功能')">📄 导出报表</button>
                                    <button class="btn btn-secondary" onclick="alert('批量打印功能')">🖨️ 批量打印</button>
                                    <button class="btn btn-secondary" onclick="showAdminTab('orders')">🔄 刷新数据</button>
                                </div>
                            </div>

                            <!-- 订单列表 -->
                            <div style="background: white; border-radius: 0.5rem; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                <div style="padding: 1rem; border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                                    <h3>📝 订单列表</h3>
                                    <div style="display: flex; gap: 1rem; margin-top: 1rem; align-items: center; flex-wrap: wrap;">
                                        <input type="text" placeholder="搜索订单号/客户姓名..." style="flex: 1; min-width: 200px; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                        <select style="padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                            <option>全部状态</option>
                                            <option>待确认</option>
                                            <option>已确认</option>
                                            <option>配送中</option>
                                            <option>已完成</option>
                                            <option>已取消</option>
                                        </select>
                                        <select style="padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                            <option>全部配送方式</option>
                                            <option>自取</option>
                                            <option>配送</option>
                                        </select>
                                    </div>
                                </div>
                                <div style="overflow-x: auto;">
                                    <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
                                        <thead>
                                            <tr style="background: #f9fafb;">
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">订单号</th>
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">客户信息</th>
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">商品详情</th>
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">配送方式</th>
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">金额</th>
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">状态</th>
                                                <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${[
                                                {id: 'FWP20250101', customer: '张小明<br>019-123-4567', items: '经典台式烤肠 x2<br>特调奶茶 x1', delivery: '自取', amount: 'RM 30.80', status: '已完成', time: '10:30'},
                                                {id: 'FWP20250102', customer: '李小红<br>012-987-6543', items: '黑猪三丁烧卖 x3<br>兰州拉面 x1', delivery: '配送', amount: 'RM 42.20', status: '配送中', time: '11:15'},
                                                {id: 'FWP20250103', customer: '王大华<br>017-555-8888', items: '手工韭菜水饺 x5<br>冬瓜排骨汤 x2', delivery: '自取', amount: 'RM 56.50', status: '待确认', time: '12:00'},
                                                {id: 'FWP20250104', customer: '陈美丽<br>016-333-2222', items: 'Q弹鱼丸 x4<br>招牌鸡饭 x1', delivery: '配送', amount: 'RM 35.60', status: '已确认', time: '12:30'},
                                                {id: 'FWP20250105', customer: '林志强<br>018-777-9999', items: '特调奶茶 x3', delivery: '自取', amount: 'RM 17.40', status: '已完成', time: '13:45'}
                                            ].map(order => 
                                                '<tr style="border-bottom: 1px solid #e5e7eb;">' +
                                                    '<td style="padding: 1rem;">' +
                                                        '<div style="font-weight: bold; color: var(--primary-color);">' + order.id + '</div>' +
                                                        '<div style="font-size: 0.8rem; color: #6b7280;">' + order.time + '</div>' +
                                                    '</td>' +
                                                    '<td style="padding: 1rem;">' +
                                                        '<div style="font-size: 0.9rem;">' + order.customer + '</div>' +
                                                    '</td>' +
                                                    '<td style="padding: 1rem;">' +
                                                        '<div style="font-size: 0.9rem;">' + order.items + '</div>' +
                                                    '</td>' +
                                                    '<td style="padding: 1rem;">' +
                                                        '<span style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; background: ' + (order.delivery === '自取' ? '#ecfdf5' : '#fef3c7') + '; color: ' + (order.delivery === '自取' ? '#065f46' : '#92400e') + ';">' +
                                                            (order.delivery === '自取' ? '🏪 自取' : '🚚 配送') +
                                                        '</span>' +
                                                    '</td>' +
                                                    '<td style="padding: 1rem; font-weight: bold;">' + order.amount + '</td>' +
                                                    '<td style="padding: 1rem;">' +
                                                        '<span style="padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem; color: white; background: ' + 
                                                            (order.status === '已完成' ? '#16a34a' : 
                                                            order.status === '配送中' ? '#dc2626' : 
                                                            order.status === '已确认' ? '#3b82f6' : '#f59e0b') + ';">' +
                                                            order.status +
                                                        '</span>' +
                                                    '</td>' +
                                                    '<td style="padding: 1rem;">' +
                                                        '<div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">' +
                                                            '<button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #3b82f6; color: white;" onclick="alert(\'查看订单 ' + order.id + '\')">查看</button>' +
                                                            '<button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #16a34a; color: white;" onclick="alert(\'打印订单 ' + order.id + '\')">打印</button>' +
                                                            (order.status !== '已完成' ? '<button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #f59e0b; color: white;" onclick="alert(\'更新订单状态 ' + order.id + '\')">更新</button>' : '') +
                                                        '</div>' +
                                                    '</td>' +
                                                '</tr>'
                                            ).join('')}
                                        </tbody>
                                    </table>
                                </div>
                                <div style="padding: 1rem; background: #f9fafb; text-center;">
                                    <p style="color: #6b7280;">显示 5 条订单，共 5 条 | WhatsApp自动通知已启用 📱</p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'analytics':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">📈 数据分析中心</h2>
                            
                            <!-- 分析概览 -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                                <div style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                                    <h3 style="margin-bottom: 0.5rem;">📊 总销售额</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">RM 12,345</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">本月累计</p>
                                </div>
                                <div style="background: linear-gradient(135deg, #10b981, #047857); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                                    <h3 style="margin-bottom: 0.5rem;">🛍️ 订单总数</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">156</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">本月订单</p>
                                </div>
                                <div style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                                    <h3 style="margin-bottom: 0.5rem;">👥 客户数量</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">89</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">活跃客户</p>
                                </div>
                                <div style="background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; padding: 1.5rem; border-radius: 0.5rem;">
                                    <h3 style="margin-bottom: 0.5rem;">📈 平均单价</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">RM 79</p>
                                    <p style="font-size: 0.9rem; opacity: 0.9;">每单平均</p>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                                <!-- 销售趋势图 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">📈 销售趋势 (最近7天)</h3>
                                    <div style="height: 300px; background: #f9fafb; border-radius: 0.375rem; display: flex; align-items: end; justify-content: space-around; padding: 1rem;">
                                        ${['周一', '周二', '周三', '周四', '周五', '周六', '周日'].map((day, i) => {
                                            const height = Math.random() * 200 + 50;
                                            const value = Math.round(Math.random() * 500 + 200);
                                            return `
                                                <div style="display: flex; flex-direction: column; align-items: center;">
                                                    <div style="font-size: 0.8rem; margin-bottom: 0.5rem; color: #6b7280;">RM${value}</div>
                                                    <div style="width: 40px; background: linear-gradient(to top, #dc2626, #f87171); border-radius: 0.25rem; height: ${height}px;"></div>
                                                    <div style="font-size: 0.8rem; margin-top: 0.5rem; color: #6b7280;">${day}</div>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>

                                <!-- 产品排行 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">🏆 热销产品 TOP5</h3>
                                    ${products.slice(0, 5).map((product, index) => {
                                        const sales = Math.round(Math.random() * 50 + 10);
                                        return `
                                            <div style="display: flex; align-items: center; margin-bottom: 1rem; padding: 0.75rem; background: #f9fafb; border-radius: 0.375rem;">
                                                <div style="width: 24px; height: 24px; background: ${index < 3 ? ['#ffd700', '#c0c0c0', '#cd7f32'][index] : '#e5e7eb'}; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 0.75rem;">
                                                    ${index + 1}
                                                </div>
                                                <div style="flex: 1;">
                                                    <div style="font-weight: 600; font-size: 0.9rem;">${product.name}</div>
                                                    <div style="color: #6b7280; font-size: 0.8rem;">销量: ${sales} 份</div>
                                                </div>
                                                <div style="font-weight: bold; color: var(--primary-color);">RM${(product.price * sales).toFixed(0)}</div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                                <!-- 分类分析 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">🎯 分类销售分析</h3>
                                    <div style="margin-top: 1rem;">
                                        ${Array.from(new Set(products.map(p => p.category))).map(category => {
                                            const count = products.filter(p => p.category === category).length;
                                            const revenue = Math.round(Math.random() * 2000 + 500);
                                            const percentage = Math.round((count / products.length) * 100);
                                            return `
                                                <div style="margin-bottom: 1rem;">
                                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                                        <span style="font-weight: 600;">${category}</span>
                                                        <span style="color: var(--primary-color); font-weight: bold;">RM${revenue}</span>
                                                    </div>
                                                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #6b7280; margin-bottom: 0.5rem;">
                                                        <span>${count} 个产品</span>
                                                        <span>${percentage}% 占比</span>
                                                    </div>
                                                    <div style="width: 100%; background: #e5e7eb; border-radius: 0.25rem; height: 8px;">
                                                        <div style="background: linear-gradient(to right, #dc2626, #f87171); height: 100%; border-radius: 0.25rem; width: ${percentage}%;"></div>
                                                    </div>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>

                                <!-- 库存分析 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">📦 库存深度分析</h3>
                                    <div style="margin-top: 1rem;">
                                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #e5e7eb;">
                                            <span style="font-weight: 600;">📊 总库存量</span>
                                            <span style="font-weight: bold; color: #3b82f6;">${products.reduce((sum, p) => sum + p.stock, 0)} 件</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #e5e7eb;">
                                            <span style="font-weight: 600;">💰 库存总值</span>
                                            <span style="font-weight: bold; color: #10b981;">RM${products.reduce((sum, p) => sum + (p.price * p.stock), 0).toFixed(0)}</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #e5e7eb;">
                                            <span style="font-weight: 600;">📈 平均库存</span>
                                            <span style="font-weight: bold; color: #f59e0b;">${Math.round(products.reduce((sum, p) => sum + p.stock, 0) / products.length)} 件</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0; border-bottom: 1px solid #e5e7eb;">
                                            <span style="font-weight: 600;">⚠️ 低库存产品</span>
                                            <span style="font-weight: bold; color: #dc2626;">${products.filter(p => p.stock < 10).length} 个</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 0.75rem 0;">
                                            <span style="font-weight: 600;">🔄 库存周转率</span>
                                            <span style="font-weight: bold; color: #8b5cf6;">2.3x/月</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- 客户分析 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">👥 客户行为分析</h3>
                                    <div style="margin-top: 1rem;">
                                        <div style="margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.375rem;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                                <span style="font-weight: 600;">📱 配送方式偏好</span>
                                            </div>
                                            <div style="margin-bottom: 0.5rem;">
                                                <div style="display: flex; justify-content: space-between; font-size: 0.9rem;">
                                                    <span>🏪 自取</span>
                                                    <span>65%</span>
                                                </div>
                                                <div style="width: 100%; background: #e5e7eb; border-radius: 0.25rem; height: 6px; margin-top: 0.25rem;">
                                                    <div style="background: #10b981; height: 100%; border-radius: 0.25rem; width: 65%;"></div>
                                                </div>
                                            </div>
                                            <div style="margin-bottom: 0.5rem;">
                                                <div style="display: flex; justify-content: space-between; font-size: 0.9rem;">
                                                    <span>🚚 配送</span>
                                                    <span>35%</span>
                                                </div>
                                                <div style="width: 100%; background: #e5e7eb; border-radius: 0.25rem; height: 6px; margin-top: 0.25rem;">
                                                    <div style="background: #f59e0b; height: 100%; border-radius: 0.25rem; width: 35%;"></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="margin-bottom: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.375rem;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                                <span style="font-weight: 600;">💳 付款方式分布</span>
                                            </div>
                                            <div style="font-size: 0.9rem; color: #6b7280;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                                    <span>🏦 Maybank QR</span>
                                                    <span>72%</span>
                                                </div>
                                                <div style="display: flex; justify-content: space-between;">
                                                    <span>💰 TNG eWallet</span>
                                                    <span>28%</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div style="padding: 1rem; background: #f0f9ff; border-radius: 0.375rem; border-left: 4px solid #3b82f6;">
                                            <p style="color: #1e40af; font-size: 0.9rem;">💡 <strong>洞察:</strong> 客户更偏好自取方式，建议优化店内体验和取货流程</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'scanner':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">📱 扫码管理系统</h2>
                            
                            <!-- 扫码统计 -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #16a34a;">
                                    <h3 style="color: #16a34a; margin-bottom: 0.5rem;">✅ 今日扫码</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">45</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">成功扫描次数</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #3b82f6;">
                                    <h3 style="color: #3b82f6; margin-bottom: 0.5rem;">📊 本周总计</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">312</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">扫描总数</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #f59e0b;">
                                    <h3 style="color: #f59e0b; margin-bottom: 0.5rem;">⚡ 扫描速度</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">1.2s</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">平均识别时间</p>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <!-- 扫码操作区 -->
                                <div style="background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1.5rem; text-align: center;">🎯 扫码操作中心</h3>
                                    
                                    <!-- 扫码模式选择 -->
                                    <div style="margin-bottom: 2rem;">
                                        <h4 style="margin-bottom: 1rem;">扫码模式</h4>
                                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                                            <button class="btn btn-primary" id="camera-mode-btn" onclick="setScanMode('camera')" style="flex: 1;">📷 摄像头扫码</button>
                                            <button class="btn btn-secondary" id="gun-mode-btn" onclick="setScanMode('gun')" style="flex: 1;">🔫 扫码枪模式</button>
                                        </div>
                                        <p style="font-size: 0.9rem; color: #6b7280; text-align: center;">选择适合的扫码方式进行操作</p>
                                    </div>

                                    <!-- 摄像头扫码区域 -->
                                    <div id="camera-scan-area" style="text-align: center;">
                                        <div style="width: 300px; height: 300px; background: #f9fafb; border: 2px dashed #d1d5db; border-radius: 0.5rem; margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; position: relative;">
                                            <div id="scan-placeholder" style="text-align: center; color: #6b7280;">
                                                <p style="font-size: 4rem; margin-bottom: 0.5rem;">📱</p>
                                                <p>点击启动摄像头扫码</p>
                                            </div>
                                            <div id="scan-frame" style="display: none; width: 200px; height: 200px; border: 3px solid #dc2626; border-radius: 0.5rem; position: absolute; animation: pulse 2s infinite;"></div>
                                        </div>
                                        <button class="btn btn-primary" onclick="startCameraScanner()" style="margin-bottom: 1rem;">📱 启动摄像头扫码</button>
                                        <button class="btn btn-secondary" onclick="stopCameraScanner()" style="margin-left: 0.5rem;">⏹️ 停止扫码</button>
                                    </div>

                                    <!-- 扫码枪模式区域 -->
                                    <div id="gun-scan-area" style="display: none; text-align: center;">
                                        <div style="padding: 2rem; background: #f0f9ff; border-radius: 0.5rem; margin-bottom: 1rem;">
                                            <p style="font-size: 3rem; margin-bottom: 1rem;">🔫</p>
                                            <h4 style="color: #1e40af;">扫码枪已就绪</h4>
                                            <p style="color: #6b7280; margin-top: 0.5rem;">请将光标保持在此页面，然后使用扫码枪扫描</p>
                                        </div>
                                        <div style="background: #fef3c7; padding: 1rem; border-radius: 0.375rem; border-left: 4px solid #f59e0b;">
                                            <p style="color: #92400e; font-size: 0.9rem;">💡 提示: 确保页面焦点在此处，扫码枪扫描后会自动录入</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- 扫描结果和历史 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">📋 扫描结果</h3>
                                    
                                    <!-- 当前扫描结果 -->
                                    <div id="current-scan-result" style="background: #f9fafb; padding: 1rem; border-radius: 0.375rem; margin-bottom: 1.5rem; min-height: 80px; display: flex; align-items: center; justify-content: center; border: 2px dashed #d1d5db;">
                                        <p style="color: #6b7280; text-align: center;">等待扫描结果...</p>
                                    </div>

                                    <!-- 快速操作 -->
                                    <div style="margin-bottom: 1.5rem;">
                                        <h4 style="margin-bottom: 0.5rem;">快速操作</h4>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <button class="btn btn-secondary" onclick="copyScanResult()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">📋 复制</button>
                                            <button class="btn btn-secondary" onclick="searchProduct()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">🔍 查找商品</button>
                                            <button class="btn btn-secondary" onclick="addToInventory()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">📦 入库</button>
                                            <button class="btn btn-secondary" onclick="clearScanHistory()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">🗑️ 清空历史</button>
                                        </div>
                                    </div>

                                    <!-- 扫描历史 -->
                                    <div>
                                        <h4 style="margin-bottom: 1rem;">📚 扫描历史 (最近10条)</h4>
                                        <div id="scan-history" style="max-height: 300px; overflow-y: auto;">
                                            ${Array.from({length: 5}, (_, i) => {
                                                const time = new Date(Date.now() - i * 300000).toLocaleTimeString();
                                                const codes = ['FWP12345678', 'SKU87654321', 'PROD11111111', 'ITEM22222222', 'CODE33333333'];
                                                return `
                                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; border-bottom: 1px solid #e5e7eb; background: ${i % 2 === 0 ? '#f9fafb' : 'white'};">
                                                        <div>
                                                            <div style="font-family: monospace; font-weight: bold; color: var(--primary-color);">${codes[i]}</div>
                                                            <div style="font-size: 0.8rem; color: #6b7280;">${time}</div>
                                                        </div>
                                                        <div style="display: flex; gap: 0.25rem;">
                                                            <button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #3b82f6; color: white;" onclick="alert('查看详情: ${codes[i]}')">详情</button>
                                                            <button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #16a34a; color: white;" onclick="alert('再次使用: ${codes[i]}')">使用</button>
                                                        </div>
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 扫码统计图表 -->
                            <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-top: 2rem;">
                                <h3 style="margin-bottom: 1rem;">📊 扫码使用统计</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                                    ${Array.from({length: 7}, (_, i) => {
                                        const day = ['周一', '周二', '周三', '周四', '周五', '周六', '周日'][i];
                                        const count = Math.round(Math.random() * 50 + 10);
                                        return `
                                            <div style="text-align: center; padding: 1rem; background: #f9fafb; border-radius: 0.375rem;">
                                                <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-color); margin-bottom: 0.5rem;">${count}</div>
                                                <div style="font-size: 0.9rem; color: #6b7280;">${day}</div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'camera':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">📷 拍照管理系统</h2>
                            
                            <!-- 拍照统计 -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #16a34a;">
                                    <h3 style="color: #16a34a; margin-bottom: 0.5rem;">📸 今日拍照</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">28</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">成功拍摄照片</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #3b82f6;">
                                    <h3 style="color: #3b82f6; margin-bottom: 0.5rem;">💾 存储空间</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">2.8GB</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">已使用空间</p>
                                </div>
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border-left: 4px solid #f59e0b;">
                                    <h3 style="color: #f59e0b; margin-bottom: 0.5rem;">🗂️ 照片分类</h3>
                                    <p style="font-size: 2rem; font-weight: bold;">8</p>
                                    <p style="font-size: 0.9rem; color: #6b7280;">个相册</p>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <!-- 拍照操作区 -->
                                <div style="background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1.5rem; text-align: center;">📷 拍照操作中心</h3>
                                    
                                    <!-- 相机预览区 -->
                                    <div style="margin-bottom: 2rem;">
                                        <div id="camera-preview-area" style="width: 100%; height: 300px; background: #000; border-radius: 0.5rem; position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center;">
                                            <div id="camera-placeholder" style="text-align: center; color: white;">
                                                <p style="font-size: 4rem; margin-bottom: 0.5rem;">📷</p>
                                                <p>点击启动相机</p>
                                            </div>
                                            <video id="camera-video" style="width: 100%; height: 100%; object-fit: cover; display: none;" autoplay playsinline></video>
                                            <canvas id="photo-canvas" style="display: none;"></canvas>
                                        </div>
                                        
                                        <!-- 相机控制按钮 -->
                                        <div style="display: flex; gap: 1rem; margin-top: 1rem; justify-content: center;">
                                            <button class="btn btn-primary" onclick="startCamera()" id="start-camera-btn">📷 启动相机</button>
                                            <button class="btn btn-success" onclick="takePhoto()" id="take-photo-btn" style="display: none;">📸 拍照</button>
                                            <button class="btn btn-secondary" onclick="stopCamera()" id="stop-camera-btn" style="display: none;">⏹️ 停止</button>
                                        </div>
                                    </div>

                                    <!-- 拍照设置 -->
                                    <div style="margin-bottom: 1.5rem;">
                                        <h4 style="margin-bottom: 1rem;">⚙️ 拍照设置</h4>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">摄像头选择:</label>
                                                <select style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                                    <option>前置摄像头</option>
                                                    <option>后置摄像头</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">图片质量:</label>
                                                <select style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                                    <option>高质量 (1080p)</option>
                                                    <option>标准质量 (720p)</option>
                                                    <option>压缩质量 (480p)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 快速操作 -->
                                    <div>
                                        <h4 style="margin-bottom: 0.5rem;">🔧 快速操作</h4>
                                        <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                            <button class="btn btn-secondary" onclick="uploadPhoto()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">📁 上传照片</button>
                                            <button class="btn btn-secondary" onclick="openGallery()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">🖼️ 照片库</button>
                                            <button class="btn btn-secondary" onclick="clearStorage()" style="font-size: 0.8rem; padding: 0.25rem 0.5rem;">🗑️ 清理存储</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 照片预览和管理 -->
                                <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3 style="margin-bottom: 1rem;">🖼️ 照片预览</h3>
                                    
                                    <!-- 当前照片预览 -->
                                    <div id="current-photo-preview" style="background: #f9fafb; border: 2px dashed #d1d5db; border-radius: 0.5rem; margin-bottom: 1.5rem; min-height: 200px; display: flex; align-items: center; justify-content: center;">
                                        <p style="color: #6b7280; text-align: center;">拍照后显示预览...</p>
                                    </div>

                                    <!-- 照片操作 -->
                                    <div style="margin-bottom: 1.5rem;" id="photo-actions" style="display: none;">
                                        <h4 style="margin-bottom: 0.5rem;">📝 照片操作</h4>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                                            <button class="btn btn-success" onclick="savePhoto()" style="font-size: 0.8rem;">💾 保存</button>
                                            <button class="btn btn-primary" onclick="uploadToCloud()" style="font-size: 0.8rem;">☁️ 上传云端</button>
                                            <button class="btn btn-secondary" onclick="editPhoto()" style="font-size: 0.8rem;">✏️ 编辑</button>
                                            <button class="btn btn-secondary" onclick="sharePhoto()" style="font-size: 0.8rem;">📤 分享</button>
                                        </div>
                                    </div>

                                    <!-- 最近照片 -->
                                    <div>
                                        <h4 style="margin-bottom: 1rem;">📚 最近照片 (最新6张)</h4>
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; max-height: 300px; overflow-y: auto;">
                                            ${Array.from({length: 6}, (_, i) => {
                                                const time = new Date(Date.now() - i * 600000).toLocaleTimeString();
                                                return `
                                                    <div style="aspect-ratio: 1; background: linear-gradient(45deg, #f3f4f6, #e5e7eb); border-radius: 0.375rem; position: relative; overflow: hidden; cursor: pointer;" onclick="alert('查看照片 ${i + 1}')">
                                                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.1);">
                                                            <span style="font-size: 2rem;">📷</span>
                                                        </div>
                                                        <div style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 0.25rem; font-size: 0.7rem; text-align: center;">
                                                            ${time}
                                                        </div>
                                                        <div style="position: absolute; top: 0.25rem; right: 0.25rem;">
                                                            <button style="background: rgba(255,255,255,0.9); border: none; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; cursor: pointer;" onclick="event.stopPropagation(); alert('删除照片 ${i + 1}')">×</button>
                                                        </div>
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 照片分类管理 -->
                            <div style="background: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-top: 2rem;">
                                <h3 style="margin-bottom: 1rem;">🗂️ 照片分类管理</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                    ${[
                                        {name: '产品照片', count: 45, icon: '📦', color: '#3b82f6'},
                                        {name: '店铺环境', count: 28, icon: '🏪', color: '#16a34a'},
                                        {name: '客户留影', count: 33, icon: '👥', color: '#f59e0b'},
                                        {name: '活动记录', count: 19, icon: '🎉', color: '#dc2626'},
                                        {name: '库存记录', count: 52, icon: '📋', color: '#8b5cf6'},
                                        {name: '收据凭证', count: 67, icon: '🧾', color: '#06b6d4'},
                                        {name: '配送照片', count: 23, icon: '🚚', color: '#84cc16'},
                                        {name: '其他照片', count: 15, icon: '📷', color: '#6b7280'}
                                    ].map(category => `
                                        <div style="background: #f9fafb; padding: 1rem; border-radius: 0.375rem; border-left: 4px solid ${category.color}; cursor: pointer;" onclick="alert('打开分类: ${category.name}')">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                                <span style="font-size: 1.5rem;">${category.icon}</span>
                                                <span style="font-weight: bold; color: ${category.color};">${category.count}</span>
                                            </div>
                                            <div style="font-weight: 600; margin-bottom: 0.25rem;">${category.name}</div>
                                            <div style="font-size: 0.8rem; color: #6b7280;">点击查看详情</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                default:
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">${tab}</h2>
                            <div style="background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">
                                <p>此功能正在开发中...</p>
                            </div>
                        </div>
                    `;
            }
        }

        // 扫码功能
        let currentScanMode = 'camera';
        let scanHistory = [];

        function setScanMode(mode) {
            currentScanMode = mode;
            const cameraBtn = document.getElementById('camera-mode-btn');
            const gunBtn = document.getElementById('gun-mode-btn');
            const cameraArea = document.getElementById('camera-scan-area');
            const gunArea = document.getElementById('gun-scan-area');

            if (mode === 'camera') {
                cameraBtn.className = 'btn btn-primary';
                gunBtn.className = 'btn btn-secondary';
                cameraArea.style.display = 'block';
                gunArea.style.display = 'none';
            } else {
                cameraBtn.className = 'btn btn-secondary';
                gunBtn.className = 'btn btn-primary';
                cameraArea.style.display = 'none';
                gunArea.style.display = 'block';
            }
        }

        function startCameraScanner() {
            const placeholder = document.getElementById('scan-placeholder');
            const frame = document.getElementById('scan-frame');
            
            placeholder.style.display = 'none';
            frame.style.display = 'block';
            
            // 模拟扫码过程
            setTimeout(() => {
                const mockCode = 'FWP' + Date.now().toString().slice(-8);
                displayScanResult(mockCode);
                addToScanHistory(mockCode);
            }, 2000);
        }

        function stopCameraScanner() {
            const placeholder = document.getElementById('scan-placeholder');
            const frame = document.getElementById('scan-frame');
            
            placeholder.style.display = 'block';
            frame.style.display = 'none';
        }

        function displayScanResult(code) {
            const resultDiv = document.getElementById('current-scan-result');
            resultDiv.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 1.2rem; font-weight: bold; color: var(--primary-color); margin-bottom: 0.5rem;">${code}</div>
                    <div style="font-size: 0.9rem; color: #6b7280;">扫描时间: ${new Date().toLocaleTimeString()}</div>
                    <div style="margin-top: 1rem;">
                        <span style="padding: 0.25rem 0.5rem; background: #16a34a; color: white; border-radius: 0.25rem; font-size: 0.8rem;">✅ 扫描成功</span>
                    </div>
                </div>
            `;
        }

        function addToScanHistory(code) {
            scanHistory.unshift({
                code: code,
                time: new Date().toLocaleTimeString(),
                timestamp: Date.now()
            });
            
            if (scanHistory.length > 10) {
                scanHistory = scanHistory.slice(0, 10);
            }
            
            updateScanHistoryDisplay();
        }

        function updateScanHistoryDisplay() {
            const historyDiv = document.getElementById('scan-history');
            if (historyDiv && scanHistory.length > 0) {
                historyDiv.innerHTML = scanHistory.map((item, index) => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; border-bottom: 1px solid #e5e7eb; background: ${index % 2 === 0 ? '#f9fafb' : 'white'};">
                        <div>
                            <div style="font-family: monospace; font-weight: bold; color: var(--primary-color);">${item.code}</div>
                            <div style="font-size: 0.8rem; color: #6b7280;">${item.time}</div>
                        </div>
                        <div style="display: flex; gap: 0.25rem;">
                            <button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #3b82f6; color: white;" onclick="alert('查看详情: ${item.code}')">详情</button>
                            <button class="btn" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; background: #16a34a; color: white;" onclick="alert('再次使用: ${item.code}')">使用</button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function startScanner() {
            // 兼容旧版本函数名
            if (currentScanMode === 'camera') {
                startCameraScanner();
            } else {
                // 扫码枪模式
                const simulatedCode = 'FWP' + Math.random().toString(36).substr(2, 9).toUpperCase();
                displayScanResult(simulatedCode);
                addToScanHistory(simulatedCode);
            }
        }

        function copyScanResult() {
            const resultText = document.querySelector('#current-scan-result .font-weight-bold, #current-scan-result [style*="font-weight: bold"]');
            if (resultText) {
                navigator.clipboard.writeText(resultText.textContent).then(() => {
                    alert('扫描结果已复制到剪贴板');
                });
            }
        }

        function searchProduct() {
            alert('搜索产品功能 - 将在产品库中查找相关商品');
        }

        function addToInventory() {
            alert('入库功能 - 将扫描结果添加到库存管理');
        }

        function clearScanHistory() {
            if (confirm('确定要清空扫描历史吗？')) {
                scanHistory = [];
                updateScanHistoryDisplay();
                alert('扫描历史已清空');
            }
        }

        // 相机功能
        let cameraStream = null;
        let currentPhotoData = null;

        function startCamera() {
            const video = document.getElementById('camera-video');
            const placeholder = document.getElementById('camera-placeholder');
            const startBtn = document.getElementById('start-camera-btn');
            const takeBtn = document.getElementById('take-photo-btn');
            const stopBtn = document.getElementById('stop-camera-btn');

            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                .then(function(stream) {
                    cameraStream = stream;
                    video.srcObject = stream;
                    video.style.display = 'block';
                    placeholder.style.display = 'none';
                    
                    startBtn.style.display = 'none';
                    takeBtn.style.display = 'inline-block';
                    stopBtn.style.display = 'inline-block';
                })
                .catch(function(err) {
                    alert('无法访问相机: ' + err.message);
                });
        }

        function stopCamera() {
            const video = document.getElementById('camera-video');
            const placeholder = document.getElementById('camera-placeholder');
            const startBtn = document.getElementById('start-camera-btn');
            const takeBtn = document.getElementById('take-photo-btn');
            const stopBtn = document.getElementById('stop-camera-btn');

            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            
            video.style.display = 'none';
            placeholder.style.display = 'block';
            
            startBtn.style.display = 'inline-block';
            takeBtn.style.display = 'none';
            stopBtn.style.display = 'none';
        }

        function takePhoto() {
            const video = document.getElementById('camera-video');
            const canvas = document.getElementById('photo-canvas');
            const previewDiv = document.getElementById('current-photo-preview');
            const actionsDiv = document.getElementById('photo-actions');
            
            if (!video.srcObject) {
                alert('请先启动相机');
                return;
            }

            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);
            
            currentPhotoData = canvas.toDataURL('image/jpeg', 0.8);
            
            // 显示预览
            previewDiv.innerHTML = `
                <img src="${currentPhotoData}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 0.375rem;">
                <div style="position: absolute; top: 0.5rem; right: 0.5rem; background: rgba(0,0,0,0.7); color: white; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.8rem;">
                    ${new Date().toLocaleTimeString()}
                </div>
            `;
            previewDiv.style.position = 'relative';
            
            // 显示操作按钮
            if (actionsDiv) {
                actionsDiv.style.display = 'block';
            }
        }

        function savePhoto() {
            if (!currentPhotoData) {
                alert('没有可保存的照片');
                return;
            }
            
            const link = document.createElement('a');
            link.download = 'photo-' + Date.now() + '.jpg';
            link.href = currentPhotoData;
            link.click();
            alert('照片已保存到下载文件夹');
        }

        function uploadToCloud() {
            if (!currentPhotoData) {
                alert('没有可上传的照片');
                return;
            }
            
            // 模拟上传过程
            const uploadProgress = document.createElement('div');
            uploadProgress.innerHTML = `
                <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.375rem; margin-top: 1rem; border-left: 4px solid #3b82f6;">
                    <p style="color: #1e40af;">📤 正在上传到云端...</p>
                    <div style="width: 100%; background: #e5e7eb; border-radius: 0.25rem; height: 8px; margin-top: 0.5rem;">
                        <div style="background: #3b82f6; height: 100%; border-radius: 0.25rem; width: 0%; transition: width 2s;" id="upload-progress-bar"></div>
                    </div>
                </div>
            `;
            
            document.getElementById('current-photo-preview').appendChild(uploadProgress);
            
            // 模拟上传进度
            setTimeout(() => {
                document.getElementById('upload-progress-bar').style.width = '100%';
                setTimeout(() => {
                    uploadProgress.innerHTML = `
                        <div style="background: #f0fdf4; padding: 1rem; border-radius: 0.375rem; border-left: 4px solid #16a34a;">
                            <p style="color: #15803d;">✅ 照片上传成功！</p>
                            <p style="color: #15803d; font-size: 0.9rem;">云端地址: https://storage.fwpshop.com/photos/${Date.now()}.jpg</p>
                        </div>
                    `;
                }, 2000);
            }, 100);
        }

        function editPhoto() {
            alert('照片编辑功能 - 支持裁剪、滤镜、标注等');
        }

        function sharePhoto() {
            if (!currentPhotoData) {
                alert('没有可分享的照片');
                return;
            }
            
            if (navigator.share) {
                navigator.share({
                    title: '锋味派美食照片',
                    text: '来自锋味派美食管理系统的照片',
                    files: [new File([currentPhotoData], 'photo.jpg', { type: 'image/jpeg' })]
                });
            } else {
                alert('分享功能 - 支持微信、QQ、朋友圈等平台');
            }
        }

        function uploadPhoto() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        currentPhotoData = e.target.result;
                        document.getElementById('current-photo-preview').innerHTML = `
                            <img src="${currentPhotoData}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 0.375rem;">
                        `;
                        document.getElementById('photo-actions').style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            };
            input.click();
        }

        function openGallery() {
            alert('照片库功能 - 查看所有已保存的照片');
        }

        function clearStorage() {
            if (confirm('确定要清理照片存储空间吗？这将删除所有缓存的照片。')) {
                alert('存储空间清理完成，释放了 500MB 空间');
            }
        }

        // 产品管理功能
        function addProduct() {
            const name = prompt('产品名称:');
            if (!name) return;
            
            const price = parseFloat(prompt('价格:'));
            if (isNaN(price)) return;
            
            const category = prompt('分类 (烤肠系列/烧卖系列/水饺系列/鱼丸系列/面食系列/饭类系列/汤品系列/饮料系列):');
            if (!category) return;
            
            const stock = parseInt(prompt('库存:'));
            if (isNaN(stock)) return;
            
            const newProduct = {
                id: Math.max(...products.map(p => p.id)) + 1,
                name: name,
                price: price,
                category: category,
                stock: stock,
                image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5paw5ZWG5ZOBPHwdGV4dD48L3N2Zz4='
            };
            
            products.push(newProduct);
            showAdminTab('products');
            renderProducts();
            alert('产品添加成功');
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            
            const name = prompt('产品名称:', product.name);
            if (name !== null) product.name = name;
            
            const price = prompt('价格:', product.price);
            if (price !== null && !isNaN(parseFloat(price))) product.price = parseFloat(price);
            
            const category = prompt('分类:', product.category);
            if (category !== null) product.category = category;
            
            const stock = prompt('库存:', product.stock);
            if (stock !== null && !isNaN(parseInt(stock))) product.stock = parseInt(stock);
            
            showAdminTab('products');
            renderProducts();
            alert('产品更新成功');
        }

        function deleteProduct(id) {
            if (confirm('确定要删除这个产品吗？')) {
                products = products.filter(p => p.id !== id);
                showAdminTab('products');
                renderProducts();
                alert('产品删除成功');
            }
        }
    </script>
</body>
</html>