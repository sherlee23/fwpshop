<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FengWei Pai é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­ç³»ç»Ÿ</title>
    <style>
        /* åŸºç¡€é‡ç½® */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif; background: #f8fafc; color: #1a202c; }
        
        /* ä¸»é¢˜è‰²å½© - çº¢è‰²ä¸»é¢˜ */
        :root {
            --primary-color: #dc2626;
            --primary-dark: #b91c1c;
            --primary-light: #ef4444;
            --secondary-color: #64748b;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --info-color: #3b82f6;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn { padding: 0.5rem 1rem; border-radius: 0.375rem; border: none; cursor: pointer; font-weight: 600; transition: all 0.2s; }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-secondary { background: #e5e7eb; color: #374151; }
        .btn-secondary:hover { background: #d1d5db; }
        
        /* å®¹å™¨ */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        
        /* å¤´éƒ¨ */
        .header { background: var(--primary-color); color: white; padding: 1rem 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: bold; }
        .nav-buttons { display: flex; gap: 0.5rem; }
        
        /* åˆ†ç±»å¯¼èˆª */
        .category-nav { background: white; padding: 1rem 0; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; z-index: 40; }
        .category-list { display: flex; gap: 0.5rem; overflow-x: auto; padding: 0 1rem; }
        .category-item { 
            padding: 0.5rem 1rem; 
            border-radius: 1.5rem; 
            background: #f3f4f6; 
            color: #374151; 
            font-weight: 600; 
            white-space: nowrap; 
            cursor: pointer; 
            transition: all 0.2s;
        }
        .category-item.active { background: var(--primary-color); color: white; }
        .category-item:hover { background: var(--primary-light); color: white; }
        
        /* äº§å“ç½‘æ ¼ */
        .products-section { padding: 2rem 0; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
        .product-card { 
            background: white; 
            border-radius: 0.5rem; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
            overflow: hidden; 
            transition: transform 0.2s;
        }
        .product-card:hover { transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .product-image { width: 100%; height: 200px; object-fit: cover; }
        .product-info { padding: 1rem; }
        .product-name { font-weight: bold; margin-bottom: 0.5rem; }
        .product-price { color: var(--primary-color); font-weight: bold; font-size: 1.1rem; }
        .product-actions { padding: 0 1rem 1rem; }
        
        /* è´­ç‰©è½¦ä¾§è¾¹æ  */
        .cart-sidebar { 
            position: fixed; 
            top: 0; 
            right: 0; 
            height: 100vh; 
            width: 400px; 
            background: white; 
            box-shadow: -2px 0 8px rgba(0,0,0,0.1); 
            transform: translateX(100%); 
            transition: transform 0.3s; 
            z-index: 50;
        }
        .cart-sidebar.open { transform: translateX(0); }
        .cart-header { padding: 1rem; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; }
        .cart-content { padding: 1rem; flex: 1; overflow-y: auto; }
        .cart-footer { padding: 1rem; border-top: 1px solid #e5e7eb; }
        
        /* æ¨¡æ€æ¡† */
        .modal-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.5); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            z-index: 50;
        }
        .modal-content { 
            background: white; 
            border-radius: 0.5rem; 
            max-width: 500px; 
            width: 90%; 
            max-height: 90vh; 
            overflow-y: auto;
        }
        .modal-header { padding: 1rem; border-bottom: 1px solid #e5e7eb; font-weight: bold; }
        .modal-body { padding: 1rem; }
        .modal-footer { padding: 1rem; border-top: 1px solid #e5e7eb; display: flex; gap: 0.5rem; justify-content: flex-end; }
        
        /* è¡¨å• */
        .form-group { margin-bottom: 1rem; }
        .form-label { display: block; margin-bottom: 0.25rem; font-weight: 600; }
        .form-input { 
            width: 100%; 
            padding: 0.5rem; 
            border: 1px solid #d1d5db; 
            border-radius: 0.375rem; 
            font-size: 1rem;
        }
        .form-input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1); }
        
        /* åå°ç®¡ç† */
        .admin-layout { display: flex; min-height: 100vh; }
        .admin-sidebar { width: 250px; background: #1f2937; color: white; }
        .admin-content { flex: 1; background: #f9fafb; }
        .admin-nav { padding: 1rem; }
        .admin-nav-item { 
            display: block; 
            padding: 0.75rem 1rem; 
            color: #d1d5db; 
            text-decoration: none; 
            border-radius: 0.375rem; 
            margin-bottom: 0.25rem;
        }
        .admin-nav-item:hover { background: #374151; color: white; }
        .admin-nav-item.active { background: var(--primary-color); color: white; }
        
        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .cart-sidebar { width: 100%; }
            .admin-layout { flex-direction: column; }
            .admin-sidebar { width: 100%; }
            .products-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); }
        }
        
        /* å·¥å…·ç±» */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-red { color: var(--primary-color); }
        .bg-red { background: var(--primary-color); }
        .font-bold { font-weight: bold; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .p-4 { padding: 1rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
    </style>
</head>
<body>
    <div id="app">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">ğŸœ é”‹å‘³æ´¾ç¾é£Ÿ</div>
                    <div class="nav-buttons">
                        <button class="btn btn-secondary" onclick="toggleCart()">ğŸ›’ è´­ç‰©è½¦ (<span id="cart-count">0</span>)</button>
                        <button class="btn btn-secondary" onclick="showAdmin()">ğŸ”§ åå°</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- åˆ†ç±»å¯¼èˆª -->
        <nav class="category-nav">
            <div class="container">
                <div class="category-list" id="category-list">
                    <div class="category-item active" data-category="å…¨éƒ¨å•†å“">ğŸ½ï¸ å…¨éƒ¨å•†å“</div>
                    <div class="category-item" data-category="çƒ¤è‚ ç³»åˆ—">ğŸŒ­ çƒ¤è‚ ç³»åˆ—</div>
                    <div class="category-item" data-category="çƒ§å–ç³»åˆ—">ğŸ¥Ÿ çƒ§å–ç³»åˆ—</div>
                    <div class="category-item" data-category="æ°´é¥ºç³»åˆ—">ğŸ¥Ÿ æ°´é¥ºç³»åˆ—</div>
                    <div class="category-item" data-category="é±¼ä¸¸ç³»åˆ—">ğŸŸ é±¼ä¸¸ç³»åˆ—</div>
                    <div class="category-item" data-category="é¢é£Ÿç³»åˆ—">ğŸœ é¢é£Ÿç³»åˆ—</div>
                    <div class="category-item" data-category="é¥­ç±»ç³»åˆ—">ğŸš é¥­ç±»ç³»åˆ—</div>
                    <div class="category-item" data-category="æ±¤å“ç³»åˆ—">ğŸ² æ±¤å“ç³»åˆ—</div>
                    <div class="category-item" data-category="é¥®æ–™ç³»åˆ—">ğŸ¥¤ é¥®æ–™ç³»åˆ—</div>
                </div>
            </div>
        </nav>

        <!-- äº§å“åŒºåŸŸ -->
        <section class="products-section">
            <div class="container">
                <div class="products-grid" id="products-grid">
                    <!-- äº§å“å°†é€šè¿‡ JavaScript åŠ¨æ€åŠ è½½ -->
                </div>
            </div>
        </section>

        <!-- è´­ç‰©è½¦ä¾§è¾¹æ  -->
        <div class="cart-sidebar" id="cart-sidebar">
            <div class="cart-header">
                <h3>è´­ç‰©è½¦</h3>
                <button class="btn btn-secondary" onclick="toggleCart()">âœ•</button>
            </div>
            <div class="cart-content" id="cart-content">
                <p class="text-center">è´­ç‰©è½¦ä¸ºç©º</p>
            </div>
            <div class="cart-footer">
                <div class="mb-4">
                    <strong>æ€»è®¡: RM <span id="cart-total">0.00</span></strong>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="checkout()">ç»“è´¦</button>
            </div>
        </div>

        <!-- ç»“è´¦æ¨¡æ€æ¡† -->
        <div class="modal-overlay hidden" id="checkout-modal">
            <div class="modal-content">
                <div class="modal-header">ç»“è´¦</div>
                <div class="modal-body">
                    <form id="checkout-form">
                        <div class="form-group">
                            <label class="form-label">é…é€æ–¹å¼</label>
                            <label><input type="radio" name="delivery" value="pickup" checked> è‡ªå–</label>
                            <label><input type="radio" name="delivery" value="delivery"> é…é€</label>
                        </div>
                        
                        <div id="pickup-address" class="form-group">
                            <label class="form-label">å–è´§åœ°å€</label>
                            <p>667, Jalan 24, Taman Perindustrian Ehsan Jaya, Kepong, 52100, Kuala Lumpur.</p>
                        </div>
                        
                        <div id="delivery-form" class="form-group hidden">
                            <label class="form-label">é…é€åœ°å€</label>
                            <input type="text" class="form-input" name="address" placeholder="è¯·è¾“å…¥å®Œæ•´åœ°å€">
                            <label class="form-label">å¤‡æ³¨</label>
                            <textarea class="form-input" name="remarks" placeholder="ç»™Lalamoveçš„å¤‡æ³¨"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ä»˜æ¬¾æ–¹å¼</label>
                            <label><input type="radio" name="payment" value="maybank" checked> Maybank QR</label>
                            <label><input type="radio" name="payment" value="tng"> TNG eWallet</label>
                        </div>
                        
                        <div id="payment-info">
                            <div id="maybank-info">
                                <p><strong>Maybankè½¬è´¦ä¿¡æ¯:</strong></p>
                                <p>æˆ·å: Choong Sher Lee</p>
                                <p>è´¦å·: 114209540438</p>
                                <p>é“¶è¡Œ: Maybank</p>
                            </div>
                            <div id="tng-info" class="hidden">
                                <p><strong>TNG eWallet</strong></p>
                                <p>è¯·æ‰«æäºŒç»´ç ä»˜æ¬¾</p>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">è”ç³»æ–¹å¼</label>
                            <input type="text" class="form-input" name="phone" placeholder="æ‰‹æœºå·ç " required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å§“å</label>
                            <input type="text" class="form-input" name="name" placeholder="å§“å" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeCheckout()">å–æ¶ˆ</button>
                    <button class="btn btn-primary" onclick="submitOrder()">æäº¤è®¢å•</button>
                </div>
            </div>
        </div>

        <!-- åå°ç®¡ç†æ¨¡æ€æ¡† -->
        <div class="modal-overlay hidden" id="admin-modal">
            <div class="modal-content" style="max-width: 90%; width: 1000px;">
                <div class="modal-header">
                    <span>åå°ç®¡ç†</span>
                    <button class="btn btn-secondary" onclick="closeAdmin()" style="float: right;">âœ•</button>
                </div>
                <div class="modal-body" style="padding: 0;">
                    <div class="admin-layout">
                        <div class="admin-sidebar">
                            <div class="admin-nav">
                                <a href="#" class="admin-nav-item active" onclick="showAdminTab('dashboard')">ğŸ“Š ä»ªè¡¨ç›˜</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('products')">ğŸ“¦ äº§å“ç®¡ç†</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('inventory')">ğŸ“‹ åº“å­˜ç®¡ç†</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('orders')">ğŸ“‹ è®¢å•ç®¡ç†</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('members')">ğŸ‘¥ ä¼šå‘˜ç®¡ç†</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('analytics')">ğŸ“ˆ æ•°æ®åˆ†æ</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('scanner')">ğŸ“± æ‰«ç åŠŸèƒ½</a>
                                <a href="#" class="admin-nav-item" onclick="showAdminTab('camera')">ğŸ“· æ‹ç…§åŠŸèƒ½</a>
                            </div>
                        </div>
                        <div class="admin-content">
                            <div id="admin-content">
                                <!-- åŠ¨æ€å†…å®¹ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let cart = [];
        let products = [];
        let currentCategory = 'å…¨éƒ¨å•†å“';

        // ç¤ºä¾‹äº§å“æ•°æ®
        const sampleProducts = [
            { id: 1, name: 'ç»å…¸å°å¼çƒ¤è‚ ', price: 12.50, category: 'çƒ¤è‚ ç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5Y+w5byP54Kk6IKgPC90ZXh0Pjwvc3ZnPg==', stock: 20 },
            { id: 2, name: 'é»‘çŒªä¸‰ä¸çº¸çš®çƒ§å–', price: 8.80, category: 'çƒ§å–ç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+54Gn5Y2WPC90ZXh0Pjwvc3ZnPg==', stock: 15 },
            { id: 3, name: 'æ‰‹å·¥éŸ­èœæ°´é¥º', price: 6.50, category: 'æ°´é¥ºç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5LiA6aWDPC90ZXh0Pjwvc3ZnPg==', stock: 30 },
            { id: 4, name: 'Qå¼¹é±¼ä¸¸', price: 4.20, category: 'é±¼ä¸¸ç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+6bG85LiLPC90ZXh0Pjwvc3ZnPg==', stock: 25 },
            { id: 5, name: 'å…°å·æ‹‰é¢', price: 15.80, category: 'é¢é£Ÿç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5ouJ6Z2iPC90ZXh0Pjwvc3ZnPg==', stock: 40 },
            { id: 6, name: 'æ‹›ç‰Œé¸¡é¥­', price: 18.80, category: 'é¥­ç±»ç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+6bih6aWZPC90ZXh0Pjwvc3ZnPg==', stock: 10 },
            { id: 7, name: 'å†¬ç“œæ’éª¨æ±¤', price: 12.00, category: 'æ±¤å“ç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5rGk5ZYNPC90ZXh0Pjwvc3ZnPg==', stock: 25 },
            { id: 8, name: 'ç‰¹è°ƒå¥¶èŒ¶', price: 5.80, category: 'é¥®æ–™ç³»åˆ—', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5aWK6IyaPC90ZXh0Pjwvc3ZnPg==', stock: 50 }
        ];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            products = sampleProducts;
            renderProducts();
            setupCategoryNavigation();
            setupDeliveryToggle();
            setupPaymentToggle();
        });

        // æ¸²æŸ“äº§å“
        function renderProducts() {
            const grid = document.getElementById('products-grid');
            const filteredProducts = currentCategory === 'å…¨éƒ¨å•†å“' 
                ? products 
                : products.filter(p => p.category === currentCategory);

            grid.innerHTML = filteredProducts.map(product => `
                <div class="product-card">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">RM ${product.price.toFixed(2)}</div>
                        <div style="font-size: 0.9rem; color: #6b7280;">åº“å­˜: ${product.stock}</div>
                    </div>
                    <div class="product-actions">
                        <button class="btn btn-primary" style="width: 100%;" onclick="addToCart(${product.id})">åŠ å…¥è´­ç‰©è½¦</button>
                    </div>
                </div>
            `).join('');
        }

        // åˆ†ç±»å¯¼èˆª
        function setupCategoryNavigation() {
            const categoryItems = document.querySelectorAll('.category-item');
            categoryItems.forEach(item => {
                item.addEventListener('click', function() {
                    categoryItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    renderProducts();
                });
            });
        }

        // æ·»åŠ åˆ°è´­ç‰©è½¦
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock <= 0) {
                alert('å•†å“åº“å­˜ä¸è¶³');
                return;
            }

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    alert('å·²è¾¾åˆ°åº“å­˜ä¸Šé™');
                    return;
                }
            } else {
                cart.push({ ...product, quantity: 1 });
            }

            updateCartDisplay();
            updateCartCount();
        }

        // æ›´æ–°è´­ç‰©è½¦æ˜¾ç¤º
        function updateCartDisplay() {
            const cartContent = document.getElementById('cart-content');
            if (cart.length === 0) {
                cartContent.innerHTML = '<p class="text-center">è´­ç‰©è½¦ä¸ºç©º</p>';
                document.getElementById('cart-total').textContent = '0.00';
                return;
            }

            cartContent.innerHTML = cart.map(item => `
                <div class="flex items-center justify-between mb-4" style="border-bottom: 1px solid #e5e7eb; padding-bottom: 1rem;">
                    <div>
                        <div class="font-bold">${item.name}</div>
                        <div class="text-red">RM ${item.price.toFixed(2)}</div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button class="btn btn-secondary" onclick="updateQuantity(${item.id}, -1)">-</button>
                        <span>${item.quantity}</span>
                        <button class="btn btn-secondary" onclick="updateQuantity(${item.id}, 1)">+</button>
                        <button class="btn btn-secondary" onclick="removeFromCart(${item.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('cart-total').textContent = total.toFixed(2);
        }

        // æ›´æ–°è´­ç‰©è½¦æ•°é‡
        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }

        // æ›´æ–°å•†å“æ•°é‡
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            const product = products.find(p => p.id === productId);
            
            if (item) {
                const newQuantity = item.quantity + change;
                if (newQuantity <= 0) {
                    removeFromCart(productId);
                } else if (newQuantity <= product.stock) {
                    item.quantity = newQuantity;
                    updateCartDisplay();
                    updateCartCount();
                } else {
                    alert('è¶…å‡ºåº“å­˜é™åˆ¶');
                }
            }
        }

        // ä»è´­ç‰©è½¦ç§»é™¤
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
            updateCartCount();
        }

        // åˆ‡æ¢è´­ç‰©è½¦
        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            sidebar.classList.toggle('open');
        }

        // ç»“è´¦
        function checkout() {
            if (cart.length === 0) {
                alert('è´­ç‰©è½¦ä¸ºç©º');
                return;
            }
            document.getElementById('checkout-modal').classList.remove('hidden');
        }

        // å…³é—­ç»“è´¦
        function closeCheckout() {
            document.getElementById('checkout-modal').classList.add('hidden');
        }

        // é…é€æ–¹å¼åˆ‡æ¢
        function setupDeliveryToggle() {
            const deliveryRadios = document.querySelectorAll('input[name="delivery"]');
            deliveryRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const pickupDiv = document.getElementById('pickup-address');
                    const deliveryDiv = document.getElementById('delivery-form');
                    
                    if (this.value === 'pickup') {
                        pickupDiv.classList.remove('hidden');
                        deliveryDiv.classList.add('hidden');
                    } else {
                        pickupDiv.classList.add('hidden');
                        deliveryDiv.classList.remove('hidden');
                    }
                });
            });
        }

        // ä»˜æ¬¾æ–¹å¼åˆ‡æ¢
        function setupPaymentToggle() {
            const paymentRadios = document.querySelectorAll('input[name="payment"]');
            paymentRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const maybankInfo = document.getElementById('maybank-info');
                    const tngInfo = document.getElementById('tng-info');
                    
                    if (this.value === 'maybank') {
                        maybankInfo.classList.remove('hidden');
                        tngInfo.classList.add('hidden');
                    } else {
                        maybankInfo.classList.add('hidden');
                        tngInfo.classList.remove('hidden');
                    }
                });
            });
        }

        // æäº¤è®¢å•
        function submitOrder() {
            const form = document.getElementById('checkout-form');
            const formData = new FormData(form);
            
            const orderData = {
                items: cart,
                delivery: formData.get('delivery'),
                payment: formData.get('payment'),
                phone: formData.get('phone'),
                name: formData.get('name'),
                total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)
            };

            if (orderData.delivery === 'delivery') {
                orderData.address = formData.get('address');
                orderData.remarks = formData.get('remarks');
            }

            // éªŒè¯å¿…å¡«å­—æ®µ
            if (!orderData.phone || !orderData.name) {
                alert('è¯·å¡«å†™è”ç³»æ–¹å¼å’Œå§“å');
                return;
            }

            if (orderData.delivery === 'delivery' && !orderData.address) {
                alert('è¯·å¡«å†™é…é€åœ°å€');
                return;
            }

            // ç”Ÿæˆè®¢å•å·
            const orderNumber = 'FWP' + Date.now().toString().slice(-8);
            
            // ç”ŸæˆWhatsAppæ¶ˆæ¯
            const message = `æ–°è®¢å• ${orderNumber}\n\n` +
                `å®¢æˆ·: ${orderData.name}\n` +
                `ç”µè¯: ${orderData.phone}\n` +
                `é…é€: ${orderData.delivery === 'pickup' ? 'è‡ªå–' : 'é…é€'}\n` +
                (orderData.address ? `åœ°å€: ${orderData.address}\n` : '') +
                (orderData.remarks ? `å¤‡æ³¨: ${orderData.remarks}\n` : '') +
                `ä»˜æ¬¾: ${orderData.payment === 'maybank' ? 'Maybank' : 'TNG eWallet'}\n\n` +
                `è®¢å•å†…å®¹:\n` +
                cart.map(item => `${item.name} x${item.quantity} = RM${(item.price * item.quantity).toFixed(2)}`).join('\n') +
                `\n\næ€»è®¡: RM${orderData.total.toFixed(2)}`;

            const whatsappUrl = `https://wa.me/60162327792?text=${encodeURIComponent(message)}`;
            
            // å‡å°‘åº“å­˜
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                if (product) {
                    product.stock -= item.quantity;
                }
            });

            alert(`è®¢å•æäº¤æˆåŠŸï¼è®¢å•å·: ${orderNumber}\n\nå³å°†è·³è½¬åˆ°WhatsAppç¡®è®¤è®¢å•...`);
            
            // æ¸…ç©ºè´­ç‰©è½¦
            cart = [];
            updateCartDisplay();
            updateCartCount();
            closeCheckout();
            renderProducts();
            
            // è·³è½¬åˆ°WhatsApp
            window.open(whatsappUrl, '_blank');
        }

        // æ˜¾ç¤ºåå°ç®¡ç†
        function showAdmin() {
            const password = prompt('è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç :');
            if (password === 'fengweipaiadmin') {
                document.getElementById('admin-modal').classList.remove('hidden');
                showAdminTab('dashboard');
            } else if (password !== null) {
                alert('å¯†ç é”™è¯¯');
            }
        }

        // å…³é—­åå°ç®¡ç†
        function closeAdmin() {
            document.getElementById('admin-modal').classList.add('hidden');
        }

        // æ˜¾ç¤ºåå°æ ‡ç­¾é¡µ
        function showAdminTab(tab) {
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.admin-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');

            const content = document.getElementById('admin-content');
            
            switch(tab) {
                case 'dashboard':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">ä»ªè¡¨ç›˜</h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3>æ€»äº§å“æ•°</h3>
                                    <p style="font-size: 2rem; font-weight: bold; color: var(--primary-color);">${products.length}</p>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3>åº“å­˜æ€»å€¼</h3>
                                    <p style="font-size: 2rem; font-weight: bold; color: var(--success-color);">RM${products.reduce((sum, p) => sum + (p.price * p.stock), 0).toFixed(2)}</p>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3>ä½åº“å­˜å•†å“</h3>
                                    <p style="font-size: 2rem; font-weight: bold; color: var(--warning-color);">${products.filter(p => p.stock < 10).length}</p>
                                </div>
                            </div>
                            <div style="margin-top: 2rem;">
                                <h3>åº“å­˜çŠ¶æ€</h3>
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-top: 1rem;">
                                    ${products.map(p => `
                                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid #e5e7eb;">
                                            <span>${p.name}</span>
                                            <span style="color: ${p.stock < 10 ? 'var(--danger-color)' : 'var(--success-color)'};">åº“å­˜: ${p.stock}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'products':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">äº§å“ç®¡ç†</h2>
                            <button class="btn btn-primary mb-4" onclick="addProduct()">æ·»åŠ æ–°äº§å“</button>
                            <div style="background: white; border-radius: 0.5rem; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead style="background: #f9fafb;">
                                        <tr>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">äº§å“åç§°</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">åˆ†ç±»</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">ä»·æ ¼</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">åº“å­˜</th>
                                            <th style="padding: 1rem; text-align: left; border-bottom: 1px solid #e5e7eb;">æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${products.map(p => `
                                            <tr>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">${p.name}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">${p.category}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">RM${p.price.toFixed(2)}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">${p.stock}</td>
                                                <td style="padding: 1rem; border-bottom: 1px solid #e5e7eb;">
                                                    <button class="btn btn-secondary" onclick="editProduct(${p.id})">ç¼–è¾‘</button>
                                                    <button class="btn btn-secondary" onclick="deleteProduct(${p.id})" style="margin-left: 0.5rem;">åˆ é™¤</button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'orders':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">è®¢å•ç®¡ç†</h2>
                            <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                <p class="text-center">æš‚æ— è®¢å•è®°å½•</p>
                                <p class="text-center" style="margin-top: 1rem; color: #6b7280;">è®¢å•å°†é€šè¿‡WhatsAppç®¡ç†</p>
                            </div>
                        </div>
                    `;
                    break;
                case 'analytics':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">æ•°æ®åˆ†æ</h2>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3>åˆ†ç±»åˆ†å¸ƒ</h3>
                                    <div style="margin-top: 1rem;">
                                        ${Array.from(new Set(products.map(p => p.category))).map(category => {
                                            const count = products.filter(p => p.category === category).length;
                                            return `<div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                                                <span>${category}</span>
                                                <span>${count} ä¸ªäº§å“</span>
                                            </div>`;
                                        }).join('')}
                                    </div>
                                </div>
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                    <h3>åº“å­˜ç»Ÿè®¡</h3>
                                    <div style="margin-top: 1rem;">
                                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                                            <span>æ€»åº“å­˜</span>
                                            <span>${products.reduce((sum, p) => sum + p.stock, 0)} ä»¶</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                                            <span>å¹³å‡åº“å­˜</span>
                                            <span>${Math.round(products.reduce((sum, p) => sum + p.stock, 0) / products.length)} ä»¶</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; color: var(--danger-color);">
                                            <span>ä½åº“å­˜(<10)</span>
                                            <span>${products.filter(p => p.stock < 10).length} ä¸ªäº§å“</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'scanner':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">æ‰«ç åŠŸèƒ½</h2>
                            <div style="background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">
                                <p style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“±</p>
                                <h3>æ‰«ç åŠŸèƒ½</h3>
                                <p style="color: #6b7280; margin: 1rem 0;">æ”¯æŒäºŒç»´ç å’Œæ¡å½¢ç æ‰«æ</p>
                                <button class="btn btn-primary" onclick="startScanner()">å¯åŠ¨æ‰«ç </button>
                                <div id="scanner-result" style="margin-top: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.375rem; display: none;">
                                    <h4>æ‰«æç»“æœ:</h4>
                                    <p id="scanner-text" style="margin-top: 0.5rem; word-break: break-all;"></p>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 'camera':
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">æ‹ç…§åŠŸèƒ½</h2>
                            <div style="background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">
                                <p style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“·</p>
                                <h3>æ‹ç…§åŠŸèƒ½</h3>
                                <p style="color: #6b7280; margin: 1rem 0;">æ”¯æŒç›¸æœºæ‹ç…§å’Œå›¾ç‰‡ä¸Šä¼ </p>
                                <button class="btn btn-primary" onclick="startCamera()">å¯åŠ¨ç›¸æœº</button>
                                <div id="camera-preview" style="margin-top: 1rem; display: none;">
                                    <video id="camera-video" style="width: 100%; max-width: 400px; border-radius: 0.375rem;" autoplay playsinline></video>
                                    <br>
                                    <button class="btn btn-primary" onclick="takePhoto()" style="margin-top: 1rem;">æ‹ç…§</button>
                                    <button class="btn btn-secondary" onclick="stopCamera()" style="margin-top: 1rem; margin-left: 0.5rem;">åœæ­¢</button>
                                </div>
                                <div id="photo-result" style="margin-top: 1rem; display: none;">
                                    <h4>æ‹ç…§ç»“æœ:</h4>
                                    <img id="photo-image" style="width: 100%; max-width: 400px; border-radius: 0.375rem; margin-top: 0.5rem;">
                                    <br>
                                    <button class="btn btn-success" onclick="savePhoto()" style="margin-top: 1rem;">ä¿å­˜ç…§ç‰‡</button>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                default:
                    content.innerHTML = `
                        <div class="p-4">
                            <h2 class="font-bold mb-4">${tab}</h2>
                            <div style="background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); text-align: center;">
                                <p>æ­¤åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                            </div>
                        </div>
                    `;
            }
        }

        // æ‰«ç åŠŸèƒ½
        function startScanner() {
            // æ¨¡æ‹Ÿæ‰«ç åŠŸèƒ½
            const simulatedCode = 'FWP' + Math.random().toString(36).substr(2, 9).toUpperCase();
            document.getElementById('scanner-result').style.display = 'block';
            document.getElementById('scanner-text').textContent = simulatedCode;
        }

        // ç›¸æœºåŠŸèƒ½
        let cameraStream = null;

        function startCamera() {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                .then(function(stream) {
                    cameraStream = stream;
                    const video = document.getElementById('camera-video');
                    video.srcObject = stream;
                    document.getElementById('camera-preview').style.display = 'block';
                })
                .catch(function(err) {
                    alert('æ— æ³•è®¿é—®ç›¸æœº: ' + err.message);
                });
        }

        function stopCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            document.getElementById('camera-preview').style.display = 'none';
            document.getElementById('photo-result').style.display = 'none';
        }

        function takePhoto() {
            const video = document.getElementById('camera-video');
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);
            
            const photoData = canvas.toDataURL('image/jpeg', 0.8);
            document.getElementById('photo-image').src = photoData;
            document.getElementById('photo-result').style.display = 'block';
        }

        function savePhoto() {
            const img = document.getElementById('photo-image');
            const link = document.createElement('a');
            link.download = 'photo-' + Date.now() + '.jpg';
            link.href = img.src;
            link.click();
            alert('ç…§ç‰‡å·²ä¿å­˜');
        }

        // äº§å“ç®¡ç†åŠŸèƒ½
        function addProduct() {
            const name = prompt('äº§å“åç§°:');
            if (!name) return;
            
            const price = parseFloat(prompt('ä»·æ ¼:'));
            if (isNaN(price)) return;
            
            const category = prompt('åˆ†ç±» (çƒ¤è‚ ç³»åˆ—/çƒ§å–ç³»åˆ—/æ°´é¥ºç³»åˆ—/é±¼ä¸¸ç³»åˆ—/é¢é£Ÿç³»åˆ—/é¥­ç±»ç³»åˆ—/æ±¤å“ç³»åˆ—/é¥®æ–™ç³»åˆ—):');
            if (!category) return;
            
            const stock = parseInt(prompt('åº“å­˜:'));
            if (isNaN(stock)) return;
            
            const newProduct = {
                id: Math.max(...products.map(p => p.id)) + 1,
                name: name,
                price: price,
                category: category,
                stock: stock,
                image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjgwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2RjMjYyNiIvPjx0ZXh0IHg9IjE0MCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCI+5paw5ZWG5ZOBPHwdGV4dD48L3N2Zz4='
            };
            
            products.push(newProduct);
            showAdminTab('products');
            renderProducts();
            alert('äº§å“æ·»åŠ æˆåŠŸ');
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;
            
            const name = prompt('äº§å“åç§°:', product.name);
            if (name !== null) product.name = name;
            
            const price = prompt('ä»·æ ¼:', product.price);
            if (price !== null && !isNaN(parseFloat(price))) product.price = parseFloat(price);
            
            const category = prompt('åˆ†ç±»:', product.category);
            if (category !== null) product.category = category;
            
            const stock = prompt('åº“å­˜:', product.stock);
            if (stock !== null && !isNaN(parseInt(stock))) product.stock = parseInt(stock);
            
            showAdminTab('products');
            renderProducts();
            alert('äº§å“æ›´æ–°æˆåŠŸ');
        }

        function deleteProduct(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªäº§å“å—ï¼Ÿ')) {
                products = products.filter(p => p.id !== id);
                showAdminTab('products');
                renderProducts();
                alert('äº§å“åˆ é™¤æˆåŠŸ');
            }
        }
    </script>
</body>
</html>