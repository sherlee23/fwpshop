<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://edfnhhthztskuuosuasw.supabase.co/storage/v1/object/public/product-photos/icon3.jpg">
    <title>é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­ç³»ç»Ÿ</title>
    
    <!-- ===== åŠŸèƒ½å¼€å…³é…ç½® ===== -->
    <script>
        // ğŸ¯ ä¼šå‘˜åŠŸèƒ½é…ç½®å¼€å…³ - åœ¨æ­¤æ§åˆ¶æ‰€æœ‰ä¼šå‘˜ç›¸å…³åŠŸèƒ½
        window.MEMBER_CONFIG = {
            ENABLE_MEMBER_SYSTEM: true,        // å¯ç”¨ä¼šå‘˜ç³»ç»Ÿ
            ENABLE_MEMBER_LOGIN: true,         // å¯ç”¨ä¼šå‘˜ç™»å½•
            ENABLE_MEMBER_POINTS: true,        // å¯ç”¨ç§¯åˆ†ç³»ç»Ÿ
            ENABLE_ORDER_HISTORY: true,       // å¯ç”¨è®¢å•å†å²
            ENABLE_PHONE_VERIFICATION: true,  // å¯ç”¨æ‰‹æœºå·éªŒè¯
            ENABLE_AUTO_MEMBER_CREATE: true,  // å¯ç”¨è‡ªåŠ¨åˆ›å»ºä¼šå‘˜
            ENABLE_MEMBER_BACKEND: true       // å¯ç”¨åå°ä¼šå‘˜ç®¡ç†
        };
        
        // ğŸ”§ ç³»ç»ŸåŠŸèƒ½é…ç½®
        window.SYSTEM_CONFIG = {
            ENABLE_INVENTORY_MANAGEMENT: true, // å¯ç”¨åº“å­˜ç®¡ç†
            ENABLE_CATEGORY_NAVIGATION: true,  // å¯ç”¨åˆ†ç±»å¯¼èˆª
            ENABLE_SHOPPING_CART: true,        // å¯ç”¨è´­ç‰©è½¦
            ENABLE_ADMIN_BACKEND: true,        // å¯ç”¨ç®¡ç†åå°
            ENABLE_WHATSAPP_NOTIFY: true,      // å¯ç”¨WhatsAppé€šçŸ¥
            ENABLE_PAYMENT_PROOF: true,        // å¯ç”¨æ”¯ä»˜å‡­è¯
            ENABLE_SCANNER_CAMERA: true        // å¯ç”¨æ‰«ç æ‹ç…§åŠŸèƒ½
        };
    </script>
    
    <!-- ===== Supabase é…ç½®å†…åµŒ ===== -->
    <script src="https://unpkg.com/@supabase/supabase-js@2.39.3/dist/umd/supabase.js"></script>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>
    
    <!-- ===== å¢å¼ºCSSæ ·å¼ - èåˆè®¾è®¡ç³»ç»Ÿ ===== -->
    <style>
        /* è®¾è®¡ç³»ç»Ÿå˜é‡ - ä¿®å¤æ­£ç¡®é…è‰²æ–¹æ¡ˆ */
        :root {
            --color-background: #f8fafc;
            --color-surface: #ffffff;
            --color-text: #333333;
            --color-text-secondary: #6b7280;
            --color-primary: #dc2626;
            --color-primary-hover: #b91c1c;
            --color-primary-active: #991b1b;
            --color-secondary: rgba(107, 114, 128, 0.12);
            --color-border: #d1d5db;
            --color-error: #dc2626;
            --color-success: #16a34a;
            --color-warning: #f59e0b;
            --color-focus-ring: rgba(220, 38, 38, 0.4);
            
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            
            --space-1: 0.25rem;
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-5: 1.25rem;
            --space-6: 1.5rem;
            --space-8: 2rem;
            
            --radius-sm: 0.375rem;
            --radius-base: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-full: 9999px;
            
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        /* æš—è‰²æ¨¡å¼ */
        @media (prefers-color-scheme: dark) {
            :root {
                --color-background: #111827;
                --color-surface: #1f2937;
                --color-text: #f9fafb;
                --color-text-secondary: rgba(156, 163, 175, 0.7);
                --color-primary: #ef4444;
                --color-border: rgba(75, 85, 99, 0.3);
            }
        }
        
        /* åŸºç¡€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-family-base);
            font-size: var(--font-size-base);
            line-height: 1.6;
            color: var(--color-text);
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
        }
        
        /* ğŸ¨ ç»„ä»¶æ ·å¼ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--space-4);
        }
        
        /* æŒ‰é’®ç³»ç»Ÿ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            border: none;
            border-radius: var(--radius-base);
            font-size: var(--font-size-sm);
            font-weight: 600;
            line-height: 1.5;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            position: relative;
        }
        
        .btn:focus-visible {
            outline: none;
            box-shadow: 0 0 0 3px var(--color-focus-ring);
        }
        
        .btn--primary {
            background: var(--color-primary);
            color: white;
        }
        
        .btn--primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-1px);
        }
        
        .btn--secondary {
            background: var(--color-secondary);
            color: var(--color-text);
        }
        
        .btn--danger {
            background: var(--color-error);
            color: white;
        }
        
        .btn--success {
            background: var(--color-success);
            color: white;
        }
        
        /* è¡¨å•æ§ä»¶ */
        .form-control {
            display: block;
            width: 100%;
            padding: var(--space-2) var(--space-3);
            font-size: var(--font-size-base);
            line-height: 1.5;
            color: var(--color-text);
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        .form-control:focus {
            border-color: var(--color-primary);
            outline: none;
            box-shadow: 0 0 0 3px var(--color-focus-ring);
        }
        
        .form-label {
            display: block;
            margin-bottom: var(--space-2);
            font-weight: 600;
            font-size: var(--font-size-sm);
            color: var(--color-text);
        }
        
        .form-group {
            margin-bottom: var(--space-4);
        }
        
        /* å¯†ç å¯è§æ€§åˆ‡æ¢ */
        .password-input-container {
            position: relative;
        }
        
        .password-toggle {
            position: absolute;
            right: var(--space-3);
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--color-text-secondary);
            cursor: pointer;
            padding: var(--space-1);
            border-radius: var(--radius-sm);
        }
        
        .password-toggle:hover {
            color: var(--color-text);
            background: var(--color-secondary);
        }
        
        /* å¡ç‰‡ç»„ä»¶ */
        .card {
            background-color: var(--color-surface);
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-border);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: box-shadow 0.2s ease;
        }
        
        .card:hover {
            box-shadow: var(--shadow-md);
        }
        
        .card__body {
            padding: var(--space-4);
        }
        
        /* å¯¼èˆªæ  */
        .navbar {
            background: var(--color-primary);
            color: white;
            padding: var(--space-4) 0;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 50;
        }
        
        /* åˆ†ç±»å¯¼èˆª */
        .category-nav {
            background: var(--color-surface);
            border-bottom: 1px solid var(--color-border);
            padding: var(--space-3) 0;
            position: sticky;
            top: 70px;
            z-index: 40;
        }
        
        .category-buttons {
            display: flex;
            gap: var(--space-2);
            justify-content: center;
            flex-wrap: wrap;
            padding: 0 var(--space-4);
        }
        
        .category-btn {
            padding: var(--space-2) var(--space-4);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-full);
            background: var(--color-surface);
            color: var(--color-text);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: var(--font-size-sm);
        }
        
        .category-btn:hover,
        .category-btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
            transform: translateY(-1px);
        }
        
        /* è´­ç‰©è½¦ä¾§è¾¹æ  */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: var(--color-surface);
            box-shadow: var(--shadow-lg);
            transition: right 0.3s ease;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }
        
        .cart-sidebar.open {
            right: 0;
        }
        
        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 90;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .cart-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        /* è´­ç‰©è½¦å¾½ç«  */
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--color-error);
            color: white;
            border-radius: var(--radius-full);
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        /* æµ®åŠ¨è´­ç‰©è½¦æŒ‰é’® */
        .floating-cart {
            position: fixed;
            bottom: var(--space-6);
            right: var(--space-6);
            z-index: 40;
        }
        
        .floating-cart-btn {
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));
            color: white;
            border: none;
            border-radius: var(--radius-full);
            padding: var(--space-4);
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .floating-cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        /* äº§å“ç½‘æ ¼ */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-6);
            padding: var(--space-6) 0;
        }
        
        .product-card {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        }
        
        .product-info {
            padding: var(--space-4);
        }
        
        .product-name {
            font-weight: 600;
            font-size: var(--font-size-lg);
            margin-bottom: var(--space-2);
            color: var(--color-text);
        }
        
        .product-price {
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: var(--space-3);
        }
        
        /* ç®¡ç†åå°å¸ƒå±€ */
        .admin-layout {
            display: flex;
            min-height: 100vh;
        }
        
        .admin-sidebar {
            width: 250px;
            background: var(--color-surface);
            border-right: 1px solid var(--color-border);
            padding: var(--space-6) 0;
        }
        
        .admin-content {
            flex: 1;
            padding: var(--space-6);
            background: var(--color-background);
            overflow-y: auto;
        }
        
        .admin-nav {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .admin-nav-item {
            display: flex;
            align-items: center;
            padding: var(--space-3) var(--space-6);
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            color: var(--color-text);
        }
        
        .admin-nav-item:hover,
        .admin-nav-item.active {
            background: var(--color-secondary);
            border-left-color: var(--color-primary);
            color: var(--color-primary);
        }
        
        .admin-nav-icon {
            font-size: var(--font-size-lg);
            margin-right: var(--space-3);
            width: 20px;
        }
        
        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status {
            display: inline-flex;
            align-items: center;
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-full);
            font-weight: 600;
            font-size: var(--font-size-sm);
        }
        
        .status--success {
            background: rgba(33, 128, 141, 0.1);
            color: var(--color-success);
            border: 1px solid rgba(33, 128, 141, 0.2);
        }
        
        .status--warning {
            background: rgba(168, 75, 47, 0.1);
            color: var(--color-warning);
            border: 1px solid rgba(168, 75, 47, 0.2);
        }
        
        .status--error {
            background: rgba(192, 21, 47, 0.1);
            color: var(--color-error);
            border: 1px solid rgba(192, 21, 47, 0.2);
        }
        
        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
        }
        
        .modal-header {
            padding: var(--space-5);
            border-bottom: 1px solid var(--color-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: var(--space-5);
        }
        
        .modal-footer {
            padding: var(--space-5);
            border-top: 1px solid var(--color-border);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-3);
        }
        
        /* ç™»å½•ç•Œé¢ */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        
        .login-container {
            background: var(--color-surface);
            padding: var(--space-8);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-header h1 {
            color: var(--color-primary);
            margin-bottom: var(--space-2);
            font-size: var(--font-size-3xl);
        }
        
        .login-header p {
            color: var(--color-text-secondary);
            margin-bottom: var(--space-6);
        }
        
        .login-form {
            text-align: left;
        }
        
        /* è¡¨æ ¼æ ·å¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--space-4);
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .data-table th,
        .data-table td {
            padding: var(--space-3);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }
        
        .data-table th {
            background: var(--color-secondary);
            font-weight: 600;
            color: var(--color-text);
        }
        
        .data-table tr:hover {
            background: var(--color-secondary);
        }
        
        /* å·¥å…·æ  */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
            gap: var(--space-4);
            flex-wrap: wrap;
        }
        
        .toolbar-left,
        .toolbar-right {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        /* åŠ è½½çŠ¶æ€ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--color-border);
            border-radius: 50%;
            border-top-color: var(--color-primary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: var(--space-8);
            color: var(--color-text-secondary);
        }
        
        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: var(--space-4);
        }
        
        /* é€šçŸ¥æ¶ˆæ¯ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-base);
            max-width: 300px;
            box-shadow: var(--shadow-lg);
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .toast.success {
            background: rgba(33, 128, 141, 0.1);
            color: var(--color-success);
            border: 1px solid rgba(33, 128, 141, 0.2);
        }
        
        .toast.error {
            background: rgba(192, 21, 47, 0.1);
            color: var(--color-error);
            border: 1px solid rgba(192, 21, 47, 0.2);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 0 var(--space-3);
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: var(--space-4);
            }
            
            .category-buttons {
                justify-content: flex-start;
                overflow-x: auto;
                flex-wrap: nowrap;
                padding-bottom: var(--space-2);
            }
            
            .cart-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .admin-layout {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid var(--color-border);
            }
            
            .admin-nav {
                display: flex;
                overflow-x: auto;
                padding: 0 var(--space-4);
            }
            
            .admin-nav-item {
                flex: 0 0 auto;
                padding: var(--space-2) var(--space-4);
                border-left: none;
                border-bottom: 3px solid transparent;
            }
            
            .admin-nav-item:hover,
            .admin-nav-item.active {
                border-left: none;
                border-bottom-color: var(--color-primary);
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .toolbar-left,
            .toolbar-right {
                justify-content: center;
            }
        }
        
        /* åº“å­˜çŠ¶æ€ */
        .stock-badge {
            display: inline-flex;
            align-items: center;
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .stock-badge--in-stock {
            background: rgba(33, 128, 141, 0.1);
            color: var(--color-success);
        }
        
        .stock-badge--low-stock {
            background: rgba(168, 75, 47, 0.1);
            color: var(--color-warning);
        }
        
        .stock-badge--out-of-stock {
            background: rgba(192, 21, 47, 0.1);
            color: var(--color-error);
        }
        
        /* äº§å“å¾½ç«  */
        .product-badge {
            position: absolute;
            top: var(--space-3);
            right: var(--space-3);
            background: var(--color-primary);
            color: white;
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .product-badge--presale {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        }
        
        .product-badge--low-stock {
            background: linear-gradient(135deg, #f59e0b, #ef4444);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* é¡µé¢æ ‡é¢˜ */
        .page-header {
            margin-bottom: var(--space-6);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-4);
        }
        
        .page-title {
            font-size: var(--font-size-3xl);
            font-weight: 700;
            color: var(--color-text);
            margin: 0;
        }
        
        .page-subtitle {
            margin: var(--space-1) 0 0 0;
            color: var(--color-text-secondary);
            font-size: var(--font-size-base);
        }
        
        /* åŠŸèƒ½åˆ‡æ¢å¼€å…³ */
        .feature-toggle {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-bottom: var(--space-4);
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #ccc;
            transition: 0.4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: white;
            transition: 0.4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: var(--color-primary);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }
        
        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            display: flex;
            align-items: center;
            gap: var(--space-4);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }
        
        .stat-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--color-secondary);
            border-radius: var(--radius-lg);
        }
        
        .stat-content h3 {
            margin: 0 0 var(--space-2) 0;
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            font-weight: 500;
        }
        
        .stat-value {
            margin: 0;
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--color-text);
        }
        
        /* éšè—ç±» */
        .hidden {
            display: none !important;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <!-- ===== å®Œæ•´åŠŸèƒ½å®ç°è„šæœ¬ ===== -->
    <script type="text/babel">
        // ğŸ”§ Supabase é…ç½®
        const SUPABASE_URL = 'https://edfnhhthztskuuosuasw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkZm5oaHRoenRza3V1b3N1YXN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5OTYxMTYsImV4cCI6MjA2NTU3MjExNn0.O3g2gjvsWagmWgmzoeJA8mPampvLYJr-KgqVwXsKoAo';
        const ADMIN_PASSWORD = 'fengweipaiadmin';
        const WHATSAPP_NUMBER = '60162327792';
        const SELF_PICKUP_ADDRESS = '667, Jalan 24, Taman Perindustrian Ehsan Jaya, Kepong, 52100, Kuala Lumpur.';
        
        // åˆ›å»º Supabase å®¢æˆ·ç«¯
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // React Hooks
        const { useState, useEffect, useCallback, useRef, useMemo } = React;
        
        // ğŸ› ï¸ å·¥å…·å‡½æ•°
        const buildOrderMessage = (order) => {
            try {
                let msg = `ğŸ›ï¸ *é”‹å‘³æ´¾æ–°è®¢å• #${order.order_id}*\n\n`;
                msg += `ğŸ‘¤ *å®¢æˆ·ä¿¡æ¯*\nğŸ“› å§“å: ${order.name}\nğŸ“± ç”µè¯: ${order.phone}\nğŸšš å–è´§æ–¹å¼: ${order.delivery_method === 'self-pickup' ? 'è‡ªå–' : 'Lalamoveé€è´§'}\n`;
                if (order.delivery_method === 'self-pickup') {
                    msg += `ğŸ“ è‡ªå–åœ°å€: ${SELF_PICKUP_ADDRESS}\n`;
                }
                msg += `\nğŸ›’ *è®¢å•æ˜ç»†*\n`;
                (order.order_items || []).forEach(item => {
                    const emoji = item.emoji || 'ğŸ½ï¸';
                    const typeLabel = item.is_unlimited ? ' (é¢„è´­)' : ' (ç°è´§)';
                    msg += `${emoji} ${item.product}${typeLabel} Ã— ${item.quantity} = RM${(item.quantity * item.price).toFixed(2)}\n`;
                });
                msg += `\nğŸ’° *æ€»é‡‘é¢: RM${Number(order.total_amount).toFixed(2)}*\n`;
                msg += `ğŸ“ *å¤‡æ³¨*: ${order.remarks || 'æ— '}\n`;
                msg += `ğŸ“… *ä¸‹å•æ—¶é—´*: ${new Date(order.created_at).toLocaleString('zh-CN')}`;
                return msg;
            } catch (error) {
                console.error('æ„å»ºè®¢å•æ¶ˆæ¯å¤±è´¥:', error);
                return 'è®¢å•ä¿¡æ¯ç”Ÿæˆå¤±è´¥';
            }
        };
        
        const copyTextUniversal = async (text) => {
            try {
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    await navigator.clipboard.writeText(text);
                    return true;
                }
            } catch (e) {}
            try {
                const ta = document.createElement('textarea');
                ta.value = text;
                ta.style.position = 'fixed';
                ta.style.top = '-2000px';
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                return true;
            } catch (e) {
                return false;
            }
        };
        
        const generateOrderId = async () => {
            const today = new Date();
            const dateStr = today.getFullYear().toString() + 
                            (today.getMonth() + 1).toString().padStart(2, '0') + 
                            today.getDate().toString().padStart(2, '0');
            
            const { data: todayOrders } = await supabase
                .from('orders')
                .select('order_id')
                .ilike('order_id', `FW${dateStr}%`)
                .order('order_id', { ascending: false })
                .limit(1);
            
            let sequenceNumber = 1;
            if (todayOrders && todayOrders.length > 0) {
                const lastOrderId = todayOrders[0].order_id;
                const lastSequence = parseInt(lastOrderId.substring(10));
                sequenceNumber = lastSequence + 1;
            }
            
            return `FW${dateStr}${sequenceNumber.toString().padStart(3, '0')}`;
        };
        
        // ğŸ¨ UI ç»„ä»¶
        const LoadingSpinner = ({ text }) => (
            <div className="flex justify-center items-center p-6">
                <div className="loading"></div>
                {text && <span className="ml-3 text-gray-600">{text}</span>}
            </div>
        );
        
        const Toast = ({ message, type = 'success', onDismiss }) => {
            useEffect(() => {
                const timer = setTimeout(() => {
                    if (onDismiss) onDismiss();
                }, 3000);
                return () => clearTimeout(timer);
            }, [onDismiss]);
            
            return (
                <div className={`toast ${type}`}>
                    {message}
                </div>
            );
        };
        
        // ğŸ” ç™»å½•ç»„ä»¶ - å¢å¼ºå¯†ç å¯è§æ€§åˆ‡æ¢
        const LoginScreen = ({ onLogin }) => {
            const [password, setPassword] = useState('');
            const [showPassword, setShowPassword] = useState(false);
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!password.trim()) {
                    setError('è¯·è¾“å…¥å¯†ç ');
                    return;
                }
                
                setLoading(true);
                setError('');
                
                // æ¨¡æ‹ŸéªŒè¯å»¶è¿Ÿ
                setTimeout(() => {
                    if (password === ADMIN_PASSWORD) {
                        onLogin({ role: 'admin' });
                    } else {
                        setError('å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•');
                    }
                    setLoading(false);
                }, 500);
            };
            
            const togglePasswordVisibility = () => {
                setShowPassword(!showPassword);
            };
            
            return (
                <div className="login-screen">
                    <div className="login-container">
                        <div className="login-header">
                            <h1>ğŸ½ï¸ é”‹å‘³æ´¾ç®¡ç†åå°</h1>
                            <p>è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç è®¿é—®ç³»ç»Ÿ</p>
                        </div>
                        <form className="login-form" onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label className="form-label">ç®¡ç†å‘˜å¯†ç </label>
                                <div className="password-input-container">
                                    <input
                                        type={showPassword ? 'text' : 'password'}
                                        className="form-control"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        placeholder="è¾“å…¥ç®¡ç†å‘˜å¯†ç "
                                        required
                                        disabled={loading}
                                    />
                                    <button
                                        type="button"
                                        className="password-toggle"
                                        onClick={togglePasswordVisibility}
                                        title={showPassword ? 'éšè—å¯†ç ' : 'æ˜¾ç¤ºå¯†ç '}
                                    >
                                        <i className={`fas ${showPassword ? 'fa-eye-slash' : 'fa-eye'}`}></i>
                                    </button>
                                </div>
                            </div>
                            {error && (
                                <div className="error-message" style={{
                                    background: 'rgba(192, 21, 47, 0.1)',
                                    color: '#c0152f',
                                    border: '1px solid rgba(192, 21, 47, 0.2)',
                                    padding: '0.75rem',
                                    borderRadius: '0.5rem',
                                    marginBottom: '1rem',
                                    fontSize: '0.875rem'
                                }}>
                                    <i className="fas fa-exclamation-triangle mr-2"></i>
                                    {error}
                                </div>
                            )}
                            <button 
                                type="submit" 
                                className={`btn btn--primary btn--full-width ${loading ? 'loading' : ''}`}
                                disabled={loading}
                                style={{ width: '100%', padding: '0.75rem' }}
                            >
                                {loading ? (
                                    <>
                                        <span className="loading mr-2"></span>
                                        éªŒè¯ä¸­...
                                    </>
                                ) : (
                                    <>
                                        <i className="fas fa-sign-in-alt mr-2"></i>
                                        ç™»å½•
                                    </>
                                )}
                            </button>
                        </form>
                        <div style={{
                            marginTop: '1.5rem',
                            padding: '1rem',
                            background: 'rgba(33, 128, 141, 0.1)',
                            borderRadius: '0.5rem',
                            fontSize: '0.875rem',
                            color: '#626c71'
                        }}>
                            <p><strong>ğŸš€ ç³»ç»ŸåŠŸèƒ½ç‰¹è‰²ï¼š</strong></p>
                            <ul style={{ margin: '0.5rem 0', paddingLeft: '1.5rem' }}>
                                <li>ğŸ“Š å®Œæ•´ä»ªè¡¨ç›˜ & æ•°æ®åˆ†æ</li>
                                <li>ğŸ›’ æ™ºèƒ½è´­ç‰©è½¦ & åº“å­˜ç®¡ç†</li>
                                <li>ğŸ“± ä¼šå‘˜ç³»ç»Ÿ & è®¢å•è¿½è¸ª</li>
                                <li>ğŸ“¸ æ‰«ç æ‹ç…§ & æ”¯ä»˜å‡­è¯</li>
                            </ul>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ›’ å®¢æˆ·ç«¯è´­ç‰©è§†å›¾
        const CustomerView = ({ onAdminClick }) => {
            const [products, setProducts] = useState([]);
            const [cart, setCart] = useState([]);
            const [loading, setLoading] = useState(true);
            const [activeCategory, setActiveCategory] = useState('å…¨éƒ¨å•†å“');
            const [isCartOpen, setIsCartOpen] = useState(false);
            const [toast, setToast] = useState(null);
            const [lastOrder, setLastOrder] = useState(null);
            
            // åˆ†ç±»é…ç½® - åŸºäºäº§å“ç³»åˆ—çš„åˆ†ç±»å¯¼èˆª
            const categories = [
                { id: 'all', name: 'å…¨éƒ¨å•†å“', emoji: 'ğŸ½ï¸' },
                { id: 'hot-meals', name: 'çƒ­é”€å¥—é¤', emoji: 'ğŸ”¥' },
                { id: 'noodles', name: 'é¢æ¡ç±»', emoji: 'ğŸœ' },
                { id: 'rice', name: 'é¥­ç±»', emoji: 'ğŸš' },
                { id: 'soup', name: 'æ±¤å“', emoji: 'ğŸ²' },
                { id: 'snacks', name: 'å°é£Ÿ', emoji: 'ğŸ¥Ÿ' },
                { id: 'seasoning', name: 'è°ƒæ–™', emoji: 'ğŸ§‚' },
                { id: 'beverages', name: 'é¥®æ–™', emoji: 'ğŸ¥¤' }
            ];
            
            const showToast = (message, type = 'success') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };
            
            // è·å–äº§å“åˆ—è¡¨
            const fetchProducts = useCallback(async () => {
                setLoading(true);
                try {
                    const { data, error } = await supabase
                        .from('products')
                        .select('*')
                        .eq('is_published', true)
                        .order('id');
                    
                    if (error) {
                        throw error;
                    }
                    
                    const formattedProducts = (data || []).map(p => ({
                        ...p,
                        stock: p.stock_quantity ?? 0,
                        minStock: p.min_stock_threshold ?? 5,
                        image: p.image_url || p.image || null
                    }));
                    
                    setProducts(formattedProducts);
                } catch (error) {
                    console.error('åŠ è½½å•†å“å¤±è´¥:', error);
                    showToast('åŠ è½½å•†å“å¤±è´¥: ' + error.message, 'error');
                } finally {
                    setLoading(false);
                }
            }, []);
            
            useEffect(() => {
                fetchProducts();
            }, [fetchProducts]);
            
            // è¿‡æ»¤äº§å“ - åŸºäºäº§å“ç³»åˆ—åˆ†ç±»
            const filteredProducts = useMemo(() => {
                if (activeCategory === 'å…¨éƒ¨å•†å“') return products;
                
                // æ ¹æ®äº§å“åˆ†ç±»å­—æ®µè¿›è¡Œç­›é€‰
                return products.filter(product => {
                    if (!product.category) return activeCategory === 'å…¨éƒ¨å•†å“';
                    
                    // æ ¹æ®åˆ†ç±»åç§°åŒ¹é…
                    switch (activeCategory) {
                        case 'çƒ­é”€å¥—é¤':
                            return product.category.includes('å¥—é¤') || product.category.includes('çƒ­é”€');
                        case 'é¢æ¡ç±»':
                            return product.category.includes('é¢') || product.category.includes('ç²‰');
                        case 'é¥­ç±»':
                            return product.category.includes('é¥­') || product.category.includes('ç²¥');
                        case 'æ±¤å“':
                            return product.category.includes('æ±¤');
                        case 'å°é£Ÿ':
                            return product.category.includes('å°é£Ÿ') || product.category.includes('ç‚¹å¿ƒ') || product.category.includes('é›¶é£Ÿ');
                        case 'è°ƒæ–™':
                            return product.category.includes('è°ƒæ–™') || product.category.includes('é…±');
                        case 'é¥®æ–™':
                            return product.category.includes('é¥®') || product.category.includes('èŒ¶') || product.category.includes('å’–å•¡');
                        default:
                            return product.category === activeCategory;
                    }
                });
            }, [products, activeCategory]);
            
            // æ·»åŠ åˆ°è´­ç‰©è½¦
            const addToCart = (product) => {
                if (!product.is_unlimited && product.stock <= 0) {
                    showToast('å•†å“å·²å”®ç½„', 'error');
                    return;
                }
                
                const existingItem = cart.find(item => item.id === product.id);
                if (existingItem) {
                    if (!product.is_unlimited && existingItem.quantity >= product.stock) {
                        showToast(`åº“å­˜ä¸è¶³ï¼Œä»…å‰©${product.stock}ä»¶`, 'error');
                        return;
                    }
                    setCart(cart.map(item =>
                        item.id === product.id 
                            ? { ...item, quantity: item.quantity + 1 }
                            : item
                    ));
                } else {
                    setCart([...cart, { ...product, quantity: 1 }]);
                }
                showToast('å•†å“å·²æ·»åŠ åˆ°è´­ç‰©è½¦', 'success');
            };
            
            // æ›´æ–°è´­ç‰©è½¦æ•°é‡
            const updateCartQuantity = (productId, newQuantity) => {
                if (newQuantity <= 0) {
                    setCart(cart.filter(item => item.id !== productId));
                    return;
                }
                
                setCart(cart.map(item => {
                    if (item.id === productId) {
                        const maxQuantity = item.is_unlimited ? newQuantity : Math.min(newQuantity, item.stock);
                        if (newQuantity > maxQuantity) {
                            showToast(`æ•°é‡å·²è°ƒæ•´ä¸ºåº“å­˜ä¸Šé™ï¼š${maxQuantity}ä»¶`, 'warning');
                            return { ...item, quantity: maxQuantity };
                        }
                        return { ...item, quantity: newQuantity };
                    }
                    return item;
                }));
            };
            
            // ç§»é™¤è´­ç‰©è½¦å•†å“
            const removeFromCart = (productId) => {
                setCart(cart.filter(item => item.id !== productId));
                showToast('å•†å“å·²ç§»é™¤', 'success');
            };
            
            // è®¡ç®—è´­ç‰©è½¦æ€»è®¡
            const cartTotal = useMemo(() => {
                return cart.reduce((total, item) => total + item.price * item.quantity, 0);
            }, [cart]);
            
            const totalItems = useMemo(() => {
                return cart.reduce((sum, item) => sum + item.quantity, 0);
            }, [cart]);
            
            return (
                <div className="min-h-screen bg-background">
                    {/* å¯¼èˆªæ  */}
                    <header className="navbar">
                        <div className="container">
                            <div className="flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <span className="text-3xl">ğŸ½ï¸</span>
                                    <h1 className="text-2xl font-bold">é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­</h1>
                                </div>
                                <button 
                                    onClick={onAdminClick}
                                    className="text-white hover:text-gray-200 transition-colors"
                                >
                                    <div className="flex flex-col items-center">
                                        <i className="fas fa-user-shield text-2xl"></i>
                                        <span className="text-xs mt-1">ç®¡ç†</span>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </header>
                    
                    {/* åˆ†ç±»å¯¼èˆª */}
                    {window.SYSTEM_CONFIG.ENABLE_CATEGORY_NAVIGATION && (
                        <nav className="category-nav">
                            <div className="container">
                                <div className="category-buttons">
                                    {categories.map(category => (
                                        <button
                                            key={category.id}
                                            onClick={() => setActiveCategory(category.name)}
                                            className={`category-btn ${activeCategory === category.name ? 'active' : ''}`}
                                        >
                                            <span className="text-2xl">{category.emoji}</span>
                                            <span>{category.name}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </nav>
                    )}
                    
                    {/* ä¸»è¦å†…å®¹ */}
                    <main className="container" style={{ paddingTop: '2rem', paddingBottom: '6rem' }}>
                        {loading ? (
                            <LoadingSpinner text="åŠ è½½å•†å“ä¸­..." />
                        ) : (
                            <div className="products-grid">
                                {filteredProducts.length === 0 ? (
                                    <div className="empty-state">
                                        <div className="empty-state-icon">ğŸ“¦</div>
                                        <p>è¯¥åˆ†ç±»ä¸‹æš‚æ— å•†å“</p>
                                    </div>
                                ) : (
                                    filteredProducts.map(product => (
                                        <ProductCard 
                                            key={product.id} 
                                            product={product} 
                                            onAddToCart={addToCart} 
                                        />
                                    ))
                                )}
                            </div>
                        )}
                    </main>
                    
                    {/* æµ®åŠ¨è´­ç‰©è½¦æŒ‰é’® */}
                    {window.SYSTEM_CONFIG.ENABLE_SHOPPING_CART && cart.length > 0 && (
                        <div className="floating-cart">
                            <button 
                                className="floating-cart-btn"
                                onClick={() => setIsCartOpen(true)}
                            >
                                <div className="relative">
                                    <i className="fas fa-shopping-cart text-2xl"></i>
                                    <span className="cart-badge">{totalItems}</span>
                                </div>
                                <div className="flex flex-col">
                                    <span className="font-bold text-lg">RM{cartTotal.toFixed(2)}</span>
                                    <span className="text-xs opacity-90">{totalItems} ä»¶å•†å“</span>
                                </div>
                            </button>
                        </div>
                    )}
                    
                    {/* è´­ç‰©è½¦ä¾§è¾¹æ  */}
                    {window.SYSTEM_CONFIG.ENABLE_SHOPPING_CART && (
                        <>
                            <div 
                                className={`cart-overlay ${isCartOpen ? 'active' : ''}`}
                                onClick={() => setIsCartOpen(false)}
                            />
                            <CartSidebar
                                isOpen={isCartOpen}
                                cart={cart}
                                updateQuantity={updateCartQuantity}
                                removeFromCart={removeFromCart}
                                totalPrice={cartTotal}
                                totalItems={totalItems}
                                onClose={() => setIsCartOpen(false)}
                                showToast={showToast}
                                setLastOrder={setLastOrder}
                                setCart={setCart}
                                refreshProducts={fetchProducts}
                            />
                        </>
                    )}
                    
                    {/* è®¢å•æˆåŠŸæ¨¡æ€æ¡† */}
                    {lastOrder && (
                        <OrderSuccessModal
                            order={lastOrder}
                            onNewOrder={() => {
                                setLastOrder(null);
                                fetchProducts();
                            }}
                        />
                    )}
                    
                    {/* Toast é€šçŸ¥ */}
                    {toast && (
                        <Toast {...toast} onDismiss={() => setToast(null)} />
                    )}
                </div>
            );
        };
        
        // ğŸ“¦ äº§å“å¡ç‰‡ç»„ä»¶
        const ProductCard = ({ product, onAddToCart }) => {
            const isOutOfStock = !product.is_unlimited && product.stock === 0;
            const isLowStock = !product.is_unlimited && product.stock > 0 && product.stock <= product.minStock;
            
            return (
                <div className={`product-card ${isOutOfStock ? 'opacity-60' : ''}`}>
                    {/* äº§å“å¾½ç«  */}
                    {product.is_unlimited && (
                        <div className="product-badge product-badge--presale">
                            <i className="fas fa-infinity mr-1"></i>é¢„è´­
                        </div>
                    )}
                    {isLowStock && !isOutOfStock && (
                        <div className="product-badge product-badge--low-stock">
                            <i className="fas fa-exclamation-triangle mr-1"></i>ä½åº“å­˜
                        </div>
                    )}
                    
                    {/* äº§å“å›¾ç‰‡ */}
                    <div className="relative">
                        {product.image ? (
                            <img 
                                src={product.image} 
                                alt={product.name}
                                className="product-image"
                                onError={(e) => {
                                    e.target.style.display = 'none';
                                    e.target.nextSibling.style.display = 'flex';
                                }}
                            />
                        ) : null}
                        <div 
                            className="product-image flex items-center justify-center text-6xl"
                            style={{ display: product.image ? 'none' : 'flex' }}
                        >
                            {product.emoji || 'ğŸ½ï¸'}
                        </div>
                        
                        {/* ç¼ºè´§è¦†ç›–å±‚ */}
                        {isOutOfStock && (
                            <div 
                                className="absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center"
                                style={{ 
                                    position: 'absolute',
                                    top: 0,
                                    left: 0,
                                    right: 0,
                                    bottom: 0,
                                    background: 'rgba(0, 0, 0, 0.6)',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center'
                                }}
                            >
                                <div className="text-center text-white">
                                    <i className="fas fa-times-circle text-3xl mb-2"></i>
                                    <div className="font-bold">å·²å”®å®Œ</div>
                                </div>
                            </div>
                        )}
                    </div>
                    
                    {/* äº§å“ä¿¡æ¯ */}
                    <div className="product-info">
                        <h3 className="product-name">{product.name}</h3>
                        
                        <div className="flex items-center justify-between mb-3">
                            <span className="product-price">RM{Number(product.price).toFixed(2)}</span>
                            <span className={`stock-badge ${
                                product.is_unlimited ? 'stock-badge--in-stock' : 
                                isOutOfStock ? 'stock-badge--out-of-stock' :
                                isLowStock ? 'stock-badge--low-stock' : 'stock-badge--in-stock'
                            }`}>
                                {product.is_unlimited ? 'å……è¶³' : `åº“å­˜: ${product.stock}`}
                            </span>
                        </div>
                        
                        <div className="flex justify-between items-center">
                            <div className="text-sm text-gray-600">
                                {product.is_unlimited ? 'é¢„è´­å•†å“' : 'ç°è´§å•†å“'}
                                {product.category && (
                                    <span className="ml-2 px-2 py-1 bg-gray-100 rounded text-xs">
                                        {product.category}
                                    </span>
                                )}
                            </div>
                            <button
                                onClick={() => onAddToCart(product)}
                                disabled={isOutOfStock}
                                className={`btn ${isOutOfStock ? 'btn--secondary' : 'btn--primary'}`}
                                style={{ opacity: isOutOfStock ? 0.5 : 1 }}
                            >
                                <i className={`fas ${isOutOfStock ? 'fa-times' : 'fa-cart-plus'} mr-1`}></i>
                                {isOutOfStock ? 'å”®ç½„' : 'æ·»åŠ '}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ›’ è´­ç‰©è½¦ä¾§è¾¹æ 
        const CartSidebar = ({ 
            isOpen, cart, updateQuantity, removeFromCart, 
            totalPrice, totalItems, onClose, showToast,
            setLastOrder, setCart, refreshProducts 
        }) => {
            const [isCheckoutOpen, setIsCheckoutOpen] = useState(false);
            
            const handleCheckout = () => {
                if (cart.length === 0) {
                    showToast('è´­ç‰©è½¦ä¸ºç©º', 'error');
                    return;
                }
                onClose();
                setIsCheckoutOpen(true);
            };
            
            return (
                <>
                    <div className={`cart-sidebar ${isOpen ? 'open' : ''}`}>
                        {/* å¤´éƒ¨ */}
                        <header className="p-5 border-b border-border flex justify-between items-center">
                            <h2 className="text-xl font-bold">è´­ç‰©è½¦</h2>
                            <button 
                                onClick={onClose}
                                className="text-gray-500 hover:text-gray-800 p-2"
                            >
                                <i className="fas fa-times text-2xl"></i>
                            </button>
                        </header>
                        
                        {/* å†…å®¹ */}
                        <div className="flex-1 overflow-y-auto p-5">
                            {cart.length === 0 ? (
                                <div className="empty-state">
                                    <div className="empty-state-icon">ğŸ›’</div>
                                    <p>è´­ç‰©è½¦ä¸ºç©º</p>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    {cart.map(item => (
                                        <CartItem 
                                            key={item.id}
                                            item={item}
                                            updateQuantity={updateQuantity}
                                            removeFromCart={removeFromCart}
                                        />
                                    ))}
                                </div>
                            )}
                        </div>
                        
                        {/* åº•éƒ¨ */}
                        {cart.length > 0 && (
                            <footer className="border-t border-border p-5">
                                <div className="space-y-4">
                                    <div className="flex justify-between items-center">
                                        <span className="text-gray-600">å•†å“æ€»æ•°:</span>
                                        <span className="font-medium">{totalItems} ä»¶</span>
                                    </div>
                                    <div className="flex justify-between items-center text-lg">
                                        <span className="font-medium">æ€»è®¡:</span>
                                        <span className="text-2xl font-bold text-primary">
                                            RM{totalPrice.toFixed(2)}
                                        </span>
                                    </div>
                                    <button
                                        onClick={handleCheckout}
                                        className="btn btn--primary"
                                        style={{ width: '100%', padding: '1rem' }}
                                    >
                                        <i className="fas fa-credit-card mr-2"></i>
                                        ç«‹å³ç»“è´¦
                                    </button>
                                </div>
                            </footer>
                        )}
                    </div>
                    
                    {/* ç»“è´¦æ¨¡æ€æ¡† */}
                    {isCheckoutOpen && (
                        <CheckoutModal
                            cart={cart}
                            total={totalPrice}
                            onClose={() => setIsCheckoutOpen(false)}
                            showToast={showToast}
                            setLastOrder={setLastOrder}
                            setCart={setCart}
                            refreshProducts={refreshProducts}
                        />
                    )}
                </>
            );
        };
        
        // ğŸ›’ è´­ç‰©è½¦å•†å“é¡¹
        const CartItem = ({ item, updateQuantity, removeFromCart }) => {
            return (
                <div className="bg-white rounded-lg p-4 shadow-sm border border-border">
                    <div className="flex items-center gap-4">
                        <div className="text-3xl flex-shrink-0">
                            {item.emoji || 'ğŸ½ï¸'}
                        </div>
                        <div className="flex-1 min-w-0">
                            <h3 className="font-medium text-gray-800 truncate">{item.name}</h3>
                            <div className="flex items-center gap-2">
                                <span className="text-primary font-bold">
                                    RM{Number(item.price).toFixed(2)}
                                </span>
                                <span className="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">
                                    {item.is_unlimited ? 'é¢„è´­' : 'ç°è´§'}
                                </span>
                                {!item.is_unlimited && (
                                    <span className="text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded">
                                        åº“å­˜: {item.stock}
                                    </span>
                                )}
                            </div>
                        </div>
                        <div className="flex flex-col items-end gap-2">
                            <div className="flex items-center gap-2">
                                <button
                                    onClick={() => updateQuantity(item.id, item.quantity - 1)}
                                    className="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600"
                                >
                                    <i className="fas fa-minus text-xs"></i>
                                </button>
                                <span className="w-8 text-center font-medium">{item.quantity}</span>
                                <button
                                    onClick={() => updateQuantity(item.id, item.quantity + 1)}
                                    disabled={!item.is_unlimited && item.quantity >= item.stock}
                                    className={`w-8 h-8 rounded-full flex items-center justify-center text-xs ${
                                        !item.is_unlimited && item.quantity >= item.stock
                                            ? 'bg-gray-200 text-gray-400 cursor-not-allowed'
                                            : 'bg-gray-100 hover:bg-gray-200 text-gray-600'
                                    }`}
                                >
                                    <i className="fas fa-plus"></i>
                                </button>
                            </div>
                            <button
                                onClick={() => removeFromCart(item.id)}
                                className="text-xs text-gray-400 hover:text-red-500 transition-colors"
                            >
                                <i className="fas fa-trash mr-1"></i>åˆ é™¤
                            </button>
                        </div>
                    </div>
                    <div className="mt-2 pt-2 border-t border-gray-100">
                        <div className="flex justify-between items-center text-sm">
                            <span className="text-gray-500">å°è®¡</span>
                            <span className="font-bold text-gray-800">
                                RM{(item.quantity * item.price).toFixed(2)}
                            </span>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ’³ ç»“è´¦æ¨¡æ€æ¡† - åŒ…å«å–è´§åœ°å€å’Œé…é€è¡¨å•
        const CheckoutModal = ({ cart, total, onClose, showToast, setLastOrder, setCart, refreshProducts }) => {
            const [formData, setFormData] = useState({
                name: '',
                phone: '',
                delivery: '',
                address: '',
                remarks: '',
                paymentMethod: ''
            });
            const [loading, setLoading] = useState(false);
            
            // å–è´§åœ°å€é€‰é¡¹
            const pickupLocations = [
                { id: 'location1', name: ' æ€»åº— - å‰éš†å¡æ­¦å‰åŠ é‡Œå°”', address: '123 Jalan Bukit Jalil, 57000 Kuala Lumpur' },
                { id: 'location2', name: 'åˆ†åº— - è’²ç§', address: '456 Jalan Puchong, 47100 Puchong, Selangor' },
                { id: 'location3', name: 'åˆ†åº— - å…«æ‰“çµå†ä¹Ÿ', address: '789 Jalan PJ, 46200 Petaling Jaya, Selangor' }
            ];
            
            // æ”¯ä»˜äºŒç»´ç æ•°æ®
            const paymentQRCodes = {
                'Maybank QR': {
                    qrCode: 'https://edfnhhthztskuuosuasw.supabase.co/storage/v1/object/public/qr-codes/maybank-qr.jpg',
                    bankDetails: {
                        bank: 'Maybank',
                        accountName: 'é”‹å‘³æ´¾ç¾é£Ÿ',
                        accountNumber: '1234567890',
                        note: 'è½¬è´¦åè¯·æˆªå›¾ä½œä¸ºæ”¯ä»˜å‡­è¯'
                    }
                },
                'TNG eWallet': {
                    qrCode: 'https://edfnhhthztskuuosuasw.supabase.co/storage/v1/object/public/qr-codes/tng-qr.jpg'
                }
            };
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                
                try {
                    // ç”Ÿæˆè®¢å•
                    const orderId = await generateOrderId();
                    const orderData = {
                        order_id: orderId,
                        name: formData.name,
                        phone: formData.phone,
                        delivery_method: formData.delivery,
                        delivery_address: formData.address,
                        remarks: formData.remarks,
                        payment_method: formData.paymentMethod,
                        total_amount: total,
                        status: 'pending',
                        order_items: cart.map(item => ({
                            product: item.name,
                            quantity: item.quantity,
                            price: item.price,
                            emoji: item.emoji,
                            is_unlimited: item.is_unlimited
                        })),
                        created_at: new Date().toISOString()
                    };
                    
                    const { data: order, error } = await supabase
                        .from('orders')
                        .insert([orderData])
                        .select()
                        .single();
                    
                    if (error) throw error;
                    
                    // æ›´æ–°åº“å­˜
                    for (const item of cart) {
                        if (!item.is_unlimited) {
                            const newStock = Math.max(0, item.stock - item.quantity);
                            await supabase
                                .from('products')
                                .update({ stock_quantity: newStock })
                                .eq('id', item.id);
                        }
                    }
                    
                    showToast('è®¢å•æäº¤æˆåŠŸï¼', 'success');
                    setLastOrder(order);
                    setCart([]);
                    onClose();
                    refreshProducts();
                } catch (error) {
                    console.error('è®¢å•æäº¤å¤±è´¥:', error);
                    showToast('è®¢å•æäº¤å¤±è´¥: ' + error.message, 'error');
                } finally {
                    setLoading(false);
                }
            };
            
            return (
                <div className="modal active">
                    <div className="modal-content">
                        <div className="modal-header">
                            <h2 className="text-xl font-bold">ç»“è´¦</h2>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-800">
                                <i className="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        <div className="modal-body">
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div className="form-group">
                                    <label className="form-label">å§“å *</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.name}
                                        onChange={(e) => setFormData({...formData, name: e.target.value})}
                                        required
                                        placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">ç”µè¯å·ç  *</label>
                                    <input
                                        type="tel"
                                        className="form-control"
                                        value={formData.phone}
                                        onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                        required
                                        placeholder="ä¾‹å¦‚: 0123456789"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">å–è´§æ–¹å¼ *</label>
                                    <select
                                        className="form-control"
                                        value={formData.delivery}
                                        onChange={(e) => setFormData({...formData, delivery: e.target.value})}
                                        required
                                    >
                                        <option value="">è¯·é€‰æ‹©å–è´§æ–¹å¼</option>
                                        <option value="self-pickup">è‡ªå–</option>
                                        <option value="lalamove">Lalamoveé€è´§</option>
                                    </select>
                                </div>
                                
                                {/* æ˜¾ç¤ºå–è´§åœ°å€é€‰æ‹© */}
                                {formData.delivery === 'self-pickup' && (
                                    <div className="form-group">
                                        <label className="form-label">é€‰æ‹©å–è´§åœ°ç‚¹ *</label>
                                        <div className="space-y-2">
                                            {pickupLocations.map(location => (
                                                <div key={location.id} className="border border-gray-200 rounded-lg p-3 hover:bg-gray-50">
                                                    <label className="flex items-start gap-3 cursor-pointer">
                                                        <input
                                                            type="radio"
                                                            name="pickupLocation"
                                                            value={location.id}
                                                            onChange={(e) => setFormData({...formData, address: location.address})}
                                                            className="mt-1"
                                                            required
                                                        />
                                                        <div>
                                                            <div className="font-medium text-gray-900">{location.name}</div>
                                                            <div className="text-sm text-gray-600">{location.address}</div>
                                                        </div>
                                                    </label>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                
                                {/* æ˜¾ç¤ºé…é€åœ°å€è¾“å…¥ */}
                                {formData.delivery === 'lalamove' && (
                                    <div className="form-group">
                                        <label className="form-label">é…é€åœ°å€ *</label>
                                        <textarea
                                            className="form-control"
                                            value={formData.address}
                                            onChange={(e) => setFormData({...formData, address: e.target.value})}
                                            required
                                            rows="3"
                                            placeholder="è¯·è¾“å…¥å®Œæ•´çš„é…é€åœ°å€ï¼ˆåŒ…æ‹¬é—¨ç‰Œå·ã€è¡—é“ã€åŸå¸‚ã€é‚®æ”¿ç¼–ç ï¼‰"
                                        />
                                        <div className="text-sm text-gray-500 mt-1">
                                            ğŸ’¡ é…é€è´¹ç”¨å°†æ ¹æ®è·ç¦»è®¡ç®—ï¼Œæˆ‘ä»¬ä¼šåœ¨ç¡®è®¤è®¢å•åè”ç³»æ‚¨
                                        </div>
                                    </div>
                                )}
                                <div className="form-group">
                                    <label className="form-label">ä»˜æ¬¾æ–¹å¼ *</label>
                                    <div className="space-y-3">
                                        {Object.keys(paymentQRCodes).map(method => (
                                            <div key={method} className="border border-gray-200 rounded-lg p-3 hover:bg-gray-50">
                                                <label className="flex items-center gap-3 cursor-pointer">
                                                    <input
                                                        type="radio"
                                                        name="paymentMethod"
                                                        value={method}
                                                        onChange={(e) => setFormData({...formData, paymentMethod: e.target.value})}
                                                        required
                                                    />
                                                    <div className="flex-1">
                                                        <div className="font-medium">{method}</div>
                                                    </div>
                                                </label>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                
                                {/* æ˜¾ç¤ºæ”¯ä»˜äºŒç»´ç å’Œé“¶è¡Œèµ„æ–™ */}
                                {formData.paymentMethod && (
                                    <div className="form-group">
                                        <div className="border border-gray-200 rounded-lg p-4 bg-blue-50">
                                            <h3 className="font-medium mb-3 text-center">{formData.paymentMethod} æ”¯ä»˜ä¿¡æ¯</h3>
                                            
                                            {/* QRç  */}
                                            <div className="text-center mb-4">
                                                <img 
                                                    src={paymentQRCodes[formData.paymentMethod].qrCode}
                                                    alt={`${formData.paymentMethod} QR Code`}
                                                    className="mx-auto border border-gray-300 rounded-lg"
                                                    style={{ width: '200px', height: '200px', objectFit: 'contain' }}
                                                    onError={(e) => {
                                                        e.target.style.display = 'none';
                                                        e.target.nextSibling.style.display = 'block';
                                                    }}
                                                />
                                                <div className="hidden text-center text-gray-500 py-8">
                                                    äºŒç»´ç åŠ è½½ä¸­...
                                                </div>
                                            </div>
                                            
                                            {/* Maybank é“¶è¡Œè½¬è´¦èµ„æ–™ */}
                                            {formData.paymentMethod === 'Maybank QR' && paymentQRCodes[formData.paymentMethod].bankDetails && (
                                                <div className="bg-white rounded-lg p-3 space-y-2">
                                                    <h4 className="font-medium text-center text-gray-800 mb-2">ğŸ“± é“¶è¡Œè½¬è´¦èµ„æ–™</h4>
                                                    <div className="text-sm space-y-1">
                                                        <div><span className="font-medium">é“¶è¡Œ:</span> {paymentQRCodes[formData.paymentMethod].bankDetails.bank}</div>
                                                        <div><span className="font-medium">æˆ·å:</span> {paymentQRCodes[formData.paymentMethod].bankDetails.accountName}</div>
                                                        <div><span className="font-medium">è´¦å·:</span> {paymentQRCodes[formData.paymentMethod].bankDetails.accountNumber}</div>
                                                        <div className="text-orange-600 font-medium mt-2">
                                                            âš ï¸ {paymentQRCodes[formData.paymentMethod].bankDetails.note}
                                                        </div>
                                                    </div>
                                                </div>
                                            )}
                                            
                                            <div className="text-center text-sm text-gray-600 mt-3">
                                                æ‰«æäºŒç»´ç æˆ–ä½¿ç”¨é“¶è¡Œèµ„æ–™å®Œæˆä»˜æ¬¾
                                            </div>
                                        </div>
                                    </div>
                                )}
                                <div className="form-group">
                                    <label className="form-label">å¤‡æ³¨</label>
                                    <textarea
                                        className="form-control"
                                        value={formData.remarks}
                                        onChange={(e) => setFormData({...formData, remarks: e.target.value})}
                                        rows="3"
                                        placeholder="å¦‚æœ‰ç‰¹æ®Šè¦æ±‚ï¼Œè¯·åœ¨æ­¤è¯´æ˜"
                                    />
                                </div>
                            </form>
                        </div>
                        <div className="modal-footer">
                            <div className="w-full">
                                <div className="flex justify-between items-center mb-4">
                                    <span className="text-lg font-medium">è®¢å•æ€»è®¡:</span>
                                    <span className="text-2xl font-bold text-primary">
                                        RM{total.toFixed(2)}
                                    </span>
                                </div>
                                <button
                                    onClick={handleSubmit}
                                    disabled={loading}
                                    className="btn btn--primary"
                                    style={{ width: '100%', padding: '0.75rem' }}
                                >
                                    {loading ? (
                                        <>
                                            <span className="loading mr-2"></span>
                                            æäº¤ä¸­...
                                        </>
                                    ) : (
                                        <>
                                            <i className="fas fa-check mr-2"></i>
                                            ç¡®è®¤è®¢å•
                                        </>
                                    )}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ‰ è®¢å•æˆåŠŸæ¨¡æ€æ¡†
        const OrderSuccessModal = ({ order, onNewOrder }) => {
            const whatsappMsg = buildOrderMessage(order);
            const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(whatsappMsg)}`;
            
            const handleCopy = async () => {
                const success = await copyTextUniversal(whatsappMsg);
                alert(success ? 'è®¢å•ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿' : 'å¤åˆ¶å¤±è´¥ï¼Œè¯·é•¿æŒ‰é€‰æ‹©æ‰‹åŠ¨å¤åˆ¶');
            };
            
            const handleSendWhatsApp = () => {
                window.location.href = whatsappUrl;
                setTimeout(() => onNewOrder(), 1000);
            };
            
            return (
                <div className="modal active">
                    <div className="modal-content">
                        <div className="modal-body text-center">
                            <div className="text-6xl mb-4">ğŸ‰</div>
                            <h2 className="text-2xl font-bold mb-4 text-success">è®¢å•æäº¤æˆåŠŸ!</h2>
                            <div className="bg-gray-50 p-4 rounded-lg mb-4 text-left text-sm max-h-40 overflow-y-auto">
                                <pre className="whitespace-pre-wrap text-xs">{whatsappMsg}</pre>
                            </div>
                            <p className="text-gray-600 mb-4">
                                è¯·ç‚¹å‡»"å‘é€åˆ°WhatsApp"å°†è®¢å•ä¿¡æ¯å‘é€ç»™æˆ‘ä»¬ï¼Œæˆ–å…ˆ"å¤åˆ¶è®¢å•"æ‰‹åŠ¨å‘é€ã€‚
                            </p>
                            <div className="space-y-3">
                                <button 
                                    onClick={handleSendWhatsApp}
                                    className="btn btn--success"
                                    style={{ width: '100%', padding: '0.75rem' }}
                                >
                                    <i className="fab fa-whatsapp mr-2"></i>
                                    å‘é€åˆ°WhatsApp
                                </button>
                                <button 
                                    onClick={handleCopy}
                                    className="btn btn--secondary"
                                    style={{ width: '100%', padding: '0.75rem' }}
                                >
                                    <i className="fas fa-copy mr-2"></i>
                                    å¤åˆ¶è®¢å•ä¿¡æ¯
                                </button>
                                <button 
                                    onClick={onNewOrder}
                                    className="btn btn--primary"
                                    style={{ width: '100%', padding: '0.75rem' }}
                                >
                                    <i className="fas fa-shopping-cart mr-2"></i>
                                    ç»§ç»­è´­ç‰©
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ¯ ä¸»åº”ç”¨ç»„ä»¶
        const App = () => {
            const [currentView, setCurrentView] = useState('customer');
            const [user, setUser] = useState(null);
            
            const handleLogin = (userData) => {
                setUser(userData);
                setCurrentView('admin');
            };
            
            const handleLogout = () => {
                setUser(null);
                setCurrentView('customer');
            };
            
            const handleAdminClick = () => {
                setCurrentView('login');
            };
            
            // æ ¹æ®å½“å‰è§†å›¾æ¸²æŸ“å¯¹åº”ç»„ä»¶
            switch (currentView) {
                case 'login':
                    return <LoginScreen onLogin={handleLogin} />;
                case 'admin':
                    return <AdminLayout user={user} onLogout={handleLogout} />;
                case 'customer':
                default:
                    return <CustomerView onAdminClick={handleAdminClick} />;
            }
        };
        
        // ğŸ”§ å®Œæ•´ç®¡ç†åå°å¸ƒå±€
        const AdminLayout = ({ user, onLogout }) => {
            const [activeView, setActiveView] = useState('dashboard');
            const [sidebarOpen, setSidebarOpen] = useState(false);
            
            // ç®¡ç†åå°èœå•é¡¹
            const adminMenuItems = [
                { id: 'dashboard', icon: 'chart-line', title: 'ä»ªè¡¨ç›˜', component: Dashboard },
                { id: 'products', icon: 'pizza-slice', title: 'äº§å“ç®¡ç†', component: ProductsManager },
                { id: 'inventory', icon: 'boxes', title: 'åº“å­˜ç®¡ç†', component: InventoryManager },
                { id: 'orders', icon: 'list', title: 'è®¢å•ç®¡ç†', component: OrdersManager },
                { id: 'analytics', icon: 'chart-pie', title: 'æ•°æ®åˆ†æ', component: Analytics },
                { id: 'scanner', icon: 'qrcode', title: 'æ‰«ç åŠŸèƒ½', component: Scanner },
                { id: 'camera', icon: 'camera', title: 'æ‹ç…§åŠŸèƒ½', component: Camera }
            ];
            
            // å¦‚æœå¯ç”¨ä¼šå‘˜ç³»ç»Ÿï¼Œæ·»åŠ ä¼šå‘˜ç®¡ç†
            if (window.MEMBER_CONFIG.ENABLE_MEMBER_BACKEND) {
                adminMenuItems.splice(4, 0, {
                    id: 'members', icon: 'users', title: 'ä¼šå‘˜ç®¡ç†', component: MembersManager
                });
            }
            
            const currentComponent = adminMenuItems.find(item => item.id === activeView)?.component || Dashboard;
            
            return (
                <div className="admin-layout">
                    {/* ç§»åŠ¨ç«¯ä¾§è¾¹æ è¦†ç›–å±‚ */}
                    {sidebarOpen && (
                        <div
                            className="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden"
                            onClick={() => setSidebarOpen(false)}
                        />
                    )}
                    
                    {/* ä¾§è¾¹æ  */}
                    <aside className={`admin-sidebar fixed md:static top-0 left-0 h-full z-50 transform transition-transform duration-300 ease-in-out ${
                        sidebarOpen ? 'translate-x-0' : '-translate-x-full'
                    } md:translate-x-0`}>
                        {/* ç§»åŠ¨ç«¯ä¾§è¾¹æ å¤´éƒ¨ */}
                        <div className="flex justify-between items-center p-4 md:hidden border-b border-border">
                            <span className="font-bold text-gray-800">ç®¡ç†èœå•</span>
                            <button 
                                onClick={() => setSidebarOpen(false)}
                                className="p-2 rounded-lg text-gray-600 hover:bg-gray-100"
                            >
                                <i className="fas fa-times"></i>
                            </button>
                        </div>
                        
                        {/* å¯¼èˆªèœå• */}
                        <nav className="admin-nav">
                            {adminMenuItems.map(item => (
                                <div
                                    key={item.id}
                                    className={`admin-nav-item ${activeView === item.id ? 'active' : ''}`}
                                    onClick={() => {
                                        setActiveView(item.id);
                                        setSidebarOpen(false);
                                    }}
                                >
                                    <i className={`fas fa-${item.icon} admin-nav-icon`}></i>
                                    <span>{item.title}</span>
                                </div>
                            ))}
                        </nav>
                    </aside>
                    
                    {/* ä¸»è¦å†…å®¹åŒºåŸŸ */}
                    <div className="flex-1 flex flex-col">
                        {/* å¤´éƒ¨ */}
                        <header className="bg-surface border-b border-border px-6 py-4">
                            <div className="flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    {/* ç§»åŠ¨ç«¯èœå•æŒ‰é’® */}
                                    <button 
                                        onClick={() => setSidebarOpen(true)} 
                                        className="md:hidden p-2 rounded-lg text-gray-600 hover:bg-gray-100"
                                    >
                                        <i className="fas fa-bars text-xl"></i>
                                    </button>
                                    <span className="text-2xl">ğŸ½ï¸</span>
                                    <h1 className="text-xl font-bold">é”‹å‘³æ´¾ç®¡ç†åå°</h1>
                                </div>
                                <div className="flex items-center gap-4">
                                    <button 
                                        onClick={() => window.location.reload()} 
                                        className="btn btn--secondary btn-sm"
                                    >
                                        <i className="fas fa-store mr-2"></i>è¿”å›å®¢æˆ·ç«¯
                                    </button>
                                    <span className="text-sm text-gray-500 hidden sm:inline">
                                        ç®¡ç†å‘˜
                                    </span>
                                    <button 
                                        onClick={onLogout} 
                                        className="btn btn--secondary btn-sm"
                                    >
                                        <i className="fas fa-sign-out-alt mr-2"></i>é€€å‡º
                                    </button>
                                </div>
                            </div>
                        </header>
                        
                        {/* å†…å®¹åŒº */}
                        <main className="admin-content">
                            {React.createElement(currentComponent, { setActiveView })}
                        </main>
                    </div>
                </div>
            );
        };
        
        // ğŸ“Š ä»ªè¡¨ç›˜ç»„ä»¶
        const Dashboard = ({ setActiveView }) => {
            const [stats, setStats] = useState({
                todaySales: 0,
                monthSales: 0,
                todayOrders: 0,
                pendingOrders: 0,
                totalProducts: 0,
                lowStockProducts: 0,
                totalMembers: 0,
                outOfStockProducts: 0
            });
            const [presaleStats, setPresaleStats] = useState({
                totalBoxes: 0,
                completedGroups: 0,
                remainingBoxes: 0
            });
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                const fetchStats = async () => {
                    try {
                        // è·å–ä»Šæ—¥å’Œæœ¬æœˆæ•°æ®
                        const today = new Date().toISOString().slice(0, 10);
                        const monthStart = new Date();
                        monthStart.setDate(1);
                        
                        const [ordersResult, productsResult, membersResult] = await Promise.all([
                            supabase.from('orders').select('*').order('created_at', { ascending: false }),
                            supabase.from('products').select('*'),
                            window.MEMBER_CONFIG.ENABLE_MEMBER_SYSTEM ? 
                                supabase.from('members').select('*') : 
                                Promise.resolve({ data: [] })
                        ]);
                        
                        const orders = ordersResult.data || [];
                        const products = productsResult.data || [];
                        const members = membersResult.data || [];
                        
                        // è®¡ç®—ä»Šæ—¥è®¢å•
                        const todayOrders = orders.filter(o => 
                            o.created_at && o.created_at.startsWith(today)
                        );
                        
                        // è®¡ç®—æœ¬æœˆè®¢å•
                        const monthOrders = orders.filter(o => 
                            o.created_at && o.created_at >= monthStart.toISOString()
                        );
                        
                        // è®¡ç®—å¾…å¤„ç†è®¢å•
                        const pendingOrders = orders.filter(o => o.status === 'pending');
                        
                        // è®¡ç®—åº“å­˜ç»Ÿè®¡
                        const lowStockProducts = products.filter(p => 
                            !p.is_unlimited && (p.stock_quantity || 0) <= (p.min_stock_threshold || 5)
                        );
                        
                        const outOfStockProducts = products.filter(p => 
                            !p.is_unlimited && (p.stock_quantity || 0) === 0
                        );
                        
                        // è®¡ç®—é¢„å”®ç»Ÿè®¡
                        let totalPresaleBoxes = 0;
                        orders.forEach(order => {
                            (order.order_items || []).forEach(item => {
                                if (item.product && !item.product.includes('è¿è´¹')) {
                                    const product = products.find(p => p.name === item.product);
                                    if (product && product.is_unlimited) {
                                        totalPresaleBoxes += item.quantity || 0;
                                    }
                                }
                            });
                        });
                        
                        const completedGroups = Math.floor(totalPresaleBoxes / 200);
                        const remainingBoxes = 200 - (totalPresaleBoxes % 200);
                        
                        setStats({
                            todaySales: todayOrders.reduce((sum, o) => sum + Number(o.total_amount || 0), 0),
                            monthSales: monthOrders.reduce((sum, o) => sum + Number(o.total_amount || 0), 0),
                            todayOrders: todayOrders.length,
                            pendingOrders: pendingOrders.length,
                            totalProducts: products.filter(p => p.is_published).length,
                            lowStockProducts: lowStockProducts.length,
                            totalMembers: members.length,
                            outOfStockProducts: outOfStockProducts.length
                        });
                        
                        setPresaleStats({
                            totalBoxes: totalPresaleBoxes,
                            completedGroups,
                            remainingBoxes: remainingBoxes === 200 ? 0 : remainingBoxes
                        });
                    } catch (error) {
                        console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                    } finally {
                        setLoading(false);
                    }
                };
                
                fetchStats();
            }, []);
            
            if (loading) {
                return <LoadingSpinner text="åŠ è½½ä»ªè¡¨ç›˜æ•°æ®..." />;
            }
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <div>
                            <h2 className="page-title">ğŸ“Š ä»ªè¡¨ç›˜</h2>
                            <p className="page-subtitle">ç³»ç»Ÿæ¦‚è§ˆå’Œå…³é”®æŒ‡æ ‡</p>
                        </div>
                    </div>
                    
                    {/* é¢„å”®æˆå›¢ç»Ÿè®¡ */}
                    <div className="card" style={{
                        background: 'linear-gradient(135deg, #ec4899, #f43f5e)',
                        color: 'white'
                    }}>
                        <div className="card__body">
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex items-center gap-3">
                                    <span className="text-2xl">ğŸ‘¥</span>
                                    <h3 className="text-xl font-bold">é¢„å”®æˆå›¢ç»Ÿè®¡</h3>
                                </div>
                                <div className="text-sm bg-white bg-opacity-20 px-3 py-1 rounded-full">
                                    æ¯200ç›’æˆå›¢
                                </div>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div className="bg-white bg-opacity-10 rounded-lg p-4">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-sm font-medium opacity-90">å·²æˆå›¢æ•°</p>
                                            <p className="text-2xl font-bold">{presaleStats.completedGroups}å›¢</p>
                                        </div>
                                        <i className="fas fa-check-circle text-2xl opacity-80"></i>
                                    </div>
                                </div>
                                <div className="bg-white bg-opacity-10 rounded-lg p-4">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-sm font-medium opacity-90">æ€»å”®å‡ºæ•°é‡</p>
                                            <p className="text-2xl font-bold">{presaleStats.totalBoxes}ç›’</p>
                                        </div>
                                        <i className="fas fa-box text-2xl opacity-80"></i>
                                    </div>
                                </div>
                                <div className="bg-white bg-opacity-10 rounded-lg p-4">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="text-sm font-medium opacity-90">ä¸‹ä¸€å›¢è¿˜éœ€</p>
                                            <p className="text-2xl font-bold">{presaleStats.remainingBoxes}ç›’</p>
                                        </div>
                                        <i className="fas fa-hourglass-half text-2xl opacity-80"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* å…³é”®æŒ‡æ ‡ */}
                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#16a34a' }}>
                                <i className="fas fa-chart-line"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ä»Šæ—¥é”€å”®é¢</h3>
                                <p className="stat-value" style={{ color: '#16a34a' }}>
                                    RM{stats.todaySales.toFixed(2)}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#2563eb' }}>
                                <i className="fas fa-calendar-alt"></i>
                            </div>
                            <div className="stat-content">
                                <h3>æœ¬æœˆé”€å”®é¢</h3>
                                <p className="stat-value" style={{ color: '#2563eb' }}>
                                    RM{stats.monthSales.toFixed(2)}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#8b5cf6' }}>
                                <i className="fas fa-shopping-cart"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ä»Šæ—¥è®¢å•</h3>
                                <p className="stat-value" style={{ color: '#8b5cf6' }}>
                                    {stats.todayOrders}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card" style={{ cursor: 'pointer' }} 
                             onClick={() => setActiveView('orders')}>
                            <div className="stat-icon" style={{ color: '#f59e0b' }}>
                                <i className="fas fa-clock"></i>
                            </div>
                            <div className="stat-content">
                                <h3>å¾…å¤„ç†è®¢å•</h3>
                                <p className="stat-value" style={{ color: '#f59e0b' }}>
                                    {stats.pendingOrders}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card" style={{ cursor: 'pointer' }} 
                             onClick={() => setActiveView('products')}>
                            <div className="stat-icon" style={{ color: '#06b6d4' }}>
                                <i className="fas fa-store"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ä¸Šæ¶å•†å“</h3>
                                <p className="stat-value" style={{ color: '#06b6d4' }}>
                                    {stats.totalProducts}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card" style={{ cursor: 'pointer' }} 
                             onClick={() => setActiveView('inventory')}>
                            <div className="stat-icon" style={{ color: '#ef4444' }}>
                                <i className="fas fa-exclamation-triangle"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ç¼ºè´§å•†å“</h3>
                                <p className="stat-value" style={{ color: '#ef4444' }}>
                                    {stats.outOfStockProducts}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card" style={{ cursor: 'pointer' }} 
                             onClick={() => setActiveView('inventory')}>
                            <div className="stat-icon" style={{ color: '#f59e0b' }}>
                                <i className="fas fa-battery-quarter"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ä½åº“å­˜å•†å“</h3>
                                <p className="stat-value" style={{ color: '#f59e0b' }}>
                                    {stats.lowStockProducts}
                                </p>
                            </div>
                        </div>
                        
                        {window.MEMBER_CONFIG.ENABLE_MEMBER_SYSTEM && (
                            <div className="stat-card" style={{ cursor: 'pointer' }} 
                                 onClick={() => setActiveView('members')}>
                                <div className="stat-icon" style={{ color: '#8b5cf6' }}>
                                    <i className="fas fa-users"></i>
                                </div>
                                <div className="stat-content">
                                    <h3>æ³¨å†Œä¼šå‘˜</h3>
                                    <p className="stat-value" style={{ color: '#8b5cf6' }}>
                                        {stats.totalMembers}
                                    </p>
                                </div>
                            </div>
                        )}
                    </div>
                    
                    {/* å¿«æ·æ“ä½œ */}
                    <div className="card">
                        <div className="card__body">
                            <h3 className="text-lg font-semibold mb-4">å¿«æ·æ“ä½œ</h3>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <button 
                                    onClick={() => setActiveView('orders')} 
                                    className="flex flex-col items-center p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors"
                                >
                                    <i className="fas fa-list text-2xl text-blue-600 mb-2"></i>
                                    <span className="text-sm font-medium text-blue-700">æŸ¥çœ‹è®¢å•</span>
                                </button>
                                
                                <button 
                                    onClick={() => setActiveView('products')} 
                                    className="flex flex-col items-center p-4 bg-green-50 hover:bg-green-100 rounded-lg transition-colors"
                                >
                                    <i className="fas fa-pizza-slice text-2xl text-green-600 mb-2"></i>
                                    <span className="text-sm font-medium text-green-700">ç®¡ç†å•†å“</span>
                                </button>
                                
                                <button 
                                    onClick={() => setActiveView('inventory')} 
                                    className="flex flex-col items-center p-4 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"
                                >
                                    <i className="fas fa-boxes text-2xl text-purple-600 mb-2"></i>
                                    <span className="text-sm font-medium text-purple-700">åº“å­˜ç®¡ç†</span>
                                </button>
                                
                                <button 
                                    onClick={() => setActiveView('analytics')} 
                                    className="flex flex-col items-center p-4 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors"
                                >
                                    <i className="fas fa-chart-pie text-2xl text-orange-600 mb-2"></i>
                                    <span className="text-sm font-medium text-orange-700">æ•°æ®åˆ†æ</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ“¦ å®Œæ•´äº§å“ç®¡ç†ç»„ä»¶
        const ProductsManager = () => {
            const [products, setProducts] = useState([]);
            const [loading, setLoading] = useState(true);
            const [searchTerm, setSearchTerm] = useState('');
            const [categoryFilter, setCategoryFilter] = useState('');
            const [editingProduct, setEditingProduct] = useState(null);
            const [showAddForm, setShowAddForm] = useState(false);
            const [toast, setToast] = useState(null);
            
            const showToast = (message, type = 'success') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };
            
            const fetchProducts = useCallback(async () => {
                setLoading(true);
                try {
                    const { data, error } = await supabase
                        .from('products')
                        .select('*')
                        .order('id');
                    
                    if (error) throw error;
                    setProducts(data || []);
                } catch (error) {
                    console.error('åŠ è½½äº§å“å¤±è´¥:', error);
                    showToast('åŠ è½½äº§å“å¤±è´¥: ' + error.message, 'error');
                } finally {
                    setLoading(false);
                }
            }, []);
            
            useEffect(() => {
                fetchProducts();
            }, [fetchProducts]);
            
            // è¿‡æ»¤äº§å“
            const filteredProducts = useMemo(() => {
                return products.filter(product => {
                    const matchesSearch = !searchTerm || 
                        product.name.toLowerCase().includes(searchTerm.toLowerCase());
                    const matchesCategory = !categoryFilter || 
                        product.category === categoryFilter;
                    return matchesSearch && matchesCategory;
                });
            }, [products, searchTerm, categoryFilter]);
            
            // è·å–æ‰€æœ‰åˆ†ç±»
            const categories = useMemo(() => {
                return [...new Set(products.map(p => p.category).filter(Boolean))];
            }, [products]);
            
            // åˆ é™¤äº§å“
            const handleDelete = async (id) => {
                if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªäº§å“å—ï¼Ÿ')) return;
                
                try {
                    const { error } = await supabase
                        .from('products')
                        .delete()
                        .eq('id', id);
                    
                    if (error) throw error;
                    showToast('äº§å“åˆ é™¤æˆåŠŸ', 'success');
                    fetchProducts();
                } catch (error) {
                    console.error('åˆ é™¤äº§å“å¤±è´¥:', error);
                    showToast('åˆ é™¤äº§å“å¤±è´¥: ' + error.message, 'error');
                }
            };
            
            // åˆ‡æ¢äº§å“çŠ¶æ€
            const toggleProductStatus = async (product, field) => {
                try {
                    const { error } = await supabase
                        .from('products')
                        .update({ [field]: !product[field] })
                        .eq('id', product.id);
                    
                    if (error) throw error;
                    showToast(`äº§å“${field === 'is_published' ? 'å‘å¸ƒçŠ¶æ€' : 'çŠ¶æ€'}å·²æ›´æ–°`, 'success');
                    fetchProducts();
                } catch (error) {
                    console.error('æ›´æ–°äº§å“çŠ¶æ€å¤±è´¥:', error);
                    showToast('æ›´æ–°çŠ¶æ€å¤±è´¥: ' + error.message, 'error');
                }
            };
            
            if (loading) {
                return <LoadingSpinner text="åŠ è½½äº§å“æ•°æ®..." />;
            }
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <div>
                            <h2 className="page-title">ğŸ“¦ äº§å“ç®¡ç†</h2>
                            <p className="page-subtitle">ç®¡ç†å•†å“ä¿¡æ¯ã€åº“å­˜å’ŒçŠ¶æ€ ({products.length})</p>
                        </div>
                        <button
                            onClick={() => setShowAddForm(true)}
                            className="btn btn--primary"
                        >
                            <i className="fas fa-plus mr-2"></i>æ·»åŠ äº§å“
                        </button>
                    </div>
                    
                    {/* æœç´¢å’Œè¿‡æ»¤å·¥å…·æ  */}
                    <div className="toolbar">
                        <div className="toolbar-left">
                            <div className="flex items-center gap-3">
                                <input
                                    type="text"
                                    placeholder="æœç´¢äº§å“åç§°..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="form-control"
                                    style={{ minWidth: '200px' }}
                                />
                                <select
                                    value={categoryFilter}
                                    onChange={(e) => setCategoryFilter(e.target.value)}
                                    className="form-control"
                                >
                                    <option value="">å…¨éƒ¨åˆ†ç±»</option>
                                    {categories.map(category => (
                                        <option key={category} value={category}>{category}</option>
                                    ))}
                                </select>
                            </div>
                        </div>
                        <div className="toolbar-right">
                            <button
                                onClick={fetchProducts}
                                className="btn btn--secondary"
                            >
                                <i className="fas fa-sync-alt mr-2"></i>åˆ·æ–°
                            </button>
                        </div>
                    </div>
                    
                    {/* äº§å“è¡¨æ ¼ */}
                    <div className="card">
                        <div className="overflow-x-auto">
                            <table className="data-table">
                                <thead>
                                    <tr>
                                        <th>å•†å“</th>
                                        <th>ä»·æ ¼</th>
                                        <th>åº“å­˜</th>
                                        <th>åˆ†ç±»</th>
                                        <th>ç±»å‹</th>
                                        <th>çŠ¶æ€</th>
                                        <th>å‘å¸ƒ</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {filteredProducts.map(product => (
                                        <tr key={product.id}>
                                            <td>
                                                <div className="flex items-center gap-3">
                                                    <span className="text-2xl">
                                                        {product.emoji || 'ğŸ½ï¸'}
                                                    </span>
                                                    <div>
                                                        <div className="font-medium">{product.name}</div>
                                                        {product.image_url && (
                                                            <div className="text-xs text-gray-500">æœ‰å›¾ç‰‡</div>
                                                        )}
                                                    </div>
                                                </div>
                                            </td>
                                            <td className="font-medium text-primary">
                                                RM{Number(product.price || 0).toFixed(2)}
                                            </td>
                                            <td>
                                                {product.is_unlimited ? (
                                                    <span className="status status--success">
                                                        <i className="fas fa-infinity mr-1"></i>æ— é™åˆ¶
                                                    </span>
                                                ) : (
                                                    <span className={`font-medium ${
                                                        (product.stock_quantity ?? 0) === 0 ? 'text-red-600' :
                                                        (product.stock_quantity ?? 0) <= (product.min_stock_threshold ?? 5) ? 'text-orange-600' :
                                                        'text-green-600'
                                                    }`}>
                                                        {product.stock_quantity ?? 0}
                                                    </span>
                                                )}
                                            </td>
                                            <td>{product.category || '-'}</td>
                                            <td>
                                                <span className={`status ${
                                                    product.is_unlimited ? 'status--info' : 'status--success'
                                                }`}>
                                                    {product.is_unlimited ? 'é¢„è´­' : 'ç°è´§'}
                                                </span>
                                            </td>
                                            <td>
                                                <label className="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        checked={product.status === 'active'}
                                                        onChange={() => toggleProductStatus(product, 'status')}
                                                    />
                                                    <span className="toggle-slider"></span>
                                                </label>
                                            </td>
                                            <td>
                                                <label className="toggle-switch">
                                                    <input
                                                        type="checkbox"
                                                        checked={product.is_published || false}
                                                        onChange={() => toggleProductStatus(product, 'is_published')}
                                                    />
                                                    <span className="toggle-slider"></span>
                                                </label>
                                            </td>
                                            <td>
                                                <div className="flex gap-2">
                                                    <button
                                                        onClick={() => setEditingProduct(product)}
                                                        className="btn btn--secondary btn-sm"
                                                    >
                                                        <i className="fas fa-edit"></i>
                                                    </button>
                                                    <button
                                                        onClick={() => handleDelete(product.id)}
                                                        className="btn btn--danger btn-sm"
                                                    >
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                            
                            {filteredProducts.length === 0 && (
                                <div className="empty-state">
                                    <div className="empty-state-icon">ğŸ“¦</div>
                                    <p>æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„äº§å“</p>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {/* ç¼–è¾‘äº§å“æ¨¡æ€æ¡† */}
                    {editingProduct && (
                        <ProductEditModal
                            product={editingProduct}
                            onSave={async (updatedProduct) => {
                                try {
                                    const { error } = await supabase
                                        .from('products')
                                        .update({
                                            name: updatedProduct.name,
                                            price: Number(updatedProduct.price),
                                            category: updatedProduct.category,
                                            emoji: updatedProduct.emoji,
                                            stock_quantity: updatedProduct.is_unlimited ? null : Number(updatedProduct.stock_quantity || 0),
                                            min_stock_threshold: Number(updatedProduct.min_stock_threshold || 5),
                                            is_unlimited: updatedProduct.is_unlimited,
                                            is_published: updatedProduct.is_published,
                                            status: updatedProduct.status || 'active',
                                            image_url: updatedProduct.image_url || null
                                        })
                                        .eq('id', updatedProduct.id);
                                    
                                    if (error) throw error;
                                    showToast('äº§å“æ›´æ–°æˆåŠŸ', 'success');
                                    setEditingProduct(null);
                                    fetchProducts();
                                } catch (error) {
                                    console.error('æ›´æ–°äº§å“å¤±è´¥:', error);
                                    showToast('æ›´æ–°å¤±è´¥: ' + error.message, 'error');
                                }
                            }}
                            onCancel={() => setEditingProduct(null)}
                            showToast={showToast}
                        />
                    )}
                    
                    {/* æ·»åŠ äº§å“æ¨¡æ€æ¡† */}
                    {showAddForm && (
                        <ProductAddModal
                            onSave={async (newProduct) => {
                                try {
                                    const { error } = await supabase
                                        .from('products')
                                        .insert([{
                                            name: newProduct.name,
                                            price: Number(newProduct.price),
                                            category: newProduct.category || null,
                                            emoji: newProduct.emoji || 'ğŸ½ï¸',
                                            stock_quantity: newProduct.is_unlimited ? null : Number(newProduct.stock_quantity || 0),
                                            min_stock_threshold: Number(newProduct.min_stock_threshold || 5),
                                            is_unlimited: newProduct.is_unlimited || false,
                                            is_published: newProduct.is_published || false,
                                            status: newProduct.status || 'active',
                                            image_url: newProduct.image_url || null
                                        }]);
                                    
                                    if (error) throw error;
                                    showToast('äº§å“æ·»åŠ æˆåŠŸ', 'success');
                                    setShowAddForm(false);
                                    fetchProducts();
                                } catch (error) {
                                    console.error('æ·»åŠ äº§å“å¤±è´¥:', error);
                                    showToast('æ·»åŠ å¤±è´¥: ' + error.message, 'error');
                                }
                            }}
                            onCancel={() => setShowAddForm(false)}
                            showToast={showToast}
                        />
                    )}
                    
                    {/* Toast é€šçŸ¥ */}
                    {toast && <Toast {...toast} onDismiss={() => setToast(null)} />}
                </div>
            );
        };
        
        // äº§å“ç¼–è¾‘æ¨¡æ€æ¡†
        const ProductEditModal = ({ product, onSave, onCancel, showToast }) => {
            const [formData, setFormData] = useState({ ...product });
            const [uploading, setUploading] = useState(false);
            
            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };
            
            const handleImageUpload = async (file) => {
                if (!file) return;
                
                setUploading(true);
                try {
                    const ext = file.name.split('.').pop();
                    const filename = `products/${Date.now()}-${Math.random().toString(36).substring(7)}.${ext}`;
                    
                    const { error: uploadError } = await supabase.storage
                        .from('product-photos')
                        .upload(filename, file);
                    
                    if (uploadError) {
                        throw new Error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ' + uploadError.message);
                    }
                    
                    const { data: { publicUrl } } = supabase.storage
                        .from('product-photos')
                        .getPublicUrl(filename);
                    
                    handleChange('image_url', publicUrl);
                    showToast('å›¾ç‰‡ä¸Šä¼ æˆåŠŸ', 'success');
                } catch (error) {
                    showToast(error.message, 'error');
                } finally {
                    setUploading(false);
                }
            };
            
            const handleSubmit = () => {
                if (!formData.name || !formData.price) {
                    showToast('è¯·å¡«å†™å•†å“åç§°å’Œä»·æ ¼', 'error');
                    return;
                }
                onSave(formData);
            };
            
            return (
                <div className="modal active">
                    <div className="modal-content">
                        <div className="modal-header">
                            <h3 className="text-lg font-bold">ç¼–è¾‘äº§å“</h3>
                            <button onClick={onCancel} className="text-gray-500 hover:text-gray-700">
                                <i className="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div className="modal-body space-y-4">
                            <div className="grid md:grid-cols-2 gap-4">
                                <div className="form-group">
                                    <label className="form-label">å•†å“åç§° *</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.name || ''}
                                        onChange={(e) => handleChange('name', e.target.value)}
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">è¡¨æƒ…ç¬¦å·</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.emoji || ''}
                                        onChange={(e) => handleChange('emoji', e.target.value)}
                                        placeholder="ğŸ½ï¸"
                                    />
                                </div>
                            </div>
                            
                            <div className="grid md:grid-cols-2 gap-4">
                                <div className="form-group">
                                    <label className="form-label">ä»·æ ¼ (RM) *</label>
                                    <input
                                        type="number"
                                        step="0.01"
                                        className="form-control"
                                        value={formData.price || ''}
                                        onChange={(e) => handleChange('price', e.target.value)}
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">åˆ†ç±»</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.category || ''}
                                        onChange={(e) => handleChange('category', e.target.value)}
                                    />
                                </div>
                            </div>
                            
                            <div className="form-group">
                                <label className="form-label">å•†å“å›¾ç‰‡</label>
                                <div className="flex items-center gap-4">
                                    <input
                                        type="file"
                                        accept="image/*"
                                        onChange={(e) => e.target.files[0] && handleImageUpload(e.target.files[0])}
                                        className="hidden"
                                        id="image-upload-edit"
                                        disabled={uploading}
                                    />
                                    <label
                                        htmlFor="image-upload-edit"
                                        className={`btn btn--secondary ${uploading ? 'opacity-50' : ''}`}
                                    >
                                        {uploading ? 'ä¸Šä¼ ä¸­...' : 'æ›´æ¢å›¾ç‰‡'}
                                    </label>
                                    {formData.image_url && (
                                        <img
                                            src={formData.image_url}
                                            alt="å•†å“å›¾ç‰‡"
                                            className="w-16 h-16 object-cover rounded-lg"
                                        />
                                    )}
                                </div>
                                {formData.image_url && (
                                    <button
                                        onClick={() => handleChange('image_url', '')}
                                        className="text-red-600 text-xs mt-1 hover:underline"
                                    >
                                        åˆ é™¤å›¾ç‰‡
                                    </button>
                                )}
                            </div>
                            
                            <div className="flex items-center gap-6">
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.is_unlimited || false}
                                        onChange={(e) => handleChange('is_unlimited', e.target.checked)}
                                    />
                                    <span className="text-sm">é¢„è´­å•†å“ï¼ˆæ— é™åº“å­˜ï¼‰</span>
                                </label>
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.is_published || false}
                                        onChange={(e) => handleChange('is_published', e.target.checked)}
                                    />
                                    <span className="text-sm">å·²ä¸Šæ¶</span>
                                </label>
                            </div>
                            
                            {!formData.is_unlimited && (
                                <div className="grid md:grid-cols-2 gap-4">
                                    <div className="form-group">
                                        <label className="form-label">å½“å‰åº“å­˜</label>
                                        <input
                                            type="number"
                                            className="form-control"
                                            value={formData.stock_quantity || 0}
                                            onChange={(e) => handleChange('stock_quantity', e.target.value)}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">æœ€ä½åº“å­˜æé†’</label>
                                        <input
                                            type="number"
                                            className="form-control"
                                            value={formData.min_stock_threshold || 5}
                                            onChange={(e) => handleChange('min_stock_threshold', e.target.value)}
                                        />
                                    </div>
                                </div>
                            )}
                        </div>
                        
                        <div className="modal-footer">
                            <button onClick={onCancel} className="btn btn--secondary">
                                å–æ¶ˆ
                            </button>
                            <button onClick={handleSubmit} className="btn btn--primary">
                                ä¿å­˜
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // äº§å“æ·»åŠ æ¨¡æ€æ¡†
        const ProductAddModal = ({ onSave, onCancel, showToast }) => {
            const [formData, setFormData] = useState({
                name: '',
                emoji: 'ğŸ½ï¸',
                price: '',
                category: '',
                is_unlimited: false,
                is_published: false,
                stock_quantity: 0,
                min_stock_threshold: 5,
                status: 'active',
                image_url: ''
            });
            const [uploading, setUploading] = useState(false);
            
            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };
            
            const handleImageUpload = async (file) => {
                if (!file) return;
                
                setUploading(true);
                try {
                    const ext = file.name.split('.').pop();
                    const filename = `products/${Date.now()}-${Math.random().toString(36).substring(7)}.${ext}`;
                    
                    const { error: uploadError } = await supabase.storage
                        .from('product-photos')
                        .upload(filename, file);
                    
                    if (uploadError) {
                        throw new Error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ' + uploadError.message);
                    }
                    
                    const { data: { publicUrl } } = supabase.storage
                        .from('product-photos')
                        .getPublicUrl(filename);
                    
                    handleChange('image_url', publicUrl);
                    showToast('å›¾ç‰‡ä¸Šä¼ æˆåŠŸ', 'success');
                } catch (error) {
                    showToast(error.message, 'error');
                } finally {
                    setUploading(false);
                }
            };
            
            const handleSubmit = () => {
                if (!formData.name || !formData.price) {
                    showToast('è¯·å¡«å†™å•†å“åç§°å’Œä»·æ ¼', 'error');
                    return;
                }
                onSave(formData);
            };
            
            return (
                <div className="modal active">
                    <div className="modal-content">
                        <div className="modal-header">
                            <h3 className="text-lg font-bold">æ·»åŠ æ–°äº§å“</h3>
                            <button onClick={onCancel} className="text-gray-500 hover:text-gray-700">
                                <i className="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div className="modal-body space-y-4">
                            <div className="grid md:grid-cols-2 gap-4">
                                <div className="form-group">
                                    <label className="form-label">å•†å“åç§° *</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.name}
                                        onChange={(e) => handleChange('name', e.target.value)}
                                        placeholder="è¯·è¾“å…¥å•†å“åç§°"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">è¡¨æƒ…ç¬¦å·</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.emoji}
                                        onChange={(e) => handleChange('emoji', e.target.value)}
                                        placeholder="ğŸ½ï¸"
                                    />
                                </div>
                            </div>
                            
                            <div className="grid md:grid-cols-2 gap-4">
                                <div className="form-group">
                                    <label className="form-label">ä»·æ ¼ (RM) *</label>
                                    <input
                                        type="number"
                                        step="0.01"
                                        className="form-control"
                                        value={formData.price}
                                        onChange={(e) => handleChange('price', e.target.value)}
                                        placeholder="0.00"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">åˆ†ç±»</label>
                                    <input
                                        type="text"
                                        className="form-control"
                                        value={formData.category}
                                        onChange={(e) => handleChange('category', e.target.value)}
                                        placeholder="ä¾‹å¦‚ï¼šçƒ¤è‚ ç³»åˆ—"
                                    />
                                </div>
                            </div>
                            
                            <div className="form-group">
                                <label className="form-label">å•†å“å›¾ç‰‡</label>
                                <div className="flex items-center gap-4">
                                    <input
                                        type="file"
                                        accept="image/*"
                                        onChange={(e) => e.target.files[0] && handleImageUpload(e.target.files[0])}
                                        className="hidden"
                                        id="image-upload-add"
                                        disabled={uploading}
                                    />
                                    <label
                                        htmlFor="image-upload-add"
                                        className={`btn btn--success ${uploading ? 'opacity-50' : ''}`}
                                    >
                                        {uploading ? 'ä¸Šä¼ ä¸­...' : 'é€‰æ‹©å›¾ç‰‡'}
                                    </label>
                                    {formData.image_url && (
                                        <img
                                            src={formData.image_url}
                                            alt="é¢„è§ˆ"
                                            className="w-16 h-16 object-cover rounded-lg"
                                        />
                                    )}
                                </div>
                                {formData.image_url && (
                                    <button
                                        onClick={() => handleChange('image_url', '')}
                                        className="text-red-600 text-xs mt-1 hover:underline"
                                    >
                                        åˆ é™¤å›¾ç‰‡
                                    </button>
                                )}
                            </div>
                            
                            <div className="flex items-center gap-6">
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.is_unlimited}
                                        onChange={(e) => handleChange('is_unlimited', e.target.checked)}
                                    />
                                    <span className="text-sm">é¢„è´­å•†å“ï¼ˆæ— é™åº“å­˜ï¼‰</span>
                                </label>
                                <label className="flex items-center gap-2">
                                    <input
                                        type="checkbox"
                                        checked={formData.is_published}
                                        onChange={(e) => handleChange('is_published', e.target.checked)}
                                    />
                                    <span className="text-sm">ç«‹å³ä¸Šæ¶</span>
                                </label>
                            </div>
                            
                            {!formData.is_unlimited && (
                                <div className="grid md:grid-cols-2 gap-4">
                                    <div className="form-group">
                                        <label className="form-label">åˆå§‹åº“å­˜</label>
                                        <input
                                            type="number"
                                            className="form-control"
                                            value={formData.stock_quantity}
                                            onChange={(e) => handleChange('stock_quantity', e.target.value)}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">æœ€ä½åº“å­˜æé†’</label>
                                        <input
                                            type="number"
                                            className="form-control"
                                            value={formData.min_stock_threshold}
                                            onChange={(e) => handleChange('min_stock_threshold', e.target.value)}
                                        />
                                    </div>
                                </div>
                            )}
                        </div>
                        
                        <div className="modal-footer">
                            <button onClick={onCancel} className="btn btn--secondary">
                                å–æ¶ˆ
                            </button>
                            <button onClick={handleSubmit} className="btn btn--primary" disabled={uploading}>
                                æ·»åŠ äº§å“
                            </button>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ“Š å®Œæ•´åº“å­˜ç®¡ç†ç»„ä»¶
        const InventoryManager = () => {
            const [products, setProducts] = useState([]);
            const [loading, setLoading] = useState(true);
            const [stats, setStats] = useState({
                totalStock: 0,
                stockValue: 0,
                lowStockCount: 0,
                outOfStockCount: 0
            });
            
            const fetchInventoryData = useCallback(async () => {
                setLoading(true);
                try {
                    const { data, error } = await supabase
                        .from('products')
                        .select('*')
                        .order('name');
                    
                    if (error) throw error;
                    
                    const products = data || [];
                    
                    // è®¡ç®—åº“å­˜ç»Ÿè®¡ï¼ˆåªè®¡ç®—ç°è´§å•†å“ï¼‰
                    const physicalProducts = products.filter(p => !p.is_unlimited);
                    const totalStock = physicalProducts.reduce((sum, p) => sum + (p.stock_quantity || 0), 0);
                    const stockValue = physicalProducts.reduce((sum, p) => sum + ((p.stock_quantity || 0) * (p.price || 0)), 0);
                    const lowStockCount = physicalProducts.filter(p => (p.stock_quantity || 0) <= (p.min_stock_threshold || 5) && (p.stock_quantity || 0) > 0).length;
                    const outOfStockCount = physicalProducts.filter(p => (p.stock_quantity || 0) === 0).length;
                    
                    setProducts(products);
                    setStats({ totalStock, stockValue, lowStockCount, outOfStockCount });
                } catch (error) {
                    console.error('åŠ è½½åº“å­˜æ•°æ®å¤±è´¥:', error);
                } finally {
                    setLoading(false);
                }
            }, []);
            
            useEffect(() => {
                fetchInventoryData();
            }, [fetchInventoryData]);
            
            if (loading) {
                return <LoadingSpinner text="åŠ è½½åº“å­˜æ•°æ®..." />;
            }
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <h2 className="page-title">ğŸ“Š åº“å­˜ç®¡ç†</h2>
                        <p className="page-subtitle">ç›‘æ§åº“å­˜çŠ¶æ€å’Œè¡¥è´§æé†’</p>
                    </div>
                    
                    {/* åº“å­˜ç»Ÿè®¡å¡ç‰‡ */}
                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#2563eb' }}>
                                <i className="fas fa-boxes"></i>
                            </div>
                            <div className="stat-content">
                                <h3>æ€»åº“å­˜</h3>
                                <p className="stat-value" style={{ color: '#2563eb' }}>
                                    {stats.totalStock}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#16a34a' }}>
                                <i className="fas fa-dollar-sign"></i>
                            </div>
                            <div className="stat-content">
                                <h3>åº“å­˜ä»·å€¼</h3>
                                <p className="stat-value" style={{ color: '#16a34a' }}>
                                    RM{stats.stockValue.toFixed(2)}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#f59e0b' }}>
                                <i className="fas fa-exclamation-triangle"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ä½åº“å­˜å•†å“</h3>
                                <p className="stat-value" style={{ color: '#f59e0b' }}>
                                    {stats.lowStockCount}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#ef4444' }}>
                                <i className="fas fa-times-circle"></i>
                            </div>
                            <div className="stat-content">
                                <h3>ç¼ºè´§å•†å“</h3>
                                <p className="stat-value" style={{ color: '#ef4444' }}>
                                    {stats.outOfStockCount}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    {/* åº“å­˜è¯¦æƒ…è¡¨æ ¼ */}
                    <div className="card">
                        <div className="card__body">
                            <h3 className="text-lg font-semibold mb-4">äº§å“åº“å­˜è¯¦æƒ…</h3>
                            <div className="overflow-x-auto">
                                <table className="data-table">
                                    <thead>
                                        <tr>
                                            <th>å•†å“</th>
                                            <th>åˆ†ç±»</th>
                                            <th>ä»·æ ¼</th>
                                            <th>åº“å­˜çŠ¶æ€</th>
                                            <th>å½“å‰åº“å­˜</th>
                                            <th>æœ€ä½åº“å­˜</th>
                                            <th>çŠ¶æ€</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {products.map(product => {
                                            const stock = product.stock_quantity ?? 0;
                                            const threshold = product.min_stock_threshold ?? 5;
                                            const isLowStock = !product.is_unlimited && stock <= threshold && stock > 0;
                                            const isOutOfStock = !product.is_unlimited && stock === 0;
                                            
                                            return (
                                                <tr key={product.id}>
                                                    <td>
                                                        <div className="flex items-center gap-2">
                                                            <span className="text-lg">{product.emoji || 'ğŸ½ï¸'}</span>
                                                            <span className="font-medium">{product.name}</span>
                                                        </div>
                                                    </td>
                                                    <td>{product.category || '-'}</td>
                                                    <td className="font-medium text-primary">
                                                        RM{Number(product.price || 0).toFixed(2)}
                                                    </td>
                                                    <td>
                                                        {product.is_unlimited ? (
                                                            <span className="status status--success">
                                                                <i className="fas fa-infinity mr-1"></i>é¢„è´­
                                                            </span>
                                                        ) : isOutOfStock ? (
                                                            <span className="status status--error">
                                                                <i className="fas fa-times-circle mr-1"></i>ç¼ºè´§
                                                            </span>
                                                        ) : isLowStock ? (
                                                            <span className="status status--warning">
                                                                <i className="fas fa-exclamation-triangle mr-1"></i>ä½åº“å­˜
                                                            </span>
                                                        ) : (
                                                            <span className="status status--success">
                                                                <i className="fas fa-check-circle mr-1"></i>æ­£å¸¸
                                                            </span>
                                                        )}
                                                    </td>
                                                    <td>
                                                        {product.is_unlimited ? 'æ— é™åˆ¶' : stock}
                                                    </td>
                                                    <td>
                                                        {product.is_unlimited ? '-' : threshold}
                                                    </td>
                                                    <td>
                                                        <span className={`status ${
                                                            product.is_published ? 'status--success' : 'status--warning'
                                                        }`}>
                                                            {product.is_published ? 'å·²ä¸Šæ¶' : 'å·²ä¸‹æ¶'}
                                                        </span>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                                
                                {products.length === 0 && (
                                    <div className="empty-state">
                                        <div className="empty-state-icon">ğŸ“¦</div>
                                        <p>æš‚æ— äº§å“æ•°æ®</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ“‹ å®Œæ•´è®¢å•ç®¡ç†ç»„ä»¶
        const OrdersManager = () => {
            const [orders, setOrders] = useState([]);
            const [loading, setLoading] = useState(true);
            const [filterStatus, setFilterStatus] = useState('');
            const [filterDelivery, setFilterDelivery] = useState('');
            const [searchText, setSearchText] = useState('');
            const [updating, setUpdating] = useState(null);
            const [toast, setToast] = useState(null);
            const [modalOrder, setModalOrder] = useState(null);
            const [uploadFile, setUploadFile] = useState(null);
            
            const showToast = (message, type = 'success') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };
            
            const fetchOrders = useCallback(async () => {
                setLoading(true);
                try {
                    const { data, error } = await supabase
                        .from('orders')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) throw error;
                    setOrders(data || []);
                } catch (error) {
                    console.error('åŠ è½½è®¢å•å¤±è´¥:', error);
                    showToast('åŠ è½½è®¢å•å¤±è´¥: ' + error.message, 'error');
                } finally {
                    setLoading(false);
                }
            }, []);
            
            useEffect(() => {
                fetchOrders();
            }, [fetchOrders]);
            
            // è¿‡æ»¤è®¢å•
            const filteredOrders = useMemo(() => {
                return orders.filter(order => {
                    const matchesStatus = !filterStatus || order.status === filterStatus;
                    const matchesDelivery = !filterDelivery || order.delivery_method === filterDelivery;
                    const matchesSearch = !searchText || 
                        order.order_id.toLowerCase().includes(searchText.toLowerCase()) ||
                        order.name.toLowerCase().includes(searchText.toLowerCase()) ||
                        order.phone.toLowerCase().includes(searchText.toLowerCase());
                    return matchesStatus && matchesDelivery && matchesSearch;
                });
            }, [orders, filterStatus, filterDelivery, searchText]);
            
            // æ›´æ–°è®¢å•çŠ¶æ€
            const updateOrderStatus = async (orderId, newStatus) => {
                setUpdating(orderId);
                try {
                    const { error } = await supabase
                        .from('orders')
                        .update({ status: newStatus })
                        .eq('id', orderId);
                    
                    if (error) throw error;
                    showToast('è®¢å•çŠ¶æ€å·²æ›´æ–°', 'success');
                    fetchOrders();
                } catch (error) {
                    console.error('æ›´æ–°è®¢å•çŠ¶æ€å¤±è´¥:', error);
                    showToast('çŠ¶æ€æ›´æ–°å¤±è´¥: ' + error.message, 'error');
                } finally {
                    setUpdating(null);
                }
            };
            
            // å¤åˆ¶è®¢å•è¯¦æƒ…
            const copyOrderDetails = async (order) => {
                const orderMsg = buildOrderMessage(order).replace(/\*/g, '');
                const success = await copyTextUniversal(orderMsg);
                showToast(success ? 'è®¢å•è¯¦æƒ…å·²å¤åˆ¶' : 'å¤åˆ¶å¤±è´¥', success ? 'success' : 'error');
            };
            
            // æ‰“å°è®¢å•
            const printOrder = (order) => {
                const printWindow = window.open('', '_blank', 'width=820,height=900');
                if (!printWindow) {
                    showToast('è¯·å…è®¸å¼¹çª—', 'error');
                    return;
                }
                
                const doc = printWindow.document;
                doc.open();
                doc.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <meta charset="utf-8">
                        <title>è®¢å• ${order.order_id}</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 16px; font-size: 16px; font-weight: bold; }
                            h1 { font-size: 28px; margin: 0 0 12px; font-weight: bold; }
                            div { font-size: 16px; margin: 6px 0; font-weight: bold; }
                            table { width: 100%; border-collapse: collapse; margin-top: 12px; }
                            th, td { border: 2px solid #333; padding: 8px; font-size: 16px; font-weight: bold; }
                            th { background: #f5f5f5; font-size: 18px; }
                            .checkbox { width: 20px; height: 20px; border: 3px solid #333; display: inline-block; margin-left: 10px; }
                            @media print { @page { margin: 10mm; } button { display: none; } }
                        </style>
                    </head>
                    <body>
                        <h1>é”‹å‘³æ´¾è®¢å• #${order.order_id}</h1>
                        <div>å®¢æˆ·: ${order.name} (${order.phone})</div>
                        <div>æ–¹å¼: ${order.delivery_method === 'self-pickup' ? 'è‡ªå–' : 'Lalamoveé€è´§'}</div>
                        <div>å¤‡æ³¨: ${order.remarks || 'æ— '}</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>å•†å“</th>
                                    <th style="width:120px;">æ•°é‡ & å·²æ‰“åŒ…</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${(order.order_items || []).map(item => 
                                    `<tr>
                                        <td>${item.product}</td>
                                        <td style="text-align:center;">${item.quantity}<span class="checkbox"></span></td>
                                    </tr>`
                                ).join('')}
                            </tbody>
                        </table>
                        <div style="margin-top:16px; border-top:2px solid #333; padding-top:10px; font-size:14px; color:#666; font-weight:bold;">
                            æ‰“åŒ…å®Œæˆåè¯·åœ¨æ•°é‡æ—è¾¹çš„å‹¾é€‰æ¡†å†…æ‰“å‹¾ âœ“
                        </div>
                        <button onclick="window.print()" style="font-size:16px;font-weight:bold;padding:10px 20px;margin-top:16px;">æ‰“å°</button>
                    </body>
                    </html>
                `);
                doc.close();
            };
            
            // ä¸Šä¼ è¿è´¹å‡­è¯
            const uploadShippingProof = async () => {
                if (!uploadFile || !modalOrder) return;
                
                try {
                    const ext = uploadFile.name.split('.').pop();
                    const path = `proofs/${modalOrder.order_id}-shipping.${ext}`;
                    
                    const { error: uploadError } = await supabase.storage
                        .from('payment-proofs')
                        .upload(path, uploadFile, { upsert: true });
                    
                    if (uploadError) throw uploadError;
                    
                    const { data: { publicUrl } } = supabase.storage
                        .from('payment-proofs')
                        .getPublicUrl(path);
                    
                    const { error: updateError } = await supabase
                        .from('orders')
                        .update({ shipping_payment_proof_url: publicUrl })
                        .eq('order_id', modalOrder.order_id);
                    
                    if (updateError) throw updateError;
                    
                    showToast('è¿è´¹å‡­è¯ä¸Šä¼ æˆåŠŸ', 'success');
                    setUploadFile(null);
                    setModalOrder(null);
                    fetchOrders();
                } catch (error) {
                    console.error('ä¸Šä¼ å¤±è´¥:', error);
                    showToast('ä¸Šä¼ å¤±è´¥: ' + error.message, 'error');
                }
            };
            
            const getStatusDisplay = (status) => {
                const statusMap = {
                    'pending': 'å¾…å¤„ç†',
                    'ready for pick up': 'å¾…å–è´§',
                    'delivered': 'å·²å‘è´§',
                    'completed': 'å·²å®Œæˆ',
                    'cancelled': 'å·²å–æ¶ˆ'
                };
                return statusMap[status] || status;
            };
            
            const getStatusColor = (status) => {
                const colorMap = {
                    'pending': 'status--warning',
                    'ready for pick up': 'status--info',
                    'delivered': 'status--success',
                    'completed': 'status--success',
                    'cancelled': 'status--error'
                };
                return colorMap[status] || 'status--info';
            };
            
            if (loading) {
                return <LoadingSpinner text="åŠ è½½è®¢å•æ•°æ®..." />;
            }
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <div>
                            <h2 className="page-title">ğŸ“‹ è®¢å•ç®¡ç†</h2>
                            <p className="page-subtitle">
                                å¤„ç†å’Œè·Ÿè¸ªæ‰€æœ‰è®¢å• ({filteredOrders.length}/{orders.length})
                            </p>
                        </div>
                    </div>
                    
                    {/* æœç´¢å’Œè¿‡æ»¤å·¥å…·æ  */}
                    <div className="toolbar">
                        <div className="toolbar-left">
                            <div className="flex items-center gap-3 flex-wrap">
                                <input
                                    type="text"
                                    placeholder="æœç´¢è®¢å•å·ã€å®¢æˆ·å§“åæˆ–ç”µè¯"
                                    value={searchText}
                                    onChange={(e) => setSearchText(e.target.value)}
                                    className="form-control"
                                    style={{ minWidth: '250px' }}
                                />
                                <select
                                    value={filterStatus}
                                    onChange={(e) => setFilterStatus(e.target.value)}
                                    className="form-control"
                                >
                                    <option value="">å…¨éƒ¨çŠ¶æ€</option>
                                    <option value="pending">å¾…å¤„ç†</option>
                                    <option value="ready for pick up">å¾…å–è´§</option>
                                    <option value="delivered">å·²å‘è´§</option>
                                    <option value="completed">å·²å®Œæˆ</option>
                                    <option value="cancelled">å·²å–æ¶ˆ</option>
                                </select>
                                <select
                                    value={filterDelivery}
                                    onChange={(e) => setFilterDelivery(e.target.value)}
                                    className="form-control"
                                >
                                    <option value="">å…¨éƒ¨æ–¹å¼</option>
                                    <option value="self-pickup">è‡ªå–</option>
                                    <option value="lalamove">Lalamoveé€è´§</option>
                                </select>
                            </div>
                        </div>
                        <div className="toolbar-right">
                            <button onClick={fetchOrders} className="btn btn--secondary">
                                <i className="fas fa-sync-alt mr-2"></i>åˆ·æ–°
                            </button>
                        </div>
                    </div>
                    
                    {/* è®¢å•è¡¨æ ¼ */}
                    <div className="card">
                        <div className="overflow-x-auto">
                            <table className="data-table">
                                <thead>
                                    <tr>
                                        <th>è®¢å•å·</th>
                                        <th>å®¢æˆ·ä¿¡æ¯</th>
                                        <th>è®¢å•æ˜ç»†</th>
                                        <th>é‡‘é¢</th>
                                        <th>çŠ¶æ€</th>
                                        <th>ä¸‹å•æ—¶é—´</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {filteredOrders.map(order => (
                                        <tr key={order.id}>
                                            <td>
                                                <div>
                                                    <span className="font-bold text-primary">{order.order_id}</span>
                                                    <div className="text-xs text-gray-500 mt-1">
                                                        {order.delivery_method === 'self-pickup' ? 'è‡ªæ' : 'Lalamoveé…é€'}
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div>
                                                    <div className="font-medium">{order.name}</div>
                                                    <div className="text-xs text-gray-500">{order.phone}</div>
                                                    {order.remarks && (
                                                        <div className="text-xs text-gray-500 mt-1">
                                                            å¤‡æ³¨: {order.remarks}
                                                        </div>
                                                    )}
                                                </div>
                                            </td>
                                            <td className="text-xs">
                                                {(order.order_items || []).map((item, index) => (
                                                    <div key={index} className="mb-1">
                                                        <span className="mr-1">{item.emoji || 'â–«ï¸'}</span>
                                                        {item.product} Ã— {item.quantity}
                                                    </div>
                                                ))}
                                            </td>
                                            <td>
                                                <span className="font-bold text-primary">
                                                    RM{Number(order.total_amount || 0).toFixed(2)}
                                                </span>
                                            </td>
                                            <td>
                                                {updating === order.id ? (
                                                    <span className="text-xs">æ›´æ–°ä¸­...</span>
                                                ) : (
                                                    <div>
                                                        <select
                                                            className="text-xs border rounded px-2 py-1 bg-white mb-2"
                                                            value={order.status}
                                                            onChange={(e) => updateOrderStatus(order.id, e.target.value)}
                                                        >
                                                            <option value="pending">å¾…å¤„ç†</option>
                                                            <option value="ready for pick up">å¾…å–è´§</option>
                                                            <option value="delivered">å·²å‘è´§</option>
                                                            <option value="completed">å·²å®Œæˆ</option>
                                                            <option value="cancelled">å·²å–æ¶ˆ</option>
                                                        </select>
                                                        <div>
                                                            <span className={`status ${getStatusColor(order.status)}`}>
                                                                {getStatusDisplay(order.status)}
                                                            </span>
                                                        </div>
                                                    </div>
                                                )}
                                            </td>
                                            <td className="text-xs text-gray-500">
                                                {new Date(order.created_at).toLocaleString('zh-CN')}
                                            </td>
                                            <td>
                                                <div className="space-y-1 flex flex-col" style={{ minWidth: '120px' }}>
                                                    {order.payment_proof_url && (
                                                        <a
                                                            href={order.payment_proof_url}
                                                            target="_blank"
                                                            rel="noopener noreferrer"
                                                            className="text-blue-600 text-xs underline hover:text-blue-800"
                                                        >
                                                            æ”¯ä»˜å‡­è¯
                                                        </a>
                                                    )}
                                                    <button
                                                        onClick={() => copyOrderDetails(order)}
                                                        className="btn btn--secondary btn-sm text-xs"
                                                    >
                                                        å¤åˆ¶è¯¦æƒ…
                                                    </button>
                                                    <button
                                                        onClick={() => setModalOrder(order)}
                                                        className="btn btn--primary btn-sm text-xs"
                                                    >
                                                        ä¸Šä¼ è¿è´¹å‡­è¯
                                                    </button>
                                                    <button
                                                        onClick={() => printOrder(order)}
                                                        className="btn btn--success btn-sm text-xs"
                                                    >
                                                        æ‰“å°è®¢å•
                                                    </button>
                                                    {order.shipping_payment_proof_url && (
                                                        <a
                                                            href={order.shipping_payment_proof_url}
                                                            target="_blank"
                                                            rel="noopener noreferrer"
                                                            className="text-purple-600 text-xs underline hover:text-purple-800"
                                                        >
                                                            è¿è´¹å‡­è¯
                                                        </a>
                                                    )}
                                                </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                            
                            {filteredOrders.length === 0 && (
                                <div className="empty-state">
                                    <div className="empty-state-icon">ğŸ“‹</div>
                                    <p>æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è®¢å•</p>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {/* ä¸Šä¼ è¿è´¹å‡­è¯æ¨¡æ€æ¡† */}
                    {modalOrder && (
                        <div className="modal active">
                            <div className="modal-content">
                                <div className="modal-header">
                                    <h3 className="font-semibold">
                                        ä¸Šä¼ è¿è´¹å‡­è¯ - {modalOrder.order_id}
                                    </h3>
                                    <button
                                        onClick={() => {
                                            setModalOrder(null);
                                            setUploadFile(null);
                                        }}
                                        className="text-gray-500 hover:text-gray-700"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                <div className="modal-body space-y-3">
                                    <input
                                        type="file"
                                        accept="image/*,.pdf"
                                        onChange={(e) => setUploadFile(e.target.files[0])}
                                        className="form-control"
                                    />
                                    <button
                                        disabled={!uploadFile}
                                        onClick={uploadShippingProof}
                                        className="btn btn--primary w-full"
                                    >
                                        {uploadFile ? 'ä¸Šä¼ å‡­è¯' : 'è¯·é€‰æ‹©æ–‡ä»¶'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* Toast é€šçŸ¥ */}
                    {toast && <Toast {...toast} onDismiss={() => setToast(null)} />}
                </div>
            );
        };
        
        // ğŸ‘¥ å®Œæ•´ä¼šå‘˜ç®¡ç†ç»„ä»¶
        const MembersManager = () => {
            const [members, setMembers] = useState([]);
            const [loading, setLoading] = useState(true);
            const [stats, setStats] = useState({
                totalMembers: 0,
                activeMembers: 0,
                totalPoints: 0,
                avgOrderValue: 0
            });
            
            const fetchMembersData = useCallback(async () => {
                setLoading(true);
                try {
                    const [membersResult, ordersResult] = await Promise.all([
                        supabase.from('members').select('*').order('created_at', { ascending: false }),
                        supabase.from('orders').select('*')
                    ]);
                    
                    const members = membersResult.data || [];
                    const orders = ordersResult.data || [];
                    
                    // è®¡ç®—ä¼šå‘˜ç»Ÿè®¡
                    const totalMembers = members.length;
                    const activeMembers = members.filter(m => 
                        orders.some(o => o.phone === m.phone)
                    ).length;
                    const totalPoints = members.reduce((sum, m) => sum + (m.points || 0), 0);
                    const totalOrderValue = orders.reduce((sum, o) => sum + Number(o.total_amount || 0), 0);
                    const avgOrderValue = orders.length > 0 ? totalOrderValue / orders.length : 0;
                    
                    // ä¸ºæ¯ä¸ªä¼šå‘˜è®¡ç®—è®¢å•ç»Ÿè®¡
                    const membersWithStats = members.map(member => {
                        const memberOrders = orders.filter(o => o.phone === member.phone);
                        const totalSpent = memberOrders.reduce((sum, o) => sum + Number(o.total_amount || 0), 0);
                        const orderCount = memberOrders.length;
                        
                        return {
                            ...member,
                            orderCount,
                            totalSpent,
                            lastOrderDate: memberOrders.length > 0 ? 
                                new Date(Math.max(...memberOrders.map(o => new Date(o.created_at)))).toISOString() : 
                                null
                        };
                    });
                    
                    setMembers(membersWithStats);
                    setStats({ totalMembers, activeMembers, totalPoints, avgOrderValue });
                } catch (error) {
                    console.error('åŠ è½½ä¼šå‘˜æ•°æ®å¤±è´¥:', error);
                } finally {
                    setLoading(false);
                }
            }, []);
            
            useEffect(() => {
                if (window.MEMBER_CONFIG.ENABLE_MEMBER_SYSTEM) {
                    fetchMembersData();
                } else {
                    setLoading(false);
                }
            }, [fetchMembersData]);
            
            if (!window.MEMBER_CONFIG.ENABLE_MEMBER_SYSTEM) {
                return (
                    <div className="space-y-6">
                        <div className="page-header">
                            <h2 className="page-title">ğŸ‘¥ ä¼šå‘˜ç®¡ç†</h2>
                            <p className="page-subtitle">ä¼šå‘˜ç³»ç»Ÿæœªå¯ç”¨</p>
                        </div>
                        <div className="card">
                            <div className="card__body text-center py-8">
                                <i className="fas fa-toggle-off text-4xl text-gray-400 mb-4"></i>
                                <p className="text-gray-600">ä¼šå‘˜ç³»ç»ŸåŠŸèƒ½å·²å…³é—­</p>
                                <p className="text-sm text-gray-500 mt-2">
                                    è¯·åœ¨é…ç½®ä¸­å¯ç”¨ MEMBER_CONFIG.ENABLE_MEMBER_SYSTEM
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }
            
            if (loading) {
                return <LoadingSpinner text="åŠ è½½ä¼šå‘˜æ•°æ®..." />;
            }
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <h2 className="page-title">ğŸ‘¥ ä¼šå‘˜ç®¡ç†</h2>
                        <p className="page-subtitle">ç®¡ç†ä¼šå‘˜ä¿¡æ¯å’Œç§¯åˆ†ç³»ç»Ÿ</p>
                    </div>
                    
                    {/* ä¼šå‘˜ç»Ÿè®¡å¡ç‰‡ */}
                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#8b5cf6' }}>
                                <i className="fas fa-users"></i>
                            </div>
                            <div className="stat-content">
                                <h3>æ³¨å†Œä¼šå‘˜</h3>
                                <p className="stat-value" style={{ color: '#8b5cf6' }}>
                                    {stats.totalMembers}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#16a34a' }}>
                                <i className="fas fa-user-check"></i>
                            </div>
                            <div className="stat-content">
                                <h3>æ´»è·ƒä¼šå‘˜</h3>
                                <p className="stat-value" style={{ color: '#16a34a' }}>
                                    {stats.activeMembers}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#f59e0b' }}>
                                <i className="fas fa-star"></i>
                            </div>
                            <div className="stat-content">
                                <h3>æ€»ç§¯åˆ†</h3>
                                <p className="stat-value" style={{ color: '#f59e0b' }}>
                                    {stats.totalPoints}
                                </p>
                            </div>
                        </div>
                        
                        <div className="stat-card">
                            <div className="stat-icon" style={{ color: '#2563eb' }}>
                                <i className="fas fa-chart-line"></i>
                            </div>
                            <div className="stat-content">
                                <h3>å¹³å‡è®¢å•ä»·å€¼</h3>
                                <p className="stat-value" style={{ color: '#2563eb' }}>
                                    RM{stats.avgOrderValue.toFixed(2)}
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    {/* ä¼šå‘˜åˆ—è¡¨ */}
                    <div className="card">
                        <div className="card__body">
                            <h3 className="text-lg font-semibold mb-4">ä¼šå‘˜åˆ—è¡¨</h3>
                            <div className="overflow-x-auto">
                                <table className="data-table">
                                    <thead>
                                        <tr>
                                            <th>å§“å</th>
                                            <th>ç”µè¯</th>
                                            <th>ç§¯åˆ†</th>
                                            <th>è®¢å•æ•°</th>
                                            <th>æ¶ˆè´¹æ€»é¢</th>
                                            <th>æœ€åè®¢å•</th>
                                            <th>æ³¨å†Œæ—¶é—´</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {members.map(member => (
                                            <tr key={member.id}>
                                                <td className="font-medium">{member.name}</td>
                                                <td>{member.phone}</td>
                                                <td>
                                                    <span className="status status--warning">
                                                        <i className="fas fa-star mr-1"></i>
                                                        {member.points || 0}
                                                    </span>
                                                </td>
                                                <td>{member.orderCount}</td>
                                                <td className="font-medium text-primary">
                                                    RM{member.totalSpent.toFixed(2)}
                                                </td>
                                                <td className="text-sm text-gray-500">
                                                    {member.lastOrderDate ? 
                                                        new Date(member.lastOrderDate).toLocaleDateString('zh-CN') : 
                                                        'æ— è®¢å•'
                                                    }
                                                </td>
                                                <td className="text-sm text-gray-500">
                                                    {new Date(member.created_at).toLocaleDateString('zh-CN')}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                                
                                {members.length === 0 && (
                                    <div className="empty-state">
                                        <div className="empty-state-icon">ğŸ‘¥</div>
                                        <p>æš‚æ— ä¼šå‘˜æ•°æ®</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ“ˆ æ•°æ®åˆ†æç»„ä»¶
        const Analytics = () => {
            const [analyticsData, setAnalyticsData] = useState({
                salesByMonth: [],
                topProducts: [],
                ordersByStatus: [],
                revenueByCategory: []
            });
            const [loading, setLoading] = useState(true);
            const [chartType, setChartType] = useState('sales');
            
            useEffect(() => {
                const fetchAnalyticsData = async () => {
                    try {
                        const [ordersResult, productsResult] = await Promise.all([
                            supabase.from('orders').select('*').order('created_at', { ascending: false }),
                            supabase.from('products').select('*')
                        ]);
                        
                        const orders = ordersResult.data || [];
                        const products = productsResult.data || [];
                        
                        // è®¡ç®—æ¯æœˆé”€å”®é¢
                        const salesByMonth = {};
                        orders.forEach(order => {
                            if (order.created_at) {
                                const month = order.created_at.substring(0, 7); // YYYY-MM
                                salesByMonth[month] = (salesByMonth[month] || 0) + Number(order.total_amount || 0);
                            }
                        });
                        
                        // è®¡ç®—çƒ­é”€äº§å“
                        const productSales = {};
                        orders.forEach(order => {
                            (order.order_items || []).forEach(item => {
                                if (item.product) {
                                    productSales[item.product] = (productSales[item.product] || 0) + (item.quantity || 0);
                                }
                            });
                        });
                        
                        // è®¢å•çŠ¶æ€åˆ†å¸ƒ
                        const statusCounts = {};
                        orders.forEach(order => {
                            const status = order.status || 'unknown';
                            statusCounts[status] = (statusCounts[status] || 0) + 1;
                        });
                        
                        // åˆ†ç±»æ”¶å…¥åˆ†æ
                        const categoryRevenue = {};
                        orders.forEach(order => {
                            (order.order_items || []).forEach(item => {
                                const product = products.find(p => p.name === item.product);
                                const category = product ? (product.category || 'å…¶ä»–') : 'å…¶ä»–';
                                const revenue = (item.quantity || 0) * Number(item.price || 0);
                                categoryRevenue[category] = (categoryRevenue[category] || 0) + revenue;
                            });
                        });
                        
                        setAnalyticsData({
                            salesByMonth: Object.entries(salesByMonth).map(([month, sales]) => ({ month, sales })),
                            topProducts: Object.entries(productSales).sort((a, b) => b[1] - a[1]).slice(0, 10),
                            ordersByStatus: Object.entries(statusCounts).map(([status, count]) => ({ status, count })),
                            revenueByCategory: Object.entries(categoryRevenue).map(([category, revenue]) => ({ category, revenue }))
                        });
                    } catch (error) {
                        console.error('è·å–åˆ†ææ•°æ®å¤±è´¥:', error);
                    } finally {
                        setLoading(false);
                    }
                };
                
                fetchAnalyticsData();
            }, []);
            
            if (loading) {
                return <LoadingSpinner text="åŠ è½½åˆ†ææ•°æ®..." />;
            }
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <div>
                            <h2 className="page-title">ğŸ“ˆ æ•°æ®åˆ†æ</h2>
                            <p className="page-subtitle">é”€å”®æŠ¥è¡¨å’Œä¸šåŠ¡æ´å¯Ÿ</p>
                        </div>
                        <div className="flex gap-2">
                            <select
                                value={chartType}
                                onChange={(e) => setChartType(e.target.value)}
                                className="form-control"
                            >
                                <option value="sales">æœˆåº¦é”€å”®</option>
                                <option value="products">çƒ­é”€äº§å“</option>
                                <option value="status">è®¢å•çŠ¶æ€</option>
                                <option value="category">åˆ†ç±»æ”¶å…¥</option>
                            </select>
                        </div>
                    </div>
                    
                    {/* é”€å”®è¶‹åŠ¿å›¾ */}
                    {chartType === 'sales' && (
                        <div className="card">
                            <div className="card__body">
                                <h3 className="text-lg font-semibold mb-4">ğŸ“Š æœˆåº¦é”€å”®è¶‹åŠ¿</h3>
                                <div className="space-y-3">
                                    {analyticsData.salesByMonth.map((item, index) => (
                                        <div key={index} className="flex items-center gap-4">
                                            <div className="w-20 text-sm font-medium">{item.month}</div>
                                            <div className="flex-1 bg-gray-200 rounded-full h-6 relative">
                                                <div
                                                    className="bg-primary h-full rounded-full flex items-center justify-end pr-2"
                                                    style={{
                                                        width: `${Math.max(10, (item.sales / Math.max(...analyticsData.salesByMonth.map(s => s.sales))) * 100)}%`
                                                    }}
                                                >
                                                    <span className="text-xs text-white font-medium">
                                                        RM{item.sales.toFixed(0)}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* çƒ­é”€äº§å“ */}
                    {chartType === 'products' && (
                        <div className="card">
                            <div className="card__body">
                                <h3 className="text-lg font-semibold mb-4">ğŸ† çƒ­é”€äº§å“æ’è¡Œ</h3>
                                <div className="space-y-3">
                                    {analyticsData.topProducts.map(([product, quantity], index) => (
                                        <div key={index} className="flex items-center gap-4">
                                            <div className="w-8 h-8 bg-primary text-white rounded-full flex items-center justify-center text-sm font-bold">
                                                {index + 1}
                                            </div>
                                            <div className="flex-1">
                                                <div className="font-medium">{product}</div>
                                                <div className="text-sm text-gray-600">é”€é‡: {quantity} ä»¶</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* è®¢å•çŠ¶æ€åˆ†å¸ƒ */}
                    {chartType === 'status' && (
                        <div className="card">
                            <div className="card__body">
                                <h3 className="text-lg font-semibold mb-4">ğŸ“‹ è®¢å•çŠ¶æ€åˆ†å¸ƒ</h3>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    {analyticsData.ordersByStatus.map((item, index) => (
                                        <div key={index} className="text-center">
                                            <div className="text-2xl font-bold text-primary">{item.count}</div>
                                            <div className="text-sm text-gray-600 capitalize">{item.status}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* åˆ†ç±»æ”¶å…¥åˆ†æ */}
                    {chartType === 'category' && (
                        <div className="card">
                            <div className="card__body">
                                <h3 className="text-lg font-semibold mb-4">ğŸ’° åˆ†ç±»æ”¶å…¥åˆ†æ</h3>
                                <div className="space-y-3">
                                    {analyticsData.revenueByCategory.map((item, index) => (
                                        <div key={index} className="flex items-center gap-4">
                                            <div className="w-16 text-sm font-medium">{item.category}</div>
                                            <div className="flex-1 bg-gray-200 rounded-full h-6 relative">
                                                <div
                                                    className="bg-success h-full rounded-full flex items-center justify-end pr-2"
                                                    style={{
                                                        width: `${Math.max(10, (item.revenue / Math.max(...analyticsData.revenueByCategory.map(c => c.revenue))) * 100)}%`
                                                    }}
                                                >
                                                    <span className="text-xs text-white font-medium">
                                                        RM{item.revenue.toFixed(0)}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* æ•°æ®æ¦‚è¦ */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="card">
                            <div className="card__body text-center">
                                <div className="text-2xl font-bold text-primary">
                                    {analyticsData.salesByMonth.reduce((sum, item) => sum + item.sales, 0).toFixed(2)}
                                </div>
                                <div className="text-sm text-gray-600">æ€»é”€å”®é¢ (RM)</div>
                            </div>
                        </div>
                        <div className="card">
                            <div className="card__body text-center">
                                <div className="text-2xl font-bold text-success">
                                    {analyticsData.ordersByStatus.reduce((sum, item) => sum + item.count, 0)}
                                </div>
                                <div className="text-sm text-gray-600">æ€»è®¢å•æ•°</div>
                            </div>
                        </div>
                        <div className="card">
                            <div className="card__body text-center">
                                <div className="text-2xl font-bold text-warning">
                                    {analyticsData.topProducts.reduce((sum, [, quantity]) => sum + quantity, 0)}
                                </div>
                                <div className="text-sm text-gray-600">æ€»é”€å”®ä»¶æ•°</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ“± æ‰«ç åŠŸèƒ½ç»„ä»¶
        const Scanner = () => {
            const [isScanning, setIsScanning] = useState(false);
            const [scannedResults, setScannedResults] = useState([]);
            const [scanMode, setScanMode] = useState('qr'); // 'qr' or 'barcode'
            const scannerRef = useRef(null);
            
            useEffect(() => {
                let html5QrcodeScanner = null;
                
                if (isScanning && scannerRef.current) {
                    try {
                        html5QrcodeScanner = new Html5QrcodeScanner(
                            "qr-reader", 
                            { 
                                fps: 10, 
                                qrbox: { width: 250, height: 250 },
                                rememberLastUsedCamera: true,
                                supportedScanTypes: scanMode === 'qr' 
                                    ? [Html5QrcodeScanType.SCAN_TYPE_CAMERA] 
                                    : [Html5QrcodeScanType.SCAN_TYPE_CAMERA]
                            },
                            false
                        );
                        
                        html5QrcodeScanner.render(onScanSuccess, onScanFailure);
                    } catch (error) {
                        console.error('æ‰«ç å™¨åˆå§‹åŒ–å¤±è´¥:', error);
                    }
                }
                
                return () => {
                    if (html5QrcodeScanner) {
                        html5QrcodeScanner.clear().catch(error => {
                            console.error('æ¸…ç†æ‰«ç å™¨å¤±è´¥:', error);
                        });
                    }
                };
            }, [isScanning, scanMode]);
            
            const onScanSuccess = (decodedText, decodedResult) => {
                const timestamp = new Date().toLocaleString('zh-CN');
                const newResult = {
                    id: Date.now(),
                    text: decodedText,
                    format: decodedResult.result?.format,
                    timestamp: timestamp,
                    type: scanMode
                };
                
                setScannedResults(prev => [newResult, ...prev]);
                
                // æ˜¾ç¤ºæ‰«ç æˆåŠŸé€šçŸ¥
                showToast(`æ‰«ç æˆåŠŸ: ${decodedText}`, 'success');
            };
            
            const onScanFailure = (error) => {
                // æ‰«ç å¤±è´¥ï¼Œé€šå¸¸æ˜¯å› ä¸ºæ²¡æœ‰æ‰¾åˆ°ç ï¼Œå¯ä»¥å¿½ç•¥
            };
            
            const startScanning = () => {
                setIsScanning(true);
            };
            
            const stopScanning = () => {
                setIsScanning(false);
            };
            
            const clearResults = () => {
                setScannedResults([]);
            };
            
            const copyToClipboard = async (text) => {
                try {
                    await navigator.clipboard.writeText(text);
                    showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                } catch (error) {
                    showToast('å¤åˆ¶å¤±è´¥', 'error');
                }
            };
            
            const showToast = (message, type) => {
                // ç®€å•çš„Toasté€šçŸ¥å®ç°
                const toast = document.createElement('div');
                toast.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-md text-white ${
                    type === 'success' ? 'bg-green-500' : 'bg-red-500'
                }`;
                toast.textContent = message;
                document.body.appendChild(toast);
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 3000);
            };
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <div>
                            <h2 className="page-title">ğŸ“± æ‰«ç åŠŸèƒ½</h2>
                            <p className="page-subtitle">äºŒç»´ç å’Œæ¡å½¢ç æ‰«æ</p>
                        </div>
                        <div className="flex gap-2">
                            <select
                                value={scanMode}
                                onChange={(e) => setScanMode(e.target.value)}
                                className="form-control"
                                disabled={isScanning}
                            >
                                <option value="qr">äºŒç»´ç </option>
                                <option value="barcode">æ¡å½¢ç </option>
                            </select>
                        </div>
                    </div>
                    
                    {/* æ‰«ç æ§åˆ¶é¢æ¿ */}
                    <div className="card">
                        <div className="card__body">
                            <div className="flex flex-col md:flex-row gap-4 items-center">
                                <div className="flex-1">
                                    {isScanning ? (
                                        <div className="flex items-center gap-3 text-green-600">
                                            <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                            <span className="font-medium">æ‰«ç å™¨è¿è¡Œä¸­...</span>
                                        </div>
                                    ) : (
                                        <div className="flex items-center gap-3 text-gray-600">
                                            <div className="w-3 h-3 bg-gray-400 rounded-full"></div>
                                            <span>æ‰«ç å™¨å·²åœæ­¢</span>
                                        </div>
                                    )}
                                </div>
                                <div className="flex gap-2">
                                    {!isScanning ? (
                                        <button
                                            onClick={startScanning}
                                            className="btn btn--primary"
                                        >
                                            <i className="fas fa-play mr-2"></i>
                                            å¼€å§‹æ‰«ç 
                                        </button>
                                    ) : (
                                        <button
                                            onClick={stopScanning}
                                            className="btn btn--danger"
                                        >
                                            <i className="fas fa-stop mr-2"></i>
                                            åœæ­¢æ‰«ç 
                                        </button>
                                    )}
                                    {scannedResults.length > 0 && (
                                        <button
                                            onClick={clearResults}
                                            className="btn btn--secondary"
                                        >
                                            <i className="fas fa-trash mr-2"></i>
                                            æ¸…ç©ºè®°å½•
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* æ‰«ç åŒºåŸŸ */}
                    {isScanning && (
                        <div className="card">
                            <div className="card__body">
                                <div className="text-center mb-4">
                                    <h3 className="text-lg font-semibold">
                                        {scanMode === 'qr' ? 'ğŸ“± è¯·å¯¹å‡†äºŒç»´ç ' : 'ğŸ·ï¸ è¯·å¯¹å‡†æ¡å½¢ç '}
                                    </h3>
                                    <p className="text-gray-600 text-sm mt-1">
                                        è¯·å°†æ‘„åƒå¤´å¯¹å‡†è¦æ‰«æçš„ç ï¼Œä¿æŒç¨³å®š
                                    </p>
                                </div>
                                <div id="qr-reader" style={{ width: '100%' }}></div>
                            </div>
                        </div>
                    )}
                    
                    {/* æ‰«ç ç»“æœ */}
                    {scannedResults.length > 0 && (
                        <div className="card">
                            <div className="card__body">
                                <div className="flex items-center justify-between mb-4">
                                    <h3 className="text-lg font-semibold">ğŸ“‹ æ‰«ç è®°å½•</h3>
                                    <span className="text-sm text-gray-600">
                                        å…± {scannedResults.length} æ¡è®°å½•
                                    </span>
                                </div>
                                
                                <div className="space-y-3 max-h-96 overflow-y-auto">
                                    {scannedResults.map((result) => (
                                        <div key={result.id} className="border border-gray-200 rounded-lg p-4">
                                            <div className="flex items-start justify-between gap-3">
                                                <div className="flex-1">
                                                    <div className="flex items-center gap-2 mb-2">
                                                        <span className="text-lg">
                                                            {result.type === 'qr' ? 'ğŸ“±' : 'ğŸ·ï¸'}
                                                        </span>
                                                        <span className="text-xs bg-gray-100 px-2 py-1 rounded">
                                                            {result.type === 'qr' ? 'äºŒç»´ç ' : 'æ¡å½¢ç '}
                                                        </span>
                                                        <span className="text-xs text-gray-500">
                                                            {result.timestamp}
                                                        </span>
                                                    </div>
                                                    <div className="bg-gray-50 rounded p-3 font-mono text-sm break-all">
                                                        {result.text}
                                                    </div>
                                                    {result.format && (
                                                        <div className="mt-2 text-xs text-gray-600">
                                                            æ ¼å¼: {result.format}
                                                        </div>
                                                    )}
                                                </div>
                                                <button
                                                    onClick={() => copyToClipboard(result.text)}
                                                    className="btn btn--secondary btn-sm"
                                                    title="å¤åˆ¶å†…å®¹"
                                                >
                                                    <i className="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* ä½¿ç”¨è¯´æ˜ */}
                    <div className="card">
                        <div className="card__body">
                            <h3 className="text-lg font-semibold mb-3">ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
                            <div className="space-y-2 text-sm text-gray-600">
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>ç‚¹å‡»"å¼€å§‹æ‰«ç "æŒ‰é’®æ¿€æ´»æ‘„åƒå¤´</span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>å°†è®¾å¤‡æ‘„åƒå¤´å¯¹å‡†äºŒç»´ç æˆ–æ¡å½¢ç </span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>ä¿æŒç¨³å®šç›´åˆ°è‡ªåŠ¨è¯†åˆ«æˆåŠŸ</span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>æ‰«ç ç»“æœä¼šè‡ªåŠ¨ä¿å­˜å¹¶å¯å¤åˆ¶åˆ°å‰ªè´´æ¿</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // ğŸ“¸ æ‹ç…§åŠŸèƒ½ç»„ä»¶
        const Camera = () => {
            const [isCamera, setIsCamera] = useState(false);
            const [capturedPhotos, setCapturedPhotos] = useState([]);
            const [uploading, setUploading] = useState(false);
            const videoRef = useRef(null);
            const canvasRef = useRef(null);
            const streamRef = useRef(null);
            
            useEffect(() => {
                return () => {
                    // æ¸…ç†æ‘„åƒå¤´èµ„æº
                    if (streamRef.current) {
                        streamRef.current.getTracks().forEach(track => track.stop());
                    }
                };
            }, []);
            
            const startCamera = async () => {
                try {
                    const constraints = {
                        video: {
                            width: { ideal: 1280 },
                            height: { ideal: 720 },
                            facingMode: 'environment' // åç½®æ‘„åƒå¤´
                        },
                        audio: false
                    };
                    
                    const stream = await navigator.mediaDevices.getUserMedia(constraints);
                    streamRef.current = stream;
                    
                    if (videoRef.current) {
                        videoRef.current.srcObject = stream;
                        videoRef.current.play();
                    }
                    
                    setIsCamera(true);
                    showToast('æ‘„åƒå¤´å¯åŠ¨æˆåŠŸ', 'success');
                } catch (error) {
                    console.error('å¯åŠ¨æ‘„åƒå¤´å¤±è´¥:', error);
                    showToast('æ— æ³•è®¿é—®æ‘„åƒå¤´ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®', 'error');
                }
            };
            
            const stopCamera = () => {
                if (streamRef.current) {
                    streamRef.current.getTracks().forEach(track => track.stop());
                    streamRef.current = null;
                }
                
                if (videoRef.current) {
                    videoRef.current.srcObject = null;
                }
                
                setIsCamera(false);
                showToast('æ‘„åƒå¤´å·²åœæ­¢', 'success');
            };
            
            const capturePhoto = () => {
                if (!videoRef.current || !canvasRef.current) return;
                
                const video = videoRef.current;
                const canvas = canvasRef.current;
                const context = canvas.getContext('2d');
                
                // è®¾ç½®ç”»å¸ƒå°ºå¯¸
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                
                // ç»˜åˆ¶è§†é¢‘å¸§åˆ°ç”»å¸ƒ
                context.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // è½¬æ¢ä¸ºBase64å›¾ç‰‡
                const imageData = canvas.toDataURL('image/jpeg', 0.8);
                const timestamp = new Date().toLocaleString('zh-CN');
                
                const newPhoto = {
                    id: Date.now(),
                    data: imageData,
                    timestamp: timestamp,
                    size: Math.round(imageData.length * 0.75), // ä¼°ç®—æ–‡ä»¶å¤§å°
                    uploaded: false
                };
                
                setCapturedPhotos(prev => [newPhoto, ...prev]);
                showToast('ç…§ç‰‡æ‹æ‘„æˆåŠŸ', 'success');
            };
            
            const deletePhoto = (photoId) => {
                setCapturedPhotos(prev => prev.filter(photo => photo.id !== photoId));
                showToast('ç…§ç‰‡å·²åˆ é™¤', 'success');
            };
            
            const uploadPhoto = async (photo) => {
                if (!photo || photo.uploaded) return;
                
                try {
                    setUploading(true);
                    
                    // å°†Base64è½¬æ¢ä¸ºBlob
                    const response = await fetch(photo.data);
                    const blob = await response.blob();
                    
                    const fileName = `product_${Date.now()}.jpg`;
                    
                    // ä¸Šä¼ åˆ°Supabase Storage
                    const { data, error } = await supabase.storage
                        .from('product-photos')
                        .upload(fileName, blob, {
                            contentType: 'image/jpeg',
                            upsert: true
                        });
                    
                    if (error) throw error;
                    
                    // æ›´æ–°ç…§ç‰‡çŠ¶æ€
                    setCapturedPhotos(prev => prev.map(p => 
                        p.id === photo.id ? { ...p, uploaded: true, uploadPath: data.path } : p
                    ));
                    
                    showToast('ç…§ç‰‡ä¸Šä¼ æˆåŠŸ', 'success');
                } catch (error) {
                    console.error('ç…§ç‰‡ä¸Šä¼ å¤±è´¥:', error);
                    showToast('ä¸Šä¼ å¤±è´¥: ' + error.message, 'error');
                } finally {
                    setUploading(false);
                }
            };
            
            const downloadPhoto = (photo) => {
                const link = document.createElement('a');
                link.href = photo.data;
                link.download = `photo_${photo.timestamp.replace(/[:/\s]/g, '_')}.jpg`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };
            
            const showToast = (message, type) => {
                const toast = document.createElement('div');
                toast.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-md text-white ${
                    type === 'success' ? 'bg-green-500' : 'bg-red-500'
                }`;
                toast.textContent = message;
                document.body.appendChild(toast);
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 3000);
            };
            
            return (
                <div className="space-y-6">
                    <div className="page-header">
                        <div>
                            <h2 className="page-title">ğŸ“¸ æ‹ç…§åŠŸèƒ½</h2>
                            <p className="page-subtitle">å•†å“æ‹ç…§å’Œå›¾ç‰‡ç®¡ç†</p>
                        </div>
                    </div>
                    
                    {/* ç›¸æœºæ§åˆ¶é¢æ¿ */}
                    <div className="card">
                        <div className="card__body">
                            <div className="flex flex-col md:flex-row gap-4 items-center">
                                <div className="flex-1">
                                    {isCamera ? (
                                        <div className="flex items-center gap-3 text-green-600">
                                            <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                            <span className="font-medium">æ‘„åƒå¤´è¿è¡Œä¸­...</span>
                                        </div>
                                    ) : (
                                        <div className="flex items-center gap-3 text-gray-600">
                                            <div className="w-3 h-3 bg-gray-400 rounded-full"></div>
                                            <span>æ‘„åƒå¤´å·²åœæ­¢</span>
                                        </div>
                                    )}
                                </div>
                                <div className="flex gap-2">
                                    {!isCamera ? (
                                        <button
                                            onClick={startCamera}
                                            className="btn btn--primary"
                                        >
                                            <i className="fas fa-video mr-2"></i>
                                            å¯åŠ¨æ‘„åƒå¤´
                                        </button>
                                    ) : (
                                        <>
                                            <button
                                                onClick={capturePhoto}
                                                className="btn btn--success"
                                            >
                                                <i className="fas fa-camera mr-2"></i>
                                                æ‹ç…§
                                            </button>
                                            <button
                                                onClick={stopCamera}
                                                className="btn btn--danger"
                                            >
                                                <i className="fas fa-stop mr-2"></i>
                                                åœæ­¢
                                            </button>
                                        </>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    {/* æ‘„åƒå¤´è§†é¢‘é¢„è§ˆ */}
                    {isCamera && (
                        <div className="card">
                            <div className="card__body">
                                <div className="text-center mb-4">
                                    <h3 className="text-lg font-semibold">ğŸ“· æ‘„åƒå¤´é¢„è§ˆ</h3>
                                    <p className="text-gray-600 text-sm mt-1">
                                        è°ƒæ•´å¥½è§’åº¦åç‚¹å‡»"æ‹ç…§"æŒ‰é’®
                                    </p>
                                </div>
                                <div className="relative bg-black rounded-lg overflow-hidden" style={{ maxWidth: '100%', aspectRatio: '16/9' }}>
                                    <video
                                        ref={videoRef}
                                        autoPlay
                                        playsInline
                                        muted
                                        className="w-full h-full object-contain"
                                    />
                                </div>
                                <canvas ref={canvasRef} className="hidden" />
                            </div>
                        </div>
                    )}
                    
                    {/* æ‹æ‘„çš„ç…§ç‰‡gallery */}
                    {capturedPhotos.length > 0 && (
                        <div className="card">
                            <div className="card__body">
                                <div className="flex items-center justify-between mb-4">
                                    <h3 className="text-lg font-semibold">ğŸ“¸ æ‹æ‘„è®°å½•</h3>
                                    <span className="text-sm text-gray-600">
                                        å…± {capturedPhotos.length} å¼ ç…§ç‰‡
                                    </span>
                                </div>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {capturedPhotos.map((photo) => (
                                        <div key={photo.id} className="border border-gray-200 rounded-lg overflow-hidden">
                                            <div className="aspect-video bg-gray-100">
                                                <img
                                                    src={photo.data}
                                                    alt={`æ‹æ‘„äº ${photo.timestamp}`}
                                                    className="w-full h-full object-cover"
                                                />
                                            </div>
                                            <div className="p-3">
                                                <div className="text-xs text-gray-600 mb-2">
                                                    {photo.timestamp}
                                                </div>
                                                <div className="text-xs text-gray-500 mb-3">
                                                    å¤§å°: {(photo.size / 1024).toFixed(1)} KB
                                                    {photo.uploaded && (
                                                        <span className="ml-2 text-green-600">
                                                            <i className="fas fa-check-circle mr-1"></i>
                                                            å·²ä¸Šä¼ 
                                                        </span>
                                                    )}
                                                </div>
                                                <div className="flex gap-2">
                                                    <button
                                                        onClick={() => downloadPhoto(photo)}
                                                        className="btn btn--secondary btn-sm flex-1"
                                                        title="ä¸‹è½½ç…§ç‰‡"
                                                    >
                                                        <i className="fas fa-download"></i>
                                                    </button>
                                                    {!photo.uploaded && (
                                                        <button
                                                            onClick={() => uploadPhoto(photo)}
                                                            disabled={uploading}
                                                            className="btn btn--primary btn-sm flex-1"
                                                            title="ä¸Šä¼ åˆ°äº‘ç«¯"
                                                        >
                                                            <i className="fas fa-cloud-upload-alt"></i>
                                                        </button>
                                                    )}
                                                    <button
                                                        onClick={() => deletePhoto(photo.id)}
                                                        className="btn btn--danger btn-sm"
                                                        title="åˆ é™¤ç…§ç‰‡"
                                                    >
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                    
                    {/* ä½¿ç”¨è¯´æ˜ */}
                    <div className="card">
                        <div className="card__body">
                            <h3 className="text-lg font-semibold mb-3">ğŸ“– ä½¿ç”¨è¯´æ˜</h3>
                            <div className="space-y-2 text-sm text-gray-600">
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>ç‚¹å‡»"å¯åŠ¨æ‘„åƒå¤´"å…è®¸æµè§ˆå™¨è®¿é—®æ‘„åƒå¤´</span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>è°ƒæ•´è®¾å¤‡è§’åº¦ç¡®ä¿å•†å“æ¸…æ™°å¯è§</span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>ç‚¹å‡»"æ‹ç…§"æŒ‰é’®æ•è·å½“å‰ç”»é¢</span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-check-circle text-green-500 mt-0.5"></i>
                                    <span>ç…§ç‰‡å¯ä¸‹è½½åˆ°æœ¬åœ°æˆ–ä¸Šä¼ åˆ°äº‘ç«¯å­˜å‚¨</span>
                                </div>
                                <div className="flex items-start gap-2">
                                    <i className="fas fa-info-circle text-blue-500 mt-0.5"></i>
                                    <span>å»ºè®®ä½¿ç”¨åç½®æ‘„åƒå¤´è·å¾—æ›´å¥½çš„æ‹æ‘„æ•ˆæœ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // æ¸²æŸ“åº”ç”¨
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</body>
</html>
