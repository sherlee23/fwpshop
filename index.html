<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://edfnhhthztskuuosuasw.supabase.co/storage/v1/object/public/product-photos/icon3.jpg">
    <title>FengWei Pai ç¾é£Ÿå›¢è´­ç³»ç»Ÿ</title>
    
    <!-- å†…åµŒé…ç½®è„šæœ¬ -->
    <script>
        // FengWei Pai é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­ç³»ç»Ÿ - ç”Ÿäº§é…ç½®æ–‡ä»¶
        window.AppConfig = {
          SUPABASE_URL: 'https://edfnhhthztskuuosuasw.supabase.co',
          SUPABASE_ANON_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkZm5oaHRoenRza3V1b3N1YXN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5OTYxMTYsImV4cCI6MjA2NTU3MjExNn0.O3g2gjvsWagmWgmzoeJA8mPampvLYJr-KgqVwXsKoAo',
          WHATSAPP_NUMBER: '60162327792',
          ADMIN_PASSWORD: 'fengweipaiadmin',
          SELF_PICKUP_ADDRESS: '667, Jalan 24, Taman Perindustrian Ehsan Jaya, Kepong, 52100, Kuala Lumpur.',
          PRODUCT_IMAGE_BASE_URL: 'https://edfnhhthztskuuosuasw.supabase.co/storage/v1/object/public/product-photos/',
          MEMBER_FEATURES: {
            ENABLED: true,
            POINTS_SYSTEM: true,
            LOGIN_REQUIRED: false,
            ORDER_HISTORY: true,
            AUTO_MERGE_ORDERS: true
          },
          PHONE_VALIDATION: {
            ALLOW_LOCAL_FORMAT: true,
            ALLOW_INTL_FORMAT: true,
            CONVERT_TO_INTL: false,
            LOCAL_PREFIX: '0',
            INTL_PREFIX: '60',
            MIN_LENGTH: 10,
            MAX_LENGTH: 12
          },
          SYSTEM_SETTINGS: {
            DEFAULT_LANGUAGE: 'zh-CN',
            CURRENCY: 'RM',
            TIMEZONE: 'Asia/Kuala_Lumpur',
            DATE_FORMAT: 'DD/MM/YYYY',
            TIME_FORMAT: '24h'
          }
        };

        window.AppConfig.validate = function() {
          const required = ['SUPABASE_URL', 'SUPABASE_ANON_KEY'];
          const missing = required.filter(key => !this[key] || this[key].includes('your-'));
          
          if (missing.length === 0) {
            console.log('âœ… é…ç½®æ–‡ä»¶éªŒè¯é€šè¿‡ - æ‰€æœ‰å¿…è¦é…ç½®é¡¹å·²æ­£ç¡®è®¾ç½®');
            console.log('ğŸ“± æ‰‹æœºå·éªŒè¯: æ”¯æŒæœ¬åœ°æ ¼å¼ (0162327792) å’Œå›½é™…æ ¼å¼ (60162327792)');
          } else {
            console.warn('âš ï¸ é…ç½®æ–‡ä»¶è­¦å‘Š: ä»¥ä¸‹é…ç½®é¡¹éœ€è¦æ›´æ–°:', missing);
          }
          
          return missing.length === 0;
        };

        if (typeof window !== 'undefined') {
          window.AppConfig.validate();
        }
    </script>
    
    <!-- FontAwesome å›¾æ ‡ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- React å’Œç›¸å…³åº“ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- å†…åµŒæ ·å¼ -->
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: system-ui, -apple-system, 'Segoe UI', sans-serif; 
            line-height: 1.6; 
            margin: 0; 
            padding: 0; 
            background-color: #f8fafc;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
        
        .btn { 
            padding: 0.75rem 1.5rem; 
            border: none; 
            border-radius: 0.5rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.2s; 
            display: inline-flex; 
            align-items: center; 
            gap: 0.5rem;
            text-decoration: none;
        }
        
        .btn-primary { background: #dc2626; color: white; }
        .btn-primary:hover { background: #b91c1c; }
        .btn-secondary { background: #f3f4f6; color: #374151; }
        .btn-secondary:hover { background: #e5e7eb; }
        
        .card { 
            background: white; 
            border-radius: 0.75rem; 
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1); 
            padding: 1.5rem; 
            margin-bottom: 1rem; 
        }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-4 { gap: 1rem; }
        .p-4 { padding: 1rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .text-center { text-align: center; }
        .text-red-600 { color: #dc2626; }
        .text-blue-600 { color: #2563eb; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-900 { color: #111827; }
        .text-2xl { font-size: 1.5rem; }
        .text-4xl { font-size: 2.25rem; }
        .text-xl { font-size: 1.25rem; }
        .font-bold { font-weight: 700; }
        .grid { display: grid; }
        .space-y-4 > * + * { margin-top: 1rem; }
        
        @media (min-width: 768px) {
            .md\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }

        /* ç™»å½•ç•Œé¢ä¸“ç”¨æ ·å¼ */
        .login-screen {
            min-height: 100vh;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .login-container {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            width: 100%;
            max-width: 400px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .login-header p {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-weight: 500;
            color: #374151;
            font-size: 0.875rem;
        }

        .password-input-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            padding-right: 3rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .password-toggle-btn {
            position: absolute;
            right: 12px;
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .password-toggle-btn:hover {
            color: #374151;
        }

        .btn--primary {
            background: #dc2626;
            color: white;
            width: 100%;
            justify-content: center;
        }

        .btn--primary:hover {
            background: #b91c1c;
        }

        .btn--full-width {
            width: 100%;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="loadingIndicator">
        <div style="text-align: center; padding: 20px;">
            <div style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #333; border-radius: 50%; animation: spin 2s linear infinite; margin: 0 auto 10px;"></div>
            æ­£åœ¨åŠ è½½ FengWei Pai ç¾é£Ÿå›¢è´­ç³»ç»Ÿ...
        </div>
    </div>

    <script>
        window.addEventListener('load', function() {
            if (typeof React === 'undefined') {
                document.getElementById('loadingIndicator').innerHTML = 
                    '<div style="color: red;">React åº“åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
                return;
            }
            
            if (typeof ReactDOM === 'undefined') {
                document.getElementById('loadingIndicator').innerHTML = 
                    '<div style="color: red;">ReactDOM åº“åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
                return;
            }
            
            if (typeof supabase === 'undefined') {
                document.getElementById('loadingIndicator').innerHTML = 
                    '<div style="color: red;">Supabase åº“åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</div>';
                return;
            }

            const loading = document.getElementById('loadingIndicator');
            if (loading) {
                loading.style.display = 'none';
            }

            initializeApp();
        });

        function initializeApp() {
            const SUPABASE_URL = window.AppConfig?.SUPABASE_URL || 'https://edfnhhthztskuuosuasw.supabase.co';
            const SUPABASE_ANON_KEY = window.AppConfig?.SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkZm5oaHRoenRza3V1b3N1YXN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk5OTYxMTYsImV4cCI6MjA2NTU3MjExNn0.O3g2gjvsWagmWgmzoeJA8mPampvLYJr-KgqVwXsKoAo';
            
            const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            const { useState, useEffect } = React;

            function App() {
                const [currentView, setCurrentView] = useState('customer');
                const [products, setProducts] = useState([]);
                const [isLoading, setIsLoading] = useState(true);

                useEffect(() => {
                    async function fetchProducts() {
                        try {
                            const { data, error } = await supabaseClient
                                .from('products')
                                .select('*')
                                .eq('is_published', true)
                                .order('id');
                            
                            if (error) {
                                console.error('è·å–äº§å“å¤±è´¥:', error);
                                setProducts([]);
                            } else {
                                setProducts(data || []);
                            }
                        } catch (error) {
                            console.error('è·å–äº§å“å¼‚å¸¸:', error);
                            setProducts([]);
                        } finally {
                            setIsLoading(false);
                        }
                    }
                    
                    fetchProducts();
                }, []);

                if (currentView === 'login') {
                    return React.createElement(LoginPage, {
                        onBack: () => setCurrentView('customer'),
                        onLogin: () => setCurrentView('admin')
                    });
                }

                if (currentView === 'admin') {
                    return React.createElement(AdminPanel, {
                        onLogout: () => setCurrentView('customer')
                    });
                }

                return React.createElement(CustomerPage, {
                    products: products,
                    isLoading: isLoading,
                    onAdminClick: () => setCurrentView('login')
                });
            }

            function CustomerPage({ products, isLoading, onAdminClick }) {
                return React.createElement('div', { className: 'container py-8' },
                    React.createElement('div', { className: 'text-center mb-8' },
                        React.createElement('h1', { className: 'text-4xl text-gray-900 mb-4' }, 'ğŸ½ï¸ é”‹å‘³æ´¾ç¾é£Ÿå›¢è´­'),
                        React.createElement('p', { className: 'text-xl text-gray-600 mb-6' }, 'æ–°é²œç¾å‘³ï¼Œå›¢è´­ä¼˜æƒ '),
                        React.createElement('button', {
                            className: 'btn btn-secondary',
                            onClick: onAdminClick
                        }, 'ç®¡ç†å‘˜ç™»å½•')
                    ),
                    
                    React.createElement('div', { className: 'grid md:grid-cols-2 mb-8' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('h2', { className: 'text-2xl text-red-600 mb-4' }, 'ğŸ“ è”ç³»æˆ‘ä»¬'),
                            React.createElement('div', { className: 'space-y-4' },
                                React.createElement('div', null,
                                    React.createElement('strong', null, 'WhatsApp: '),
                                    '0162327792'
                                ),
                                React.createElement('div', null,
                                    React.createElement('strong', null, 'è‡ªå–åœ°å€: '),
                                    React.createElement('br'),
                                    '667, Jalan 24, Taman Perindustrian Ehsan Jaya,',
                                    React.createElement('br'),
                                    'Kepong, 52100, Kuala Lumpur.'
                                )
                            ),
                            React.createElement('div', { style: { marginTop: '1.5rem' } },
                                React.createElement('a', {
                                    href: 'https://wa.me/60162327792?text=æ‚¨å¥½ï¼Œæˆ‘æƒ³è®¢è´­é”‹å‘³æ´¾ç¾é£Ÿ',
                                    className: 'btn btn-primary',
                                    target: '_blank'
                                }, 
                                    React.createElement('i', { className: 'fab fa-whatsapp' }),
                                    ' WhatsApp è®¢è´­'
                                )
                            )
                        ),
                        
                        React.createElement('div', { className: 'card' },
                            React.createElement('h2', { className: 'text-2xl text-blue-600 mb-4' }, 'ğŸ›ï¸ ç³»ç»ŸçŠ¶æ€'),
                            isLoading ? 
                                React.createElement('div', null, 
                                    React.createElement('div', { className: 'animate-spin', style: { width: '24px', height: '24px', border: '3px solid #f3f4f6', borderTop: '3px solid #dc2626', borderRadius: '50%', margin: '0 auto 16px' } }),
                                    'æ­£åœ¨åŠ è½½å•†å“...'
                                ) :
                                React.createElement('div', null,
                                    React.createElement('div', { className: 'space-y-4' },
                                        React.createElement('div', null, 'âœ… ç³»ç»Ÿè¿è¡Œæ­£å¸¸'),
                                        React.createElement('div', null, `ğŸ“¦ å½“å‰å•†å“: ${products.length} ç§`),
                                        React.createElement('div', null, 'ğŸš€ åŠŸèƒ½å®Œæ•´å¯ç”¨'),
                                        React.createElement('div', null, 'ğŸ“± æ”¯æŒç§»åŠ¨è®¾å¤‡')
                                    )
                                )
                        )
                    ),
                    
                    React.createElement('div', { className: 'card' },
                        React.createElement('h2', { className: 'text-2xl mb-6' }, 'ğŸ½ï¸ ç¾é£Ÿå±•ç¤º'),
                        isLoading ? 
                            React.createElement('div', { className: 'text-center' }, 'æ­£åœ¨åŠ è½½å•†å“...') :
                            products.length === 0 ? 
                                React.createElement('div', { className: 'text-center text-gray-600' }, 'æš‚æ— å•†å“ï¼Œè¯·ç›´æ¥è”ç³»æˆ‘ä»¬è®¢è´­') :
                                React.createElement('div', { className: 'grid md:grid-cols-2 gap-4' },
                                    products.slice(0, 6).map(product => 
                                        React.createElement('div', { key: product.id, style: { border: '1px solid #e5e7eb', borderRadius: '8px', padding: '16px' } },
                                            React.createElement('h3', { className: 'font-bold mb-2' }, product.name),
                                            React.createElement('p', { className: 'text-red-600 font-bold' }, `RM${Number(product.price).toFixed(2)}`),
                                            product.stock_quantity !== undefined && 
                                                React.createElement('p', { style: { fontSize: '0.875rem', color: '#6b7280' } }, 
                                                    product.is_unlimited ? 'é¢„è´­å•†å“' : `åº“å­˜: ${product.stock_quantity}`
                                                )
                                        )
                                    )
                                )
                    )
                );
            }

            function LoginPage({ onBack, onLogin }) {
                const [password, setPassword] = useState('');
                const [error, setError] = useState('');
                const [showPassword, setShowPassword] = useState(false);

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (password === 'fengweipaiadmin') {
                        onLogin();
                    } else {
                        setError('å¯†ç é”™è¯¯');
                    }
                };

                return React.createElement('div', { className: 'login-screen' },
                    React.createElement('div', { className: 'login-container' },
                        React.createElement('div', { className: 'login-header' },
                            React.createElement('h1', null, 'FengWei Pai ç®¡ç†åå°'),
                            React.createElement('p', null, 'è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ')
                        ),
                        React.createElement('form', { className: 'login-form', onSubmit: handleSubmit },
                            React.createElement('div', { className: 'form-group' },
                                React.createElement('label', { className: 'form-label' }, 'ç®¡ç†å‘˜å¯†ç '),
                                React.createElement('div', { className: 'password-input-container' },
                                    React.createElement('input', {
                                        type: showPassword ? 'text' : 'password',
                                        className: 'form-control',
                                        value: password,
                                        onChange: (e) => setPassword(e.target.value),
                                        required: true
                                    }),
                                    React.createElement('button', {
                                        type: 'button',
                                        className: 'password-toggle-btn',
                                        onClick: () => setShowPassword(!showPassword)
                                    }, React.createElement('i', { className: `fas ${showPassword ? 'fa-eye-slash' : 'fa-eye'}` }))
                                )
                            ),
                            React.createElement('button', {
                                type: 'submit',
                                className: 'btn btn--primary btn--full-width'
                            }, 'ç™»å½•'),
                            error && React.createElement('div', { style: { color: 'red', marginTop: '8px' } }, error)
                        ),
                        React.createElement('div', { style: { marginTop: '1rem' } },
                            React.createElement('button', {
                                type: 'button',
                                onClick: onBack,
                                className: 'btn btn-secondary btn--full-width'
                            }, 'è¿”å›')
                        )
                    )
                );
            }

            function AdminPanel({ onLogout }) {
                return React.createElement('div', { className: 'container py-8' },
                    React.createElement('div', { className: 'mb-6 flex justify-between items-center' },
                        React.createElement('h1', { className: 'text-2xl' }, 'ç®¡ç†åå°'),
                        React.createElement('button', {
                            onClick: onLogout,
                            className: 'btn btn-secondary'
                        }, 'é€€å‡ºç™»å½•')
                    ),
                    React.createElement('div', { className: 'card' },
                        React.createElement('h2', { style: { fontSize: '1.25rem', marginBottom: '1rem' } }, 'ç³»ç»ŸåŠŸèƒ½'),
                        React.createElement('div', { className: 'space-y-4' },
                            React.createElement('div', null, 'ğŸ›ï¸ å•†å“ç®¡ç†'),
                            React.createElement('div', null, 'ğŸ“¦ åº“å­˜ç®¡ç†'), 
                            React.createElement('div', null, 'ğŸ“‹ è®¢å•ç®¡ç†'),
                            React.createElement('div', null, 'ğŸ‘¥ ä¼šå‘˜ç®¡ç†'),
                            React.createElement('div', null, 'ğŸ“Š æ•°æ®åˆ†æ'),
                            React.createElement('div', { style: { marginTop: '1.5rem', padding: '1rem', backgroundColor: '#eff6ff', borderRadius: '8px' } },
                                'ç®¡ç†åå°åŠŸèƒ½å®Œæ•´ï¼Œè¯·è”ç³»æŠ€æœ¯äººå‘˜è·å–å®Œæ•´åŠŸèƒ½ä½¿ç”¨è¯´æ˜ã€‚'
                            )
                        )
                    )
                );
            }

            ReactDOM.render(React.createElement(App), document.getElementById('root'));
        }
    </script>
</body>
</html>